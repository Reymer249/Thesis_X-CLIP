2025-03-18 12:48:08,271:INFO: Effective parameters:
2025-03-18 12:48:08,271:INFO:   <<< batch_size: 80
2025-03-18 12:48:08,272:INFO:   <<< batch_size_val: 64
2025-03-18 12:48:08,272:INFO:   <<< cache_dir: 
2025-03-18 12:48:08,272:INFO:   <<< coef_lr: 0.001
2025-03-18 12:48:08,273:INFO:   <<< cross_model: cross-base
2025-03-18 12:48:08,273:INFO:   <<< cross_num_hidden_layers: 4
2025-03-18 12:48:08,273:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-18 12:48:08,274:INFO:   <<< datatype: vatex
2025-03-18 12:48:08,274:INFO:   <<< do_eval: False
2025-03-18 12:48:08,274:INFO:   <<< do_lower_case: False
2025-03-18 12:48:08,274:INFO:   <<< do_pretrain: False
2025-03-18 12:48:08,275:INFO:   <<< do_train: True
2025-03-18 12:48:08,275:INFO:   <<< epochs: 5
2025-03-18 12:48:08,275:INFO:   <<< eval_frame_order: 0
2025-03-18 12:48:08,275:INFO:   <<< expand_msrvtt_sentences: False
2025-03-18 12:48:08,275:INFO:   <<< feature_framerate: 1
2025-03-18 12:48:08,275:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-18 12:48:08,276:INFO:   <<< fp16: False
2025-03-18 12:48:08,276:INFO:   <<< fp16_opt_level: O1
2025-03-18 12:48:08,276:INFO:   <<< freeze_layer_num: 0
2025-03-18 12:48:08,276:INFO:   <<< gradient_accumulation_steps: 1
2025-03-18 12:48:08,276:INFO:   <<< hard_negative_rate: 0.5
2025-03-18 12:48:08,276:INFO:   <<< init_model: None
2025-03-18 12:48:08,277:INFO:   <<< linear_patch: 2d
2025-03-18 12:48:08,277:INFO:   <<< local_rank: 0
2025-03-18 12:48:08,277:INFO:   <<< loose_type: True
2025-03-18 12:48:08,277:INFO:   <<< lr: 0.0001
2025-03-18 12:48:08,278:INFO:   <<< lr_decay: 0.9
2025-03-18 12:48:08,278:INFO:   <<< margin: 0.1
2025-03-18 12:48:08,278:INFO:   <<< max_frames: 12
2025-03-18 12:48:08,278:INFO:   <<< max_words: 32
2025-03-18 12:48:08,278:INFO:   <<< n_display: 50
2025-03-18 12:48:08,278:INFO:   <<< n_gpu: 1
2025-03-18 12:48:08,279:INFO:   <<< n_pair: 1
2025-03-18 12:48:08,279:INFO:   <<< negative_weighting: 1
2025-03-18 12:48:08,279:INFO:   <<< num_thread_reader: 4
2025-03-18 12:48:08,279:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-18 12:48:08,279:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-18 12:48:08,279:INFO:   <<< rank: 0
2025-03-18 12:48:08,280:INFO:   <<< resume_model: None
2025-03-18 12:48:08,280:INFO:   <<< sampled_use_mil: False
2025-03-18 12:48:08,281:INFO:   <<< seed: 42
2025-03-18 12:48:08,281:INFO:   <<< sim_header: seqTransf
2025-03-18 12:48:08,281:INFO:   <<< slice_framepos: 2
2025-03-18 12:48:08,281:INFO:   <<< task_type: retrieval
2025-03-18 12:48:08,281:INFO:   <<< text_num_hidden_layers: 12
2025-03-18 12:48:08,282:INFO:   <<< train_csv: data/.train.csv
2025-03-18 12:48:08,282:INFO:   <<< train_frame_order: 0
2025-03-18 12:48:08,282:INFO:   <<< use_mil: False
2025-03-18 12:48:08,282:INFO:   <<< val_csv: data/.val.csv
2025-03-18 12:48:08,282:INFO:   <<< video_dim: 1024
2025-03-18 12:48:08,282:INFO:   <<< visual_num_hidden_layers: 12
2025-03-18 12:48:08,283:INFO:   <<< warmup_proportion: 0.1
2025-03-18 12:48:08,283:INFO:   <<< world_size: 1
2025-03-18 12:48:08,283:INFO: device: cuda:0 n_gpu: 1
2025-03-18 12:48:10,118:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-18 12:48:10,144:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-18 12:48:10,144:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-18 12:48:10,144:WARNING: Stage-One:True, Stage-Two:False
2025-03-18 12:48:10,145:WARNING: Test retrieval by loose type.
2025-03-18 12:48:10,145:WARNING: 	 embed_dim: 512
2025-03-18 12:48:10,145:WARNING: 	 image_resolution: 224
2025-03-18 12:48:10,145:WARNING: 	 vision_layers: 12
2025-03-18 12:48:10,146:WARNING: 	 vision_width: 768
2025-03-18 12:48:10,146:WARNING: 	 vision_patch_size: 16
2025-03-18 12:48:10,146:WARNING: 	 context_length: 77
2025-03-18 12:48:10,146:WARNING: 	 vocab_size: 49408
2025-03-18 12:48:10,146:WARNING: 	 transformer_width: 512
2025-03-18 12:48:10,146:WARNING: 	 transformer_heads: 8
2025-03-18 12:48:10,146:WARNING: 	 transformer_layers: 12
2025-03-18 12:48:10,146:WARNING: 		 linear_patch: 2d
2025-03-18 12:48:10,146:WARNING: 	 cut_top_layer: 0
2025-03-18 12:48:11,484:WARNING: 	 sim_header: seqTransf
2025-03-18 12:48:20,127:INFO: --------------------
2025-03-18 12:48:20,127:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-18 12:48:20,128:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-18 13:18:47,777:INFO: Effective parameters:
2025-03-18 13:18:47,777:INFO:   <<< batch_size: 80
2025-03-18 13:18:47,777:INFO:   <<< batch_size_val: 64
2025-03-18 13:18:47,778:INFO:   <<< cache_dir: 
2025-03-18 13:18:47,778:INFO:   <<< coef_lr: 0.001
2025-03-18 13:18:47,778:INFO:   <<< cross_model: cross-base
2025-03-18 13:18:47,779:INFO:   <<< cross_num_hidden_layers: 4
2025-03-18 13:18:47,779:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-18 13:18:47,779:INFO:   <<< datatype: vatex
2025-03-18 13:18:47,780:INFO:   <<< do_eval: False
2025-03-18 13:18:47,780:INFO:   <<< do_lower_case: False
2025-03-18 13:18:47,780:INFO:   <<< do_pretrain: False
2025-03-18 13:18:47,780:INFO:   <<< do_train: True
2025-03-18 13:18:47,780:INFO:   <<< epochs: 5
2025-03-18 13:18:47,780:INFO:   <<< eval_frame_order: 0
2025-03-18 13:18:47,781:INFO:   <<< expand_msrvtt_sentences: False
2025-03-18 13:18:47,781:INFO:   <<< feature_framerate: 1
2025-03-18 13:18:47,781:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-18 13:18:47,781:INFO:   <<< fp16: False
2025-03-18 13:18:47,782:INFO:   <<< fp16_opt_level: O1
2025-03-18 13:18:47,782:INFO:   <<< freeze_layer_num: 0
2025-03-18 13:18:47,782:INFO:   <<< gradient_accumulation_steps: 1
2025-03-18 13:18:47,782:INFO:   <<< hard_negative_rate: 0.5
2025-03-18 13:18:47,782:INFO:   <<< init_model: None
2025-03-18 13:18:47,782:INFO:   <<< linear_patch: 2d
2025-03-18 13:18:47,783:INFO:   <<< local_rank: 0
2025-03-18 13:18:47,783:INFO:   <<< loose_type: True
2025-03-18 13:18:47,783:INFO:   <<< lr: 0.0001
2025-03-18 13:18:47,783:INFO:   <<< lr_decay: 0.9
2025-03-18 13:18:47,784:INFO:   <<< margin: 0.1
2025-03-18 13:18:47,784:INFO:   <<< max_frames: 12
2025-03-18 13:18:47,784:INFO:   <<< max_words: 32
2025-03-18 13:18:47,784:INFO:   <<< n_display: 50
2025-03-18 13:18:47,784:INFO:   <<< n_gpu: 1
2025-03-18 13:18:47,784:INFO:   <<< n_pair: 1
2025-03-18 13:18:47,785:INFO:   <<< negative_weighting: 1
2025-03-18 13:18:47,785:INFO:   <<< num_thread_reader: 4
2025-03-18 13:18:47,785:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-18 13:18:47,785:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-18 13:18:47,785:INFO:   <<< rank: 0
2025-03-18 13:18:47,785:INFO:   <<< resume_model: None
2025-03-18 13:18:47,786:INFO:   <<< sampled_use_mil: False
2025-03-18 13:18:47,786:INFO:   <<< seed: 42
2025-03-18 13:18:47,786:INFO:   <<< sim_header: seqTransf
2025-03-18 13:18:47,786:INFO:   <<< slice_framepos: 2
2025-03-18 13:18:47,787:INFO:   <<< task_type: retrieval
2025-03-18 13:18:47,787:INFO:   <<< text_num_hidden_layers: 12
2025-03-18 13:18:47,787:INFO:   <<< train_csv: data/.train.csv
2025-03-18 13:18:47,787:INFO:   <<< train_frame_order: 0
2025-03-18 13:18:47,787:INFO:   <<< use_mil: False
2025-03-18 13:18:47,787:INFO:   <<< val_csv: data/.val.csv
2025-03-18 13:18:47,788:INFO:   <<< video_dim: 1024
2025-03-18 13:18:47,788:INFO:   <<< visual_num_hidden_layers: 12
2025-03-18 13:18:47,788:INFO:   <<< warmup_proportion: 0.1
2025-03-18 13:18:47,788:INFO:   <<< world_size: 1
2025-03-18 13:18:47,789:INFO: device: cuda:0 n_gpu: 1
2025-03-18 13:18:49,304:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-18 13:18:49,305:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-18 13:18:49,305:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-18 13:18:49,306:WARNING: Stage-One:True, Stage-Two:False
2025-03-18 13:18:49,306:WARNING: Test retrieval by loose type.
2025-03-18 13:18:49,307:WARNING: 	 embed_dim: 512
2025-03-18 13:18:49,307:WARNING: 	 image_resolution: 224
2025-03-18 13:18:49,307:WARNING: 	 vision_layers: 12
2025-03-18 13:18:49,307:WARNING: 	 vision_width: 768
2025-03-18 13:18:49,308:WARNING: 	 vision_patch_size: 16
2025-03-18 13:18:49,308:WARNING: 	 context_length: 77
2025-03-18 13:18:49,309:WARNING: 	 vocab_size: 49408
2025-03-18 13:18:49,309:WARNING: 	 transformer_width: 512
2025-03-18 13:18:49,309:WARNING: 	 transformer_heads: 8
2025-03-18 13:18:49,309:WARNING: 	 transformer_layers: 12
2025-03-18 13:18:49,309:WARNING: 		 linear_patch: 2d
2025-03-18 13:18:49,310:WARNING: 	 cut_top_layer: 0
2025-03-18 13:18:50,461:WARNING: 	 sim_header: seqTransf
2025-03-18 13:18:59,102:INFO: --------------------
2025-03-18 13:18:59,102:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-18 13:18:59,102:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-18 13:40:07,606:INFO: Effective parameters:
2025-03-18 13:40:07,606:INFO:   <<< batch_size: 80
2025-03-18 13:40:07,606:INFO:   <<< batch_size_val: 64
2025-03-18 13:40:07,606:INFO:   <<< cache_dir: 
2025-03-18 13:40:07,607:INFO:   <<< coef_lr: 0.001
2025-03-18 13:40:07,607:INFO:   <<< cross_model: cross-base
2025-03-18 13:40:07,607:INFO:   <<< cross_num_hidden_layers: 4
2025-03-18 13:40:07,607:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-18 13:40:07,608:INFO:   <<< datatype: vatex
2025-03-18 13:40:07,608:INFO:   <<< do_eval: False
2025-03-18 13:40:07,608:INFO:   <<< do_lower_case: False
2025-03-18 13:40:07,608:INFO:   <<< do_pretrain: False
2025-03-18 13:40:07,609:INFO:   <<< do_train: True
2025-03-18 13:40:07,609:INFO:   <<< epochs: 5
2025-03-18 13:40:07,609:INFO:   <<< eval_frame_order: 0
2025-03-18 13:40:07,609:INFO:   <<< expand_msrvtt_sentences: False
2025-03-18 13:40:07,609:INFO:   <<< feature_framerate: 1
2025-03-18 13:40:07,609:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-18 13:40:07,610:INFO:   <<< fp16: False
2025-03-18 13:40:07,610:INFO:   <<< fp16_opt_level: O1
2025-03-18 13:40:07,610:INFO:   <<< freeze_layer_num: 0
2025-03-18 13:40:07,610:INFO:   <<< gradient_accumulation_steps: 1
2025-03-18 13:40:07,610:INFO:   <<< hard_negative_rate: 0.5
2025-03-18 13:40:07,610:INFO:   <<< init_model: None
2025-03-18 13:40:07,611:INFO:   <<< linear_patch: 2d
2025-03-18 13:40:07,611:INFO:   <<< local_rank: 0
2025-03-18 13:40:07,611:INFO:   <<< loose_type: True
2025-03-18 13:40:07,611:INFO:   <<< lr: 0.0001
2025-03-18 13:40:07,612:INFO:   <<< lr_decay: 0.9
2025-03-18 13:40:07,612:INFO:   <<< margin: 0.1
2025-03-18 13:40:07,612:INFO:   <<< max_frames: 12
2025-03-18 13:40:07,612:INFO:   <<< max_words: 32
2025-03-18 13:40:07,612:INFO:   <<< n_display: 50
2025-03-18 13:40:07,612:INFO:   <<< n_gpu: 1
2025-03-18 13:40:07,613:INFO:   <<< n_pair: 1
2025-03-18 13:40:07,613:INFO:   <<< negative_weighting: 1
2025-03-18 13:40:07,613:INFO:   <<< num_thread_reader: 4
2025-03-18 13:40:07,613:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-18 13:40:07,614:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-18 13:40:07,614:INFO:   <<< rank: 0
2025-03-18 13:40:07,614:INFO:   <<< resume_model: None
2025-03-18 13:40:07,614:INFO:   <<< sampled_use_mil: False
2025-03-18 13:40:07,614:INFO:   <<< seed: 42
2025-03-18 13:40:07,614:INFO:   <<< sim_header: seqTransf
2025-03-18 13:40:07,614:INFO:   <<< slice_framepos: 2
2025-03-18 13:40:07,614:INFO:   <<< task_type: retrieval
2025-03-18 13:40:07,614:INFO:   <<< text_num_hidden_layers: 12
2025-03-18 13:40:07,615:INFO:   <<< train_csv: data/.train.csv
2025-03-18 13:40:07,615:INFO:   <<< train_frame_order: 0
2025-03-18 13:40:07,615:INFO:   <<< use_mil: False
2025-03-18 13:40:07,615:INFO:   <<< val_csv: data/.val.csv
2025-03-18 13:40:07,615:INFO:   <<< video_dim: 1024
2025-03-18 13:40:07,615:INFO:   <<< visual_num_hidden_layers: 12
2025-03-18 13:40:07,615:INFO:   <<< warmup_proportion: 0.1
2025-03-18 13:40:07,615:INFO:   <<< world_size: 1
2025-03-18 13:40:07,615:INFO: device: cuda:0 n_gpu: 1
2025-03-18 13:40:09,131:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-18 13:40:09,132:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-18 13:40:09,133:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-18 13:40:09,133:WARNING: Stage-One:True, Stage-Two:False
2025-03-18 13:40:09,134:WARNING: Test retrieval by loose type.
2025-03-18 13:40:09,134:WARNING: 	 embed_dim: 512
2025-03-18 13:40:09,134:WARNING: 	 image_resolution: 224
2025-03-18 13:40:09,135:WARNING: 	 vision_layers: 12
2025-03-18 13:40:09,135:WARNING: 	 vision_width: 768
2025-03-18 13:40:09,136:WARNING: 	 vision_patch_size: 16
2025-03-18 13:40:09,136:WARNING: 	 context_length: 77
2025-03-18 13:40:09,137:WARNING: 	 vocab_size: 49408
2025-03-18 13:40:09,137:WARNING: 	 transformer_width: 512
2025-03-18 13:40:09,138:WARNING: 	 transformer_heads: 8
2025-03-18 13:40:09,138:WARNING: 	 transformer_layers: 12
2025-03-18 13:40:09,139:WARNING: 		 linear_patch: 2d
2025-03-18 13:40:09,139:WARNING: 	 cut_top_layer: 0
2025-03-18 13:40:10,292:WARNING: 	 sim_header: seqTransf
2025-03-18 13:40:18,959:INFO: --------------------
2025-03-18 13:40:18,960:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-18 13:40:18,960:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-18 13:40:22,925:INFO: ***** Running test *****
2025-03-18 13:40:22,926:INFO:   Num examples = 60000
2025-03-18 13:40:22,926:INFO:   Batch size = 64
2025-03-18 13:40:22,926:INFO:   Num steps = 938
2025-03-18 13:40:22,926:INFO: ***** Running val *****
2025-03-18 13:40:22,926:INFO:   Num examples = 30000
2025-03-18 13:42:05,386:INFO: Effective parameters:
2025-03-18 13:42:05,386:INFO:   <<< batch_size: 80
2025-03-18 13:42:05,386:INFO:   <<< batch_size_val: 64
2025-03-18 13:42:05,386:INFO:   <<< cache_dir: 
2025-03-18 13:42:05,387:INFO:   <<< coef_lr: 0.001
2025-03-18 13:42:05,387:INFO:   <<< cross_model: cross-base
2025-03-18 13:42:05,387:INFO:   <<< cross_num_hidden_layers: 4
2025-03-18 13:42:05,388:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-18 13:42:05,388:INFO:   <<< datatype: vatex
2025-03-18 13:42:05,388:INFO:   <<< do_eval: False
2025-03-18 13:42:05,389:INFO:   <<< do_lower_case: False
2025-03-18 13:42:05,389:INFO:   <<< do_pretrain: False
2025-03-18 13:42:05,389:INFO:   <<< do_train: True
2025-03-18 13:42:05,390:INFO:   <<< epochs: 5
2025-03-18 13:42:05,390:INFO:   <<< eval_frame_order: 0
2025-03-18 13:42:05,390:INFO:   <<< expand_msrvtt_sentences: False
2025-03-18 13:42:05,390:INFO:   <<< feature_framerate: 1
2025-03-18 13:42:05,390:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-18 13:42:05,391:INFO:   <<< fp16: False
2025-03-18 13:42:05,391:INFO:   <<< fp16_opt_level: O1
2025-03-18 13:42:05,391:INFO:   <<< freeze_layer_num: 0
2025-03-18 13:42:05,391:INFO:   <<< gradient_accumulation_steps: 1
2025-03-18 13:42:05,392:INFO:   <<< hard_negative_rate: 0.5
2025-03-18 13:42:05,392:INFO:   <<< init_model: None
2025-03-18 13:42:05,392:INFO:   <<< linear_patch: 2d
2025-03-18 13:42:05,393:INFO:   <<< local_rank: 0
2025-03-18 13:42:05,393:INFO:   <<< loose_type: True
2025-03-18 13:42:05,393:INFO:   <<< lr: 0.0001
2025-03-18 13:42:05,394:INFO:   <<< lr_decay: 0.9
2025-03-18 13:42:05,394:INFO:   <<< margin: 0.1
2025-03-18 13:42:05,394:INFO:   <<< max_frames: 12
2025-03-18 13:42:05,394:INFO:   <<< max_words: 32
2025-03-18 13:42:05,395:INFO:   <<< n_display: 50
2025-03-18 13:42:05,395:INFO:   <<< n_gpu: 1
2025-03-18 13:42:05,395:INFO:   <<< n_pair: 1
2025-03-18 13:42:05,395:INFO:   <<< negative_weighting: 1
2025-03-18 13:42:05,395:INFO:   <<< num_thread_reader: 4
2025-03-18 13:42:05,396:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-18 13:42:05,396:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-18 13:42:05,396:INFO:   <<< rank: 0
2025-03-18 13:42:05,396:INFO:   <<< resume_model: None
2025-03-18 13:42:05,396:INFO:   <<< sampled_use_mil: False
2025-03-18 13:42:05,397:INFO:   <<< seed: 42
2025-03-18 13:42:05,397:INFO:   <<< sim_header: seqTransf
2025-03-18 13:42:05,397:INFO:   <<< slice_framepos: 2
2025-03-18 13:42:05,397:INFO:   <<< task_type: retrieval
2025-03-18 13:42:05,398:INFO:   <<< text_num_hidden_layers: 12
2025-03-18 13:42:05,398:INFO:   <<< train_csv: data/.train.csv
2025-03-18 13:42:05,398:INFO:   <<< train_frame_order: 0
2025-03-18 13:42:05,398:INFO:   <<< use_mil: False
2025-03-18 13:42:05,398:INFO:   <<< val_csv: data/.val.csv
2025-03-18 13:42:05,398:INFO:   <<< video_dim: 1024
2025-03-18 13:42:05,399:INFO:   <<< visual_num_hidden_layers: 12
2025-03-18 13:42:05,399:INFO:   <<< warmup_proportion: 0.1
2025-03-18 13:42:05,399:INFO:   <<< world_size: 1
2025-03-18 13:42:05,399:INFO: device: cuda:0 n_gpu: 1
2025-03-18 13:42:07,006:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-18 13:42:07,007:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-18 13:42:07,008:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-18 13:42:07,008:WARNING: Stage-One:True, Stage-Two:False
2025-03-18 13:42:07,008:WARNING: Test retrieval by loose type.
2025-03-18 13:42:07,009:WARNING: 	 embed_dim: 512
2025-03-18 13:42:07,009:WARNING: 	 image_resolution: 224
2025-03-18 13:42:07,010:WARNING: 	 vision_layers: 12
2025-03-18 13:42:07,010:WARNING: 	 vision_width: 768
2025-03-18 13:42:07,011:WARNING: 	 vision_patch_size: 16
2025-03-18 13:42:07,011:WARNING: 	 context_length: 77
2025-03-18 13:42:07,011:WARNING: 	 vocab_size: 49408
2025-03-18 13:42:07,012:WARNING: 	 transformer_width: 512
2025-03-18 13:42:07,012:WARNING: 	 transformer_heads: 8
2025-03-18 13:42:07,013:WARNING: 	 transformer_layers: 12
2025-03-18 13:42:07,013:WARNING: 		 linear_patch: 2d
2025-03-18 13:42:07,013:WARNING: 	 cut_top_layer: 0
2025-03-18 13:42:08,186:WARNING: 	 sim_header: seqTransf
2025-03-18 13:42:16,986:INFO: --------------------
2025-03-18 13:42:16,986:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-18 13:42:16,987:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-18 13:42:20,951:INFO: ***** Running test *****
2025-03-18 13:42:20,951:INFO:   Num examples = 60000
2025-03-18 13:42:20,951:INFO:   Batch size = 64
2025-03-18 13:42:20,952:INFO:   Num steps = 938
2025-03-18 13:42:20,952:INFO: ***** Running val *****
2025-03-18 13:42:20,952:INFO:   Num examples = 30000
2025-03-18 13:44:28,707:INFO: Effective parameters:
2025-03-18 13:44:28,707:INFO:   <<< batch_size: 80
2025-03-18 13:44:28,707:INFO:   <<< batch_size_val: 64
2025-03-18 13:44:28,707:INFO:   <<< cache_dir: 
2025-03-18 13:44:28,708:INFO:   <<< coef_lr: 0.001
2025-03-18 13:44:28,708:INFO:   <<< cross_model: cross-base
2025-03-18 13:44:28,709:INFO:   <<< cross_num_hidden_layers: 4
2025-03-18 13:44:28,709:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-18 13:44:28,709:INFO:   <<< datatype: vatex
2025-03-18 13:44:28,710:INFO:   <<< do_eval: False
2025-03-18 13:44:28,710:INFO:   <<< do_lower_case: False
2025-03-18 13:44:28,710:INFO:   <<< do_pretrain: False
2025-03-18 13:44:28,710:INFO:   <<< do_train: True
2025-03-18 13:44:28,710:INFO:   <<< epochs: 5
2025-03-18 13:44:28,711:INFO:   <<< eval_frame_order: 0
2025-03-18 13:44:28,711:INFO:   <<< expand_msrvtt_sentences: False
2025-03-18 13:44:28,711:INFO:   <<< feature_framerate: 1
2025-03-18 13:44:28,711:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-18 13:44:28,711:INFO:   <<< fp16: False
2025-03-18 13:44:28,711:INFO:   <<< fp16_opt_level: O1
2025-03-18 13:44:28,712:INFO:   <<< freeze_layer_num: 0
2025-03-18 13:44:28,712:INFO:   <<< gradient_accumulation_steps: 1
2025-03-18 13:44:28,712:INFO:   <<< hard_negative_rate: 0.5
2025-03-18 13:44:28,712:INFO:   <<< init_model: None
2025-03-18 13:44:28,713:INFO:   <<< linear_patch: 2d
2025-03-18 13:44:28,713:INFO:   <<< local_rank: 0
2025-03-18 13:44:28,713:INFO:   <<< loose_type: True
2025-03-18 13:44:28,713:INFO:   <<< lr: 0.0001
2025-03-18 13:44:28,713:INFO:   <<< lr_decay: 0.9
2025-03-18 13:44:28,714:INFO:   <<< margin: 0.1
2025-03-18 13:44:28,714:INFO:   <<< max_frames: 12
2025-03-18 13:44:28,714:INFO:   <<< max_words: 32
2025-03-18 13:44:28,714:INFO:   <<< n_display: 50
2025-03-18 13:44:28,714:INFO:   <<< n_gpu: 1
2025-03-18 13:44:28,714:INFO:   <<< n_pair: 1
2025-03-18 13:44:28,715:INFO:   <<< negative_weighting: 1
2025-03-18 13:44:28,715:INFO:   <<< num_thread_reader: 4
2025-03-18 13:44:28,715:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-18 13:44:28,715:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-18 13:44:28,716:INFO:   <<< rank: 0
2025-03-18 13:44:28,716:INFO:   <<< resume_model: None
2025-03-18 13:44:28,716:INFO:   <<< sampled_use_mil: False
2025-03-18 13:44:28,716:INFO:   <<< seed: 42
2025-03-18 13:44:28,716:INFO:   <<< sim_header: seqTransf
2025-03-18 13:44:28,716:INFO:   <<< slice_framepos: 2
2025-03-18 13:44:28,717:INFO:   <<< task_type: retrieval
2025-03-18 13:44:28,717:INFO:   <<< text_num_hidden_layers: 12
2025-03-18 13:44:28,717:INFO:   <<< train_csv: data/.train.csv
2025-03-18 13:44:28,717:INFO:   <<< train_frame_order: 0
2025-03-18 13:44:28,717:INFO:   <<< use_mil: False
2025-03-18 13:44:28,717:INFO:   <<< val_csv: data/.val.csv
2025-03-18 13:44:28,718:INFO:   <<< video_dim: 1024
2025-03-18 13:44:28,718:INFO:   <<< visual_num_hidden_layers: 12
2025-03-18 13:44:28,718:INFO:   <<< warmup_proportion: 0.1
2025-03-18 13:44:28,718:INFO:   <<< world_size: 1
2025-03-18 13:44:28,719:INFO: device: cuda:0 n_gpu: 1
2025-03-18 13:44:30,262:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-18 13:44:30,263:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-18 13:44:30,264:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-18 13:44:30,264:WARNING: Stage-One:True, Stage-Two:False
2025-03-18 13:44:30,265:WARNING: Test retrieval by loose type.
2025-03-18 13:44:30,265:WARNING: 	 embed_dim: 512
2025-03-18 13:44:30,265:WARNING: 	 image_resolution: 224
2025-03-18 13:44:30,266:WARNING: 	 vision_layers: 12
2025-03-18 13:44:30,266:WARNING: 	 vision_width: 768
2025-03-18 13:44:30,267:WARNING: 	 vision_patch_size: 16
2025-03-18 13:44:30,267:WARNING: 	 context_length: 77
2025-03-18 13:44:30,268:WARNING: 	 vocab_size: 49408
2025-03-18 13:44:30,268:WARNING: 	 transformer_width: 512
2025-03-18 13:44:30,269:WARNING: 	 transformer_heads: 8
2025-03-18 13:44:30,269:WARNING: 	 transformer_layers: 12
2025-03-18 13:44:30,270:WARNING: 		 linear_patch: 2d
2025-03-18 13:44:30,270:WARNING: 	 cut_top_layer: 0
2025-03-18 13:44:34,409:WARNING: 	 sim_header: seqTransf
2025-03-18 13:44:55,778:INFO: --------------------
2025-03-18 13:44:55,779:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-18 13:44:55,779:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-18 13:45:02,456:INFO: ***** Running test *****
2025-03-18 13:45:02,456:INFO:   Num examples = 60000
2025-03-18 13:45:02,456:INFO:   Batch size = 64
2025-03-18 13:45:02,456:INFO:   Num steps = 938
2025-03-18 13:45:02,457:INFO: ***** Running val *****
2025-03-18 13:45:02,457:INFO:   Num examples = 30000
2025-03-18 13:45:07,747:INFO: ***** Running training *****
2025-03-18 13:45:07,747:INFO:   Num examples = 259910
2025-03-18 13:45:07,747:INFO:   Batch size = 80
2025-03-18 13:45:07,748:INFO:   Num steps = 16240
2025-03-20 15:09:07,286:INFO: Effective parameters:
2025-03-20 15:09:07,286:INFO:   <<< batch_size: 80
2025-03-20 15:09:07,286:INFO:   <<< batch_size_val: 64
2025-03-20 15:09:07,290:INFO:   <<< cache_dir: 
2025-03-20 15:09:07,290:INFO:   <<< coef_lr: 0.001
2025-03-20 15:09:07,291:INFO:   <<< cross_model: cross-base
2025-03-20 15:09:07,291:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 15:09:07,291:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 15:09:07,291:INFO:   <<< datatype: vatex
2025-03-20 15:09:07,292:INFO:   <<< do_eval: False
2025-03-20 15:09:07,292:INFO:   <<< do_lower_case: False
2025-03-20 15:09:07,292:INFO:   <<< do_pretrain: False
2025-03-20 15:09:07,292:INFO:   <<< do_train: True
2025-03-20 15:09:07,292:INFO:   <<< epochs: 5
2025-03-20 15:09:07,293:INFO:   <<< eval_frame_order: 0
2025-03-20 15:09:07,293:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 15:09:07,293:INFO:   <<< feature_framerate: 1
2025-03-20 15:09:07,293:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 15:09:07,294:INFO:   <<< fp16: False
2025-03-20 15:09:07,294:INFO:   <<< fp16_opt_level: O1
2025-03-20 15:09:07,294:INFO:   <<< freeze_layer_num: 0
2025-03-20 15:09:07,294:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 15:09:07,294:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 15:09:07,295:INFO:   <<< init_model: None
2025-03-20 15:09:07,295:INFO:   <<< linear_patch: 2d
2025-03-20 15:09:07,296:INFO:   <<< local_rank: 0
2025-03-20 15:09:07,296:INFO:   <<< loose_type: True
2025-03-20 15:09:07,296:INFO:   <<< lr: 0.0001
2025-03-20 15:09:07,296:INFO:   <<< lr_decay: 0.9
2025-03-20 15:09:07,296:INFO:   <<< margin: 0.1
2025-03-20 15:09:07,296:INFO:   <<< max_frames: 12
2025-03-20 15:09:07,297:INFO:   <<< max_words: 32
2025-03-20 15:09:07,297:INFO:   <<< n_display: 50
2025-03-20 15:09:07,297:INFO:   <<< n_gpu: 1
2025-03-20 15:09:07,297:INFO:   <<< n_pair: 1
2025-03-20 15:09:07,298:INFO:   <<< negative_weighting: 1
2025-03-20 15:09:07,298:INFO:   <<< num_thread_reader: 4
2025-03-20 15:09:07,298:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 15:09:07,298:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 15:09:07,298:INFO:   <<< rank: 0
2025-03-20 15:09:07,299:INFO:   <<< resume_model: None
2025-03-20 15:09:07,299:INFO:   <<< sampled_use_mil: False
2025-03-20 15:09:07,299:INFO:   <<< seed: 42
2025-03-20 15:09:07,299:INFO:   <<< sim_header: seqTransf
2025-03-20 15:09:07,299:INFO:   <<< slice_framepos: 2
2025-03-20 15:09:07,300:INFO:   <<< task_type: retrieval
2025-03-20 15:09:07,300:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 15:09:07,300:INFO:   <<< train_csv: data/.train.csv
2025-03-20 15:09:07,300:INFO:   <<< train_frame_order: 0
2025-03-20 15:09:07,301:INFO:   <<< use_mil: False
2025-03-20 15:09:07,301:INFO:   <<< val_csv: data/.val.csv
2025-03-20 15:09:07,301:INFO:   <<< video_dim: 1024
2025-03-20 15:09:07,301:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 15:09:07,302:INFO:   <<< warmup_proportion: 0.1
2025-03-20 15:09:07,302:INFO:   <<< world_size: 1
2025-03-20 15:09:07,302:INFO: device: cuda:0 n_gpu: 1
2025-03-20 15:09:08,859:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 15:09:08,860:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 15:09:08,861:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 15:09:08,861:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 15:09:08,861:WARNING: Test retrieval by loose type.
2025-03-20 15:09:08,862:WARNING: 	 embed_dim: 512
2025-03-20 15:09:08,862:WARNING: 	 image_resolution: 224
2025-03-20 15:09:08,862:WARNING: 	 vision_layers: 12
2025-03-20 15:09:08,862:WARNING: 	 vision_width: 768
2025-03-20 15:09:08,863:WARNING: 	 vision_patch_size: 16
2025-03-20 15:09:08,863:WARNING: 	 context_length: 77
2025-03-20 15:09:08,864:WARNING: 	 vocab_size: 49408
2025-03-20 15:09:08,864:WARNING: 	 transformer_width: 512
2025-03-20 15:09:08,864:WARNING: 	 transformer_heads: 8
2025-03-20 15:09:08,865:WARNING: 	 transformer_layers: 12
2025-03-20 15:09:08,865:WARNING: 		 linear_patch: 2d
2025-03-20 15:09:08,865:WARNING: 	 cut_top_layer: 0
2025-03-20 15:09:10,009:WARNING: 	 sim_header: seqTransf
2025-03-20 15:09:18,704:INFO: --------------------
2025-03-20 15:09:18,704:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 15:09:18,704:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 15:09:22,920:INFO: ***** Running test *****
2025-03-20 15:09:22,920:INFO:   Num examples = 60000
2025-03-20 15:09:22,921:INFO:   Batch size = 64
2025-03-20 15:09:22,921:INFO:   Num steps = 938
2025-03-20 15:09:22,921:INFO: ***** Running val *****
2025-03-20 15:09:22,921:INFO:   Num examples = 30000
2025-03-20 17:57:55,152:INFO: Effective parameters:
2025-03-20 17:57:55,152:INFO:   <<< batch_size: 80
2025-03-20 17:57:55,152:INFO:   <<< batch_size_val: 64
2025-03-20 17:57:55,152:INFO:   <<< cache_dir: 
2025-03-20 17:57:55,152:INFO:   <<< coef_lr: 0.001
2025-03-20 17:57:55,152:INFO:   <<< cross_model: cross-base
2025-03-20 17:57:55,152:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 17:57:55,153:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 17:57:55,153:INFO:   <<< datatype: vatex
2025-03-20 17:57:55,153:INFO:   <<< do_eval: False
2025-03-20 17:57:55,153:INFO:   <<< do_lower_case: False
2025-03-20 17:57:55,153:INFO:   <<< do_pretrain: False
2025-03-20 17:57:55,153:INFO:   <<< do_train: True
2025-03-20 17:57:55,153:INFO:   <<< epochs: 5
2025-03-20 17:57:55,153:INFO:   <<< eval_frame_order: 0
2025-03-20 17:57:55,153:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 17:57:55,153:INFO:   <<< feature_framerate: 1
2025-03-20 17:57:55,153:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 17:57:55,153:INFO:   <<< fp16: False
2025-03-20 17:57:55,153:INFO:   <<< fp16_opt_level: O1
2025-03-20 17:57:55,153:INFO:   <<< freeze_layer_num: 0
2025-03-20 17:57:55,153:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 17:57:55,153:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 17:57:55,153:INFO:   <<< init_model: None
2025-03-20 17:57:55,153:INFO:   <<< linear_patch: 2d
2025-03-20 17:57:55,153:INFO:   <<< local_rank: 0
2025-03-20 17:57:55,153:INFO:   <<< loose_type: True
2025-03-20 17:57:55,153:INFO:   <<< lr: 0.0001
2025-03-20 17:57:55,154:INFO:   <<< lr_decay: 0.9
2025-03-20 17:57:55,154:INFO:   <<< margin: 0.1
2025-03-20 17:57:55,154:INFO:   <<< max_frames: 12
2025-03-20 17:57:55,154:INFO:   <<< max_words: 32
2025-03-20 17:57:55,154:INFO:   <<< n_display: 50
2025-03-20 17:57:55,154:INFO:   <<< n_gpu: 1
2025-03-20 17:57:55,154:INFO:   <<< n_pair: 1
2025-03-20 17:57:55,154:INFO:   <<< negative_weighting: 1
2025-03-20 17:57:55,154:INFO:   <<< num_thread_reader: 4
2025-03-20 17:57:55,154:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 17:57:55,154:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 17:57:55,154:INFO:   <<< rank: 0
2025-03-20 17:57:55,154:INFO:   <<< resume_model: None
2025-03-20 17:57:55,154:INFO:   <<< sampled_use_mil: False
2025-03-20 17:57:55,154:INFO:   <<< seed: 42
2025-03-20 17:57:55,154:INFO:   <<< sim_header: seqTransf
2025-03-20 17:57:55,154:INFO:   <<< slice_framepos: 2
2025-03-20 17:57:55,154:INFO:   <<< task_type: retrieval
2025-03-20 17:57:55,154:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 17:57:55,154:INFO:   <<< train_csv: data/.train.csv
2025-03-20 17:57:55,154:INFO:   <<< train_frame_order: 0
2025-03-20 17:57:55,154:INFO:   <<< use_mil: False
2025-03-20 17:57:55,155:INFO:   <<< val_csv: data/.val.csv
2025-03-20 17:57:55,155:INFO:   <<< video_dim: 1024
2025-03-20 17:57:55,155:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 17:57:55,155:INFO:   <<< warmup_proportion: 0.1
2025-03-20 17:57:55,155:INFO:   <<< world_size: 1
2025-03-20 17:57:55,155:INFO: device: cuda:0 n_gpu: 1
2025-03-20 17:57:57,789:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 17:57:57,817:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 17:57:57,817:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 17:57:57,817:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 17:57:57,817:WARNING: Test retrieval by loose type.
2025-03-20 17:57:57,818:WARNING: 	 embed_dim: 512
2025-03-20 17:57:57,818:WARNING: 	 image_resolution: 224
2025-03-20 17:57:57,818:WARNING: 	 vision_layers: 12
2025-03-20 17:57:57,818:WARNING: 	 vision_width: 768
2025-03-20 17:57:57,818:WARNING: 	 vision_patch_size: 16
2025-03-20 17:57:57,818:WARNING: 	 context_length: 77
2025-03-20 17:57:57,818:WARNING: 	 vocab_size: 49408
2025-03-20 17:57:57,818:WARNING: 	 transformer_width: 512
2025-03-20 17:57:57,818:WARNING: 	 transformer_heads: 8
2025-03-20 17:57:57,818:WARNING: 	 transformer_layers: 12
2025-03-20 17:57:57,818:WARNING: 		 linear_patch: 2d
2025-03-20 17:57:57,818:WARNING: 	 cut_top_layer: 0
2025-03-20 17:58:01,932:WARNING: 	 sim_header: seqTransf
2025-03-20 17:58:12,931:INFO: --------------------
2025-03-20 17:58:12,932:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 17:58:12,932:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 17:58:24,663:INFO: ***** Running test *****
2025-03-20 17:58:24,663:INFO:   Num examples = 60000
2025-03-20 17:58:24,664:INFO:   Batch size = 64
2025-03-20 17:58:24,664:INFO:   Num steps = 938
2025-03-20 17:58:24,664:INFO: ***** Running val *****
2025-03-20 17:58:24,664:INFO:   Num examples = 30000
2025-03-20 17:58:44,448:INFO: ***** Running training *****
2025-03-20 17:58:44,449:INFO:   Num examples = 259910
2025-03-20 17:58:44,449:INFO:   Batch size = 80
2025-03-20 17:58:44,449:INFO:   Num steps = 16240
2025-03-20 18:09:13,152:INFO: Effective parameters:
2025-03-20 18:09:13,152:INFO:   <<< batch_size: 80
2025-03-20 18:09:13,152:INFO:   <<< batch_size_val: 64
2025-03-20 18:09:13,152:INFO:   <<< cache_dir: 
2025-03-20 18:09:13,152:INFO:   <<< coef_lr: 0.001
2025-03-20 18:09:13,152:INFO:   <<< cross_model: cross-base
2025-03-20 18:09:13,152:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:09:13,152:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:09:13,152:INFO:   <<< datatype: vatex
2025-03-20 18:09:13,152:INFO:   <<< do_eval: False
2025-03-20 18:09:13,152:INFO:   <<< do_lower_case: False
2025-03-20 18:09:13,152:INFO:   <<< do_pretrain: False
2025-03-20 18:09:13,152:INFO:   <<< do_train: True
2025-03-20 18:09:13,152:INFO:   <<< epochs: 5
2025-03-20 18:09:13,152:INFO:   <<< eval_frame_order: 0
2025-03-20 18:09:13,153:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:09:13,153:INFO:   <<< feature_framerate: 1
2025-03-20 18:09:13,153:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:09:13,153:INFO:   <<< fp16: False
2025-03-20 18:09:13,153:INFO:   <<< fp16_opt_level: O1
2025-03-20 18:09:13,153:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:09:13,153:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:09:13,153:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:09:13,153:INFO:   <<< init_model: None
2025-03-20 18:09:13,153:INFO:   <<< linear_patch: 2d
2025-03-20 18:09:13,153:INFO:   <<< local_rank: 0
2025-03-20 18:09:13,153:INFO:   <<< loose_type: True
2025-03-20 18:09:13,153:INFO:   <<< lr: 0.0001
2025-03-20 18:09:13,153:INFO:   <<< lr_decay: 0.9
2025-03-20 18:09:13,153:INFO:   <<< margin: 0.1
2025-03-20 18:09:13,153:INFO:   <<< max_frames: 12
2025-03-20 18:09:13,153:INFO:   <<< max_words: 32
2025-03-20 18:09:13,153:INFO:   <<< n_display: 50
2025-03-20 18:09:13,153:INFO:   <<< n_gpu: 1
2025-03-20 18:09:13,153:INFO:   <<< n_pair: 1
2025-03-20 18:09:13,153:INFO:   <<< negative_weighting: 1
2025-03-20 18:09:13,154:INFO:   <<< num_thread_reader: 2
2025-03-20 18:09:13,154:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:09:13,154:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:09:13,154:INFO:   <<< rank: 0
2025-03-20 18:09:13,154:INFO:   <<< resume_model: None
2025-03-20 18:09:13,154:INFO:   <<< sampled_use_mil: False
2025-03-20 18:09:13,154:INFO:   <<< seed: 42
2025-03-20 18:09:13,154:INFO:   <<< sim_header: seqTransf
2025-03-20 18:09:13,154:INFO:   <<< slice_framepos: 2
2025-03-20 18:09:13,154:INFO:   <<< task_type: retrieval
2025-03-20 18:09:13,154:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:09:13,154:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:09:13,154:INFO:   <<< train_frame_order: 0
2025-03-20 18:09:13,154:INFO:   <<< use_mil: False
2025-03-20 18:09:13,154:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:09:13,154:INFO:   <<< video_dim: 1024
2025-03-20 18:09:13,154:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:09:13,154:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:09:13,154:INFO:   <<< world_size: 1
2025-03-20 18:09:13,154:INFO: device: cuda:0 n_gpu: 1
2025-03-20 18:09:15,397:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:09:15,398:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:09:15,399:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:09:15,399:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:09:15,399:WARNING: Test retrieval by loose type.
2025-03-20 18:09:15,399:WARNING: 	 embed_dim: 512
2025-03-20 18:09:15,399:WARNING: 	 image_resolution: 224
2025-03-20 18:09:15,399:WARNING: 	 vision_layers: 12
2025-03-20 18:09:15,399:WARNING: 	 vision_width: 768
2025-03-20 18:09:15,400:WARNING: 	 vision_patch_size: 16
2025-03-20 18:09:15,400:WARNING: 	 context_length: 77
2025-03-20 18:09:15,400:WARNING: 	 vocab_size: 49408
2025-03-20 18:09:15,400:WARNING: 	 transformer_width: 512
2025-03-20 18:09:15,400:WARNING: 	 transformer_heads: 8
2025-03-20 18:09:15,400:WARNING: 	 transformer_layers: 12
2025-03-20 18:09:15,400:WARNING: 		 linear_patch: 2d
2025-03-20 18:09:15,400:WARNING: 	 cut_top_layer: 0
2025-03-20 18:09:19,479:WARNING: 	 sim_header: seqTransf
2025-03-20 18:09:30,489:INFO: --------------------
2025-03-20 18:09:30,489:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:09:30,490:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:09:42,055:INFO: ***** Running test *****
2025-03-20 18:09:42,055:INFO:   Num examples = 60000
2025-03-20 18:09:42,055:INFO:   Batch size = 64
2025-03-20 18:09:42,055:INFO:   Num steps = 938
2025-03-20 18:09:42,055:INFO: ***** Running val *****
2025-03-20 18:09:42,055:INFO:   Num examples = 30000
2025-03-20 18:10:01,429:INFO: ***** Running training *****
2025-03-20 18:10:01,430:INFO:   Num examples = 259910
2025-03-20 18:10:01,430:INFO:   Batch size = 80
2025-03-20 18:10:01,430:INFO:   Num steps = 16240
2025-03-20 18:33:19,388:INFO: Effective parameters:
2025-03-20 18:33:19,388:INFO:   <<< batch_size: 16
2025-03-20 18:33:19,388:INFO: Effective parameters:
2025-03-20 18:33:19,388:INFO:   <<< batch_size_val: 64
2025-03-20 18:33:19,388:INFO:   <<< batch_size: 16
2025-03-20 18:33:19,388:INFO:   <<< cache_dir: 
2025-03-20 18:33:19,388:INFO:   <<< batch_size_val: 64
2025-03-20 18:33:19,388:INFO:   <<< coef_lr: 0.001
2025-03-20 18:33:19,388:INFO:   <<< cache_dir: 
2025-03-20 18:33:19,389:INFO:   <<< cross_model: cross-base
2025-03-20 18:33:19,389:INFO:   <<< coef_lr: 0.001
2025-03-20 18:33:19,389:INFO:   <<< cross_model: cross-base
2025-03-20 18:33:19,389:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:33:19,389:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:33:19,389:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:33:19,389:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:33:19,389:INFO:   <<< datatype: vatex
2025-03-20 18:33:19,389:INFO:   <<< datatype: vatex
2025-03-20 18:33:19,389:INFO:   <<< do_eval: False
2025-03-20 18:33:19,389:INFO:   <<< do_eval: False
2025-03-20 18:33:19,389:INFO:   <<< do_lower_case: False
2025-03-20 18:33:19,389:INFO:   <<< do_lower_case: False
2025-03-20 18:33:19,389:INFO:   <<< do_pretrain: False
2025-03-20 18:33:19,389:INFO:   <<< do_pretrain: False
2025-03-20 18:33:19,389:INFO:   <<< do_train: True
2025-03-20 18:33:19,389:INFO:   <<< do_train: True
2025-03-20 18:33:19,389:INFO:   <<< epochs: 5
2025-03-20 18:33:19,389:INFO:   <<< epochs: 5
2025-03-20 18:33:19,389:INFO:   <<< eval_frame_order: 0
2025-03-20 18:33:19,389:INFO:   <<< eval_frame_order: 0
2025-03-20 18:33:19,389:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:33:19,389:INFO:   <<< feature_framerate: 1
2025-03-20 18:33:19,389:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:33:19,389:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:33:19,389:INFO:   <<< feature_framerate: 1
2025-03-20 18:33:19,389:INFO:   <<< fp16: True
2025-03-20 18:33:19,389:INFO:   <<< fp16_opt_level: O1
2025-03-20 18:33:19,389:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:33:19,389:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:33:19,389:INFO:   <<< fp16: True
2025-03-20 18:33:19,389:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:33:19,389:INFO:   <<< fp16_opt_level: O1
2025-03-20 18:33:19,389:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:33:19,389:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:33:19,390:INFO:   <<< init_model: None
2025-03-20 18:33:19,390:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:33:19,390:INFO:   <<< linear_patch: 2d
2025-03-20 18:33:19,390:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:33:19,390:INFO:   <<< local_rank: 0
2025-03-20 18:33:19,390:INFO:   <<< init_model: None
2025-03-20 18:33:19,390:INFO:   <<< loose_type: True
2025-03-20 18:33:19,390:INFO:   <<< linear_patch: 2d
2025-03-20 18:33:19,390:INFO:   <<< lr: 0.0001
2025-03-20 18:33:19,390:INFO:   <<< lr_decay: 0.9
2025-03-20 18:33:19,390:INFO:   <<< local_rank: 0
2025-03-20 18:33:19,390:INFO:   <<< margin: 0.1
2025-03-20 18:33:19,390:INFO:   <<< loose_type: True
2025-03-20 18:33:19,390:INFO:   <<< lr: 0.0001
2025-03-20 18:33:19,390:INFO:   <<< max_frames: 12
2025-03-20 18:33:19,390:INFO:   <<< max_words: 32
2025-03-20 18:33:19,390:INFO:   <<< lr_decay: 0.9
2025-03-20 18:33:19,390:INFO:   <<< margin: 0.1
2025-03-20 18:33:19,390:INFO:   <<< n_display: 50
2025-03-20 18:33:19,390:INFO:   <<< max_frames: 12
2025-03-20 18:33:19,390:INFO:   <<< n_gpu: 2
2025-03-20 18:33:19,390:INFO:   <<< n_pair: 1
2025-03-20 18:33:19,390:INFO:   <<< max_words: 32
2025-03-20 18:33:19,390:INFO:   <<< negative_weighting: 1
2025-03-20 18:33:19,390:INFO:   <<< n_display: 50
2025-03-20 18:33:19,390:INFO:   <<< num_thread_reader: 2
2025-03-20 18:33:19,390:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:33:19,390:INFO:   <<< n_gpu: 2
2025-03-20 18:33:19,390:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:33:19,390:INFO:   <<< n_pair: 1
2025-03-20 18:33:19,390:INFO:   <<< rank: 0
2025-03-20 18:33:19,390:INFO:   <<< negative_weighting: 1
2025-03-20 18:33:19,390:INFO:   <<< resume_model: None
2025-03-20 18:33:19,390:INFO:   <<< num_thread_reader: 2
2025-03-20 18:33:19,390:INFO:   <<< sampled_use_mil: False
2025-03-20 18:33:19,390:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:33:19,390:INFO:   <<< seed: 42
2025-03-20 18:33:19,390:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:33:19,390:INFO:   <<< sim_header: seqTransf
2025-03-20 18:33:19,391:INFO:   <<< rank: 1
2025-03-20 18:33:19,391:INFO:   <<< slice_framepos: 2
2025-03-20 18:33:19,391:INFO:   <<< task_type: retrieval
2025-03-20 18:33:19,391:INFO:   <<< resume_model: None
2025-03-20 18:33:19,391:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:33:19,391:INFO:   <<< sampled_use_mil: False
2025-03-20 18:33:19,391:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:33:19,391:INFO:   <<< seed: 42
2025-03-20 18:33:19,391:INFO:   <<< train_frame_order: 0
2025-03-20 18:33:19,391:INFO:   <<< sim_header: seqTransf
2025-03-20 18:33:19,391:INFO:   <<< use_mil: False
2025-03-20 18:33:19,391:INFO:   <<< slice_framepos: 2
2025-03-20 18:33:19,391:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:33:19,391:INFO:   <<< task_type: retrieval
2025-03-20 18:33:19,391:INFO:   <<< video_dim: 1024
2025-03-20 18:33:19,391:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:33:19,391:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:33:19,391:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:33:19,391:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:33:19,391:INFO:   <<< world_size: 2
2025-03-20 18:33:19,391:INFO:   <<< train_frame_order: 0
2025-03-20 18:33:19,391:INFO:   <<< use_mil: False
2025-03-20 18:33:19,391:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:33:19,391:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:33:19,391:INFO:   <<< video_dim: 1024
2025-03-20 18:33:19,391:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:33:19,391:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:33:19,391:INFO:   <<< world_size: 2
2025-03-20 18:33:19,391:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:33:22,627:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:33:22,629:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:33:22,629:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:33:22,630:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:33:22,630:WARNING: Test retrieval by loose type.
2025-03-20 18:33:22,631:WARNING: 	 embed_dim: 512
2025-03-20 18:33:22,631:WARNING: 	 image_resolution: 224
2025-03-20 18:33:22,631:WARNING: 	 vision_layers: 12
2025-03-20 18:33:22,631:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:33:22,631:WARNING: 	 vision_width: 768
2025-03-20 18:33:22,631:WARNING: 	 vision_patch_size: 16
2025-03-20 18:33:22,631:WARNING: 	 context_length: 77
2025-03-20 18:33:22,631:WARNING: 	 vocab_size: 49408
2025-03-20 18:33:22,631:WARNING: 	 transformer_width: 512
2025-03-20 18:33:22,631:WARNING: 	 transformer_heads: 8
2025-03-20 18:33:22,631:WARNING: 	 transformer_layers: 12
2025-03-20 18:33:22,631:WARNING: 		 linear_patch: 2d
2025-03-20 18:33:22,631:WARNING: 	 cut_top_layer: 0
2025-03-20 18:33:22,632:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:33:22,632:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:33:22,632:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:33:22,632:WARNING: Test retrieval by loose type.
2025-03-20 18:33:22,633:WARNING: 	 embed_dim: 512
2025-03-20 18:33:22,633:WARNING: 	 image_resolution: 224
2025-03-20 18:33:22,633:WARNING: 	 vision_layers: 12
2025-03-20 18:33:22,633:WARNING: 	 vision_width: 768
2025-03-20 18:33:22,633:WARNING: 	 vision_patch_size: 16
2025-03-20 18:33:22,633:WARNING: 	 context_length: 77
2025-03-20 18:33:22,633:WARNING: 	 vocab_size: 49408
2025-03-20 18:33:22,633:WARNING: 	 transformer_width: 512
2025-03-20 18:33:22,633:WARNING: 	 transformer_heads: 8
2025-03-20 18:33:22,633:WARNING: 	 transformer_layers: 12
2025-03-20 18:33:22,633:WARNING: 		 linear_patch: 2d
2025-03-20 18:33:22,633:WARNING: 	 cut_top_layer: 0
2025-03-20 18:33:24,847:WARNING: 	 sim_header: seqTransf
2025-03-20 18:33:24,859:WARNING: 	 sim_header: seqTransf
2025-03-20 18:33:37,624:INFO: --------------------
2025-03-20 18:33:37,625:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:33:37,625:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:33:37,679:INFO: --------------------
2025-03-20 18:33:37,680:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:33:37,680:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:33:47,343:INFO: ***** Running test *****
2025-03-20 18:33:47,344:INFO:   Num examples = 60000
2025-03-20 18:33:47,344:INFO:   Batch size = 64
2025-03-20 18:33:47,344:INFO:   Num steps = 938
2025-03-20 18:33:47,344:INFO: ***** Running val *****
2025-03-20 18:33:47,344:INFO:   Num examples = 30000
2025-03-20 18:33:47,372:INFO: ***** Running test *****
2025-03-20 18:33:47,372:INFO:   Num examples = 60000
2025-03-20 18:33:47,372:INFO:   Batch size = 64
2025-03-20 18:33:47,372:INFO:   Num steps = 938
2025-03-20 18:33:47,372:INFO: ***** Running val *****
2025-03-20 18:33:47,372:INFO:   Num examples = 30000
2025-03-20 18:37:26,213:INFO: Effective parameters:
2025-03-20 18:37:26,213:INFO:   <<< batch_size: 16
2025-03-20 18:37:26,213:INFO:   <<< batch_size_val: 64
2025-03-20 18:37:26,213:INFO:   <<< cache_dir: 
2025-03-20 18:37:26,213:INFO:   <<< coef_lr: 0.001
2025-03-20 18:37:26,213:INFO:   <<< cross_model: cross-base
2025-03-20 18:37:26,213:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:37:26,213:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:37:26,213:INFO:   <<< datatype: vatex
2025-03-20 18:37:26,214:INFO:   <<< do_eval: False
2025-03-20 18:37:26,214:INFO:   <<< do_lower_case: False
2025-03-20 18:37:26,214:INFO:   <<< do_pretrain: False
2025-03-20 18:37:26,214:INFO:   <<< do_train: True
2025-03-20 18:37:26,214:INFO:   <<< epochs: 5
2025-03-20 18:37:26,214:INFO:   <<< eval_frame_order: 0
2025-03-20 18:37:26,214:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:37:26,214:INFO:   <<< feature_framerate: 1
2025-03-20 18:37:26,214:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:37:26,214:INFO:   <<< fp16: True
2025-03-20 18:37:26,214:INFO:   <<< fp16_opt_level: O1
2025-03-20 18:37:26,214:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:37:26,214:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:37:26,214:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:37:26,214:INFO:   <<< init_model: None
2025-03-20 18:37:26,214:INFO:   <<< linear_patch: 2d
2025-03-20 18:37:26,214:INFO:   <<< local_rank: 0
2025-03-20 18:37:26,214:INFO:   <<< loose_type: True
2025-03-20 18:37:26,214:INFO:   <<< lr: 0.0001
2025-03-20 18:37:26,214:INFO:   <<< lr_decay: 0.9
2025-03-20 18:37:26,214:INFO:   <<< margin: 0.1
2025-03-20 18:37:26,214:INFO:   <<< max_frames: 12
2025-03-20 18:37:26,215:INFO:   <<< max_words: 32
2025-03-20 18:37:26,215:INFO:   <<< n_display: 50
2025-03-20 18:37:26,215:INFO:   <<< n_gpu: 2
2025-03-20 18:37:26,215:INFO:   <<< n_pair: 1
2025-03-20 18:37:26,215:INFO:   <<< negative_weighting: 1
2025-03-20 18:37:26,215:INFO:   <<< num_thread_reader: 2
2025-03-20 18:37:26,215:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:37:26,215:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:37:26,215:INFO:   <<< rank: 0
2025-03-20 18:37:26,215:INFO:   <<< resume_model: None
2025-03-20 18:37:26,215:INFO:   <<< sampled_use_mil: False
2025-03-20 18:37:26,215:INFO:   <<< seed: 42
2025-03-20 18:37:26,215:INFO:   <<< sim_header: seqTransf
2025-03-20 18:37:26,215:INFO:   <<< slice_framepos: 2
2025-03-20 18:37:26,215:INFO:   <<< task_type: retrieval
2025-03-20 18:37:26,215:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:37:26,215:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:37:26,215:INFO:   <<< train_frame_order: 0
2025-03-20 18:37:26,215:INFO:   <<< use_mil: False
2025-03-20 18:37:26,215:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:37:26,215:INFO:   <<< video_dim: 1024
2025-03-20 18:37:26,216:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:37:26,216:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:37:26,216:INFO:   <<< world_size: 1
2025-03-20 18:37:26,216:INFO: device: cuda:0 n_gpu: 1
2025-03-20 18:37:28,212:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:37:28,213:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:37:28,213:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:37:28,214:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:37:28,214:WARNING: Test retrieval by loose type.
2025-03-20 18:37:28,214:WARNING: 	 embed_dim: 512
2025-03-20 18:37:28,214:WARNING: 	 image_resolution: 224
2025-03-20 18:37:28,214:WARNING: 	 vision_layers: 12
2025-03-20 18:37:28,214:WARNING: 	 vision_width: 768
2025-03-20 18:37:28,214:WARNING: 	 vision_patch_size: 16
2025-03-20 18:37:28,214:WARNING: 	 context_length: 77
2025-03-20 18:37:28,214:WARNING: 	 vocab_size: 49408
2025-03-20 18:37:28,214:WARNING: 	 transformer_width: 512
2025-03-20 18:37:28,214:WARNING: 	 transformer_heads: 8
2025-03-20 18:37:28,215:WARNING: 	 transformer_layers: 12
2025-03-20 18:37:28,215:WARNING: 		 linear_patch: 2d
2025-03-20 18:37:28,215:WARNING: 	 cut_top_layer: 0
2025-03-20 18:37:31,914:WARNING: 	 sim_header: seqTransf
2025-03-20 18:37:42,830:INFO: --------------------
2025-03-20 18:37:42,830:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:37:42,831:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:37:54,400:INFO: ***** Running test *****
2025-03-20 18:37:54,400:INFO:   Num examples = 60000
2025-03-20 18:37:54,400:INFO:   Batch size = 64
2025-03-20 18:37:54,400:INFO:   Num steps = 938
2025-03-20 18:37:54,400:INFO: ***** Running val *****
2025-03-20 18:37:54,400:INFO:   Num examples = 30000
2025-03-20 18:38:13,684:INFO: ***** Running training *****
2025-03-20 18:38:13,684:INFO:   Num examples = 259910
2025-03-20 18:38:13,684:INFO:   Batch size = 16
2025-03-20 18:38:13,684:INFO:   Num steps = 81220
2025-03-20 18:42:34,339:INFO: Effective parameters:
2025-03-20 18:42:34,339:INFO:   <<< batch_size: 16
2025-03-20 18:42:34,339:INFO:   <<< batch_size_val: 64
2025-03-20 18:42:34,339:INFO:   <<< cache_dir: 
2025-03-20 18:42:34,339:INFO:   <<< coef_lr: 0.001
2025-03-20 18:42:34,339:INFO:   <<< cross_model: cross-base
2025-03-20 18:42:34,339:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:42:34,340:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:42:34,340:INFO:   <<< datatype: vatex
2025-03-20 18:42:34,340:INFO:   <<< do_eval: False
2025-03-20 18:42:34,340:INFO:   <<< do_lower_case: False
2025-03-20 18:42:34,340:INFO:   <<< do_pretrain: False
2025-03-20 18:42:34,340:INFO:   <<< do_train: True
2025-03-20 18:42:34,340:INFO:   <<< epochs: 5
2025-03-20 18:42:34,340:INFO:   <<< eval_frame_order: 0
2025-03-20 18:42:34,340:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:42:34,340:INFO:   <<< feature_framerate: 1
2025-03-20 18:42:34,340:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:42:34,340:INFO:   <<< fp16: True
2025-03-20 18:42:34,340:INFO: Effective parameters:
2025-03-20 18:42:34,341:INFO:   <<< fp16_opt_level: O3
2025-03-20 18:42:34,341:INFO:   <<< batch_size: 16
2025-03-20 18:42:34,341:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:42:34,341:INFO:   <<< batch_size_val: 64
2025-03-20 18:42:34,341:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:42:34,341:INFO:   <<< cache_dir: 
2025-03-20 18:42:34,341:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:42:34,341:INFO:   <<< coef_lr: 0.001
2025-03-20 18:42:34,341:INFO:   <<< init_model: None
2025-03-20 18:42:34,341:INFO:   <<< linear_patch: 2d
2025-03-20 18:42:34,341:INFO:   <<< cross_model: cross-base
2025-03-20 18:42:34,341:INFO:   <<< local_rank: 0
2025-03-20 18:42:34,341:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:42:34,341:INFO:   <<< loose_type: True
2025-03-20 18:42:34,341:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:42:34,341:INFO:   <<< datatype: vatex
2025-03-20 18:42:34,341:INFO:   <<< lr: 0.0001
2025-03-20 18:42:34,341:INFO:   <<< do_eval: False
2025-03-20 18:42:34,341:INFO:   <<< lr_decay: 0.9
2025-03-20 18:42:34,341:INFO:   <<< do_lower_case: False
2025-03-20 18:42:34,341:INFO:   <<< margin: 0.1
2025-03-20 18:42:34,341:INFO:   <<< do_pretrain: False
2025-03-20 18:42:34,341:INFO:   <<< do_train: True
2025-03-20 18:42:34,341:INFO:   <<< max_frames: 12
2025-03-20 18:42:34,341:INFO:   <<< max_words: 32
2025-03-20 18:42:34,341:INFO:   <<< epochs: 5
2025-03-20 18:42:34,341:INFO:   <<< eval_frame_order: 0
2025-03-20 18:42:34,341:INFO:   <<< n_display: 50
2025-03-20 18:42:34,341:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:42:34,341:INFO:   <<< n_gpu: 2
2025-03-20 18:42:34,341:INFO:   <<< n_pair: 1
2025-03-20 18:42:34,341:INFO:   <<< feature_framerate: 1
2025-03-20 18:42:34,341:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:42:34,341:INFO:   <<< negative_weighting: 1
2025-03-20 18:42:34,341:INFO:   <<< fp16: True
2025-03-20 18:42:34,341:INFO:   <<< num_thread_reader: 2
2025-03-20 18:42:34,341:INFO:   <<< fp16_opt_level: O3
2025-03-20 18:42:34,342:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:42:34,342:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:42:34,342:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:42:34,342:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:42:34,342:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:42:34,342:INFO:   <<< rank: 0
2025-03-20 18:42:34,342:INFO:   <<< init_model: None
2025-03-20 18:42:34,342:INFO:   <<< resume_model: None
2025-03-20 18:42:34,342:INFO:   <<< sampled_use_mil: False
2025-03-20 18:42:34,342:INFO:   <<< linear_patch: 2d
2025-03-20 18:42:34,342:INFO:   <<< local_rank: 0
2025-03-20 18:42:34,342:INFO:   <<< seed: 42
2025-03-20 18:42:34,342:INFO:   <<< loose_type: True
2025-03-20 18:42:34,342:INFO:   <<< sim_header: seqTransf
2025-03-20 18:42:34,342:INFO:   <<< lr: 0.0001
2025-03-20 18:42:34,342:INFO:   <<< slice_framepos: 2
2025-03-20 18:42:34,342:INFO:   <<< lr_decay: 0.9
2025-03-20 18:42:34,342:INFO:   <<< margin: 0.1
2025-03-20 18:42:34,342:INFO:   <<< task_type: retrieval
2025-03-20 18:42:34,342:INFO:   <<< max_frames: 12
2025-03-20 18:42:34,342:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:42:34,342:INFO:   <<< max_words: 32
2025-03-20 18:42:34,342:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:42:34,342:INFO:   <<< train_frame_order: 0
2025-03-20 18:42:34,342:INFO:   <<< n_display: 50
2025-03-20 18:42:34,342:INFO:   <<< n_gpu: 2
2025-03-20 18:42:34,342:INFO:   <<< use_mil: False
2025-03-20 18:42:34,342:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:42:34,342:INFO:   <<< n_pair: 1
2025-03-20 18:42:34,342:INFO:   <<< video_dim: 1024
2025-03-20 18:42:34,342:INFO:   <<< negative_weighting: 1
2025-03-20 18:42:34,342:INFO:   <<< num_thread_reader: 2
2025-03-20 18:42:34,342:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:42:34,342:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:42:34,342:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:42:34,342:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:42:34,342:INFO:   <<< rank: 1
2025-03-20 18:42:34,342:INFO:   <<< world_size: 2
2025-03-20 18:42:34,342:INFO:   <<< resume_model: None
2025-03-20 18:42:34,343:INFO:   <<< sampled_use_mil: False
2025-03-20 18:42:34,343:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:42:34,343:INFO:   <<< seed: 42
2025-03-20 18:42:34,343:INFO:   <<< sim_header: seqTransf
2025-03-20 18:42:34,343:INFO:   <<< slice_framepos: 2
2025-03-20 18:42:34,343:INFO:   <<< task_type: retrieval
2025-03-20 18:42:34,343:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:42:34,343:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:42:34,343:INFO:   <<< train_frame_order: 0
2025-03-20 18:42:34,343:INFO:   <<< use_mil: False
2025-03-20 18:42:34,343:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:42:34,343:INFO:   <<< video_dim: 1024
2025-03-20 18:42:34,343:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:42:34,343:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:42:34,343:INFO:   <<< world_size: 2
2025-03-20 18:42:34,343:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:42:37,178:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:42:37,180:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:42:37,180:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:42:37,180:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:42:37,181:WARNING: Test retrieval by loose type.
2025-03-20 18:42:37,181:WARNING: 	 embed_dim: 512
2025-03-20 18:42:37,181:WARNING: 	 image_resolution: 224
2025-03-20 18:42:37,182:WARNING: 	 vision_layers: 12
2025-03-20 18:42:37,182:WARNING: 	 vision_width: 768
2025-03-20 18:42:37,182:WARNING: 	 vision_patch_size: 16
2025-03-20 18:42:37,182:WARNING: 	 context_length: 77
2025-03-20 18:42:37,182:WARNING: 	 vocab_size: 49408
2025-03-20 18:42:37,182:WARNING: 	 transformer_width: 512
2025-03-20 18:42:37,182:WARNING: 	 transformer_heads: 8
2025-03-20 18:42:37,182:WARNING: 	 transformer_layers: 12
2025-03-20 18:42:37,182:WARNING: 		 linear_patch: 2d
2025-03-20 18:42:37,183:WARNING: 	 cut_top_layer: 0
2025-03-20 18:42:37,185:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:42:37,186:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:42:37,186:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:42:37,186:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:42:37,186:WARNING: Test retrieval by loose type.
2025-03-20 18:42:37,187:WARNING: 	 embed_dim: 512
2025-03-20 18:42:37,187:WARNING: 	 image_resolution: 224
2025-03-20 18:42:37,187:WARNING: 	 vision_layers: 12
2025-03-20 18:42:37,187:WARNING: 	 vision_width: 768
2025-03-20 18:42:37,187:WARNING: 	 vision_patch_size: 16
2025-03-20 18:42:37,187:WARNING: 	 context_length: 77
2025-03-20 18:42:37,187:WARNING: 	 vocab_size: 49408
2025-03-20 18:42:37,187:WARNING: 	 transformer_width: 512
2025-03-20 18:42:37,187:WARNING: 	 transformer_heads: 8
2025-03-20 18:42:37,187:WARNING: 	 transformer_layers: 12
2025-03-20 18:42:37,187:WARNING: 		 linear_patch: 2d
2025-03-20 18:42:37,188:WARNING: 	 cut_top_layer: 0
2025-03-20 18:42:39,360:WARNING: 	 sim_header: seqTransf
2025-03-20 18:42:39,371:WARNING: 	 sim_header: seqTransf
2025-03-20 18:42:52,127:INFO: --------------------
2025-03-20 18:42:52,128:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:42:52,128:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:42:52,155:INFO: --------------------
2025-03-20 18:42:52,156:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:42:52,156:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:43:01,833:INFO: ***** Running test *****
2025-03-20 18:43:01,833:INFO:   Num examples = 60000
2025-03-20 18:43:01,833:INFO:   Batch size = 64
2025-03-20 18:43:01,833:INFO:   Num steps = 938
2025-03-20 18:43:01,834:INFO: ***** Running val *****
2025-03-20 18:43:01,834:INFO:   Num examples = 30000
2025-03-20 18:43:01,838:INFO: ***** Running test *****
2025-03-20 18:43:01,839:INFO:   Num examples = 60000
2025-03-20 18:43:01,839:INFO:   Batch size = 64
2025-03-20 18:43:01,839:INFO:   Num steps = 938
2025-03-20 18:43:01,839:INFO: ***** Running val *****
2025-03-20 18:43:01,839:INFO:   Num examples = 30000
2025-03-20 18:49:44,417:INFO: Effective parameters:
2025-03-20 18:49:44,417:INFO:   <<< batch_size: 16
2025-03-20 18:49:44,417:INFO:   <<< batch_size_val: 64
2025-03-20 18:49:44,418:INFO:   <<< cache_dir: 
2025-03-20 18:49:44,418:INFO:   <<< coef_lr: 0.001
2025-03-20 18:49:44,418:INFO:   <<< cross_model: cross-base
2025-03-20 18:49:44,418:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:49:44,418:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:49:44,418:INFO:   <<< datatype: vatex
2025-03-20 18:49:44,418:INFO:   <<< do_eval: False
2025-03-20 18:49:44,418:INFO:   <<< do_lower_case: False
2025-03-20 18:49:44,418:INFO:   <<< do_pretrain: False
2025-03-20 18:49:44,418:INFO:   <<< do_train: True
2025-03-20 18:49:44,418:INFO:   <<< epochs: 5
2025-03-20 18:49:44,418:INFO:   <<< eval_frame_order: 0
2025-03-20 18:49:44,418:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:49:44,418:INFO:   <<< feature_framerate: 1
2025-03-20 18:49:44,418:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:49:44,419:INFO:   <<< fp16: True
2025-03-20 18:49:44,419:INFO:   <<< fp16_opt_level: O3
2025-03-20 18:49:44,419:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:49:44,419:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:49:44,419:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:49:44,419:INFO:   <<< init_model: None
2025-03-20 18:49:44,419:INFO:   <<< linear_patch: 2d
2025-03-20 18:49:44,419:INFO:   <<< local_rank: 0
2025-03-20 18:49:44,419:INFO:   <<< loose_type: True
2025-03-20 18:49:44,419:INFO:   <<< lr: 0.0001
2025-03-20 18:49:44,419:INFO:   <<< lr_decay: 0.9
2025-03-20 18:49:44,419:INFO:   <<< margin: 0.1
2025-03-20 18:49:44,419:INFO:   <<< max_frames: 12
2025-03-20 18:49:44,419:INFO:   <<< max_words: 32
2025-03-20 18:49:44,419:INFO:   <<< n_display: 50
2025-03-20 18:49:44,420:INFO:   <<< n_gpu: 2
2025-03-20 18:49:44,420:INFO:   <<< n_pair: 1
2025-03-20 18:49:44,420:INFO:   <<< negative_weighting: 1
2025-03-20 18:49:44,420:INFO:   <<< num_thread_reader: 2
2025-03-20 18:49:44,420:INFO: Effective parameters:
2025-03-20 18:49:44,420:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:49:44,420:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:49:44,420:INFO:   <<< batch_size: 16
2025-03-20 18:49:44,420:INFO:   <<< rank: 0
2025-03-20 18:49:44,420:INFO:   <<< resume_model: None
2025-03-20 18:49:44,420:INFO:   <<< batch_size_val: 64
2025-03-20 18:49:44,420:INFO:   <<< sampled_use_mil: False
2025-03-20 18:49:44,420:INFO:   <<< seed: 42
2025-03-20 18:49:44,420:INFO:   <<< cache_dir: 
2025-03-20 18:49:44,420:INFO:   <<< sim_header: seqTransf
2025-03-20 18:49:44,420:INFO:   <<< slice_framepos: 2
2025-03-20 18:49:44,420:INFO:   <<< coef_lr: 0.001
2025-03-20 18:49:44,420:INFO:   <<< task_type: retrieval
2025-03-20 18:49:44,420:INFO:   <<< cross_model: cross-base
2025-03-20 18:49:44,420:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:49:44,420:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 18:49:44,420:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:49:44,420:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 18:49:44,420:INFO:   <<< train_frame_order: 0
2025-03-20 18:49:44,421:INFO:   <<< datatype: vatex
2025-03-20 18:49:44,421:INFO:   <<< use_mil: False
2025-03-20 18:49:44,421:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:49:44,421:INFO:   <<< do_eval: False
2025-03-20 18:49:44,421:INFO:   <<< video_dim: 1024
2025-03-20 18:49:44,421:INFO:   <<< do_lower_case: False
2025-03-20 18:49:44,421:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:49:44,421:INFO:   <<< do_pretrain: False
2025-03-20 18:49:44,421:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:49:44,421:INFO:   <<< do_train: True
2025-03-20 18:49:44,421:INFO:   <<< world_size: 2
2025-03-20 18:49:44,421:INFO:   <<< epochs: 5
2025-03-20 18:49:44,421:INFO:   <<< eval_frame_order: 0
2025-03-20 18:49:44,421:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:49:44,421:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 18:49:44,421:INFO:   <<< feature_framerate: 1
2025-03-20 18:49:44,421:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 18:49:44,421:INFO:   <<< fp16: True
2025-03-20 18:49:44,421:INFO:   <<< fp16_opt_level: O3
2025-03-20 18:49:44,421:INFO:   <<< freeze_layer_num: 0
2025-03-20 18:49:44,421:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 18:49:44,421:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 18:49:44,421:INFO:   <<< init_model: None
2025-03-20 18:49:44,421:INFO:   <<< linear_patch: 2d
2025-03-20 18:49:44,421:INFO:   <<< local_rank: 0
2025-03-20 18:49:44,421:INFO:   <<< loose_type: True
2025-03-20 18:49:44,422:INFO:   <<< lr: 0.0001
2025-03-20 18:49:44,422:INFO:   <<< lr_decay: 0.9
2025-03-20 18:49:44,422:INFO:   <<< margin: 0.1
2025-03-20 18:49:44,422:INFO:   <<< max_frames: 12
2025-03-20 18:49:44,422:INFO:   <<< max_words: 32
2025-03-20 18:49:44,422:INFO:   <<< n_display: 50
2025-03-20 18:49:44,422:INFO:   <<< n_gpu: 2
2025-03-20 18:49:44,422:INFO:   <<< n_pair: 1
2025-03-20 18:49:44,422:INFO:   <<< negative_weighting: 1
2025-03-20 18:49:44,422:INFO:   <<< num_thread_reader: 2
2025-03-20 18:49:44,422:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 18:49:44,422:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 18:49:44,422:INFO:   <<< rank: 1
2025-03-20 18:49:44,422:INFO:   <<< resume_model: None
2025-03-20 18:49:44,422:INFO:   <<< sampled_use_mil: False
2025-03-20 18:49:44,422:INFO:   <<< seed: 42
2025-03-20 18:49:44,422:INFO:   <<< sim_header: seqTransf
2025-03-20 18:49:44,422:INFO:   <<< slice_framepos: 2
2025-03-20 18:49:44,422:INFO:   <<< task_type: retrieval
2025-03-20 18:49:44,422:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 18:49:44,423:INFO:   <<< train_csv: data/.train.csv
2025-03-20 18:49:44,423:INFO:   <<< train_frame_order: 0
2025-03-20 18:49:44,423:INFO:   <<< use_mil: False
2025-03-20 18:49:44,423:INFO:   <<< val_csv: data/.val.csv
2025-03-20 18:49:44,423:INFO:   <<< video_dim: 1024
2025-03-20 18:49:44,423:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 18:49:44,423:INFO:   <<< warmup_proportion: 0.1
2025-03-20 18:49:44,423:INFO:   <<< world_size: 2
2025-03-20 18:49:44,423:INFO: device: cuda:0 n_gpu: 2
2025-03-20 18:49:47,273:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:49:47,275:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:49:47,275:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:49:47,275:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:49:47,276:WARNING: Test retrieval by loose type.
2025-03-20 18:49:47,276:WARNING: 	 embed_dim: 512
2025-03-20 18:49:47,276:WARNING: 	 image_resolution: 224
2025-03-20 18:49:47,277:WARNING: 	 vision_layers: 12
2025-03-20 18:49:47,277:WARNING: 	 vision_width: 768
2025-03-20 18:49:47,277:WARNING: 	 vision_patch_size: 16
2025-03-20 18:49:47,277:WARNING: 	 context_length: 77
2025-03-20 18:49:47,277:WARNING: 	 vocab_size: 49408
2025-03-20 18:49:47,277:WARNING: 	 transformer_width: 512
2025-03-20 18:49:47,277:WARNING: 	 transformer_heads: 8
2025-03-20 18:49:47,277:WARNING: 	 transformer_layers: 12
2025-03-20 18:49:47,277:WARNING: 		 linear_patch: 2d
2025-03-20 18:49:47,277:WARNING: 	 cut_top_layer: 0
2025-03-20 18:49:47,286:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 18:49:47,287:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 18:49:47,287:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 18:49:47,287:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 18:49:47,288:WARNING: Test retrieval by loose type.
2025-03-20 18:49:47,288:WARNING: 	 embed_dim: 512
2025-03-20 18:49:47,288:WARNING: 	 image_resolution: 224
2025-03-20 18:49:47,288:WARNING: 	 vision_layers: 12
2025-03-20 18:49:47,288:WARNING: 	 vision_width: 768
2025-03-20 18:49:47,289:WARNING: 	 vision_patch_size: 16
2025-03-20 18:49:47,289:WARNING: 	 context_length: 77
2025-03-20 18:49:47,289:WARNING: 	 vocab_size: 49408
2025-03-20 18:49:47,289:WARNING: 	 transformer_width: 512
2025-03-20 18:49:47,289:WARNING: 	 transformer_heads: 8
2025-03-20 18:49:47,289:WARNING: 	 transformer_layers: 12
2025-03-20 18:49:47,289:WARNING: 		 linear_patch: 2d
2025-03-20 18:49:47,289:WARNING: 	 cut_top_layer: 0
2025-03-20 18:49:49,496:WARNING: 	 sim_header: seqTransf
2025-03-20 18:49:49,510:WARNING: 	 sim_header: seqTransf
2025-03-20 18:50:02,287:INFO: --------------------
2025-03-20 18:50:02,288:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:50:02,288:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:50:02,316:INFO: --------------------
2025-03-20 18:50:02,317:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 18:50:02,317:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 18:50:11,886:INFO: ***** Running test *****
2025-03-20 18:50:11,887:INFO:   Num examples = 60000
2025-03-20 18:50:11,887:INFO:   Batch size = 64
2025-03-20 18:50:11,887:INFO:   Num steps = 938
2025-03-20 18:50:11,887:INFO: ***** Running val *****
2025-03-20 18:50:11,887:INFO:   Num examples = 30000
2025-03-20 18:50:11,891:INFO: ***** Running test *****
2025-03-20 18:50:11,891:INFO:   Num examples = 60000
2025-03-20 18:50:11,891:INFO:   Batch size = 64
2025-03-20 18:50:11,891:INFO:   Num steps = 938
2025-03-20 18:50:11,891:INFO: ***** Running val *****
2025-03-20 18:50:11,891:INFO:   Num examples = 30000
2025-03-20 19:09:50,987:INFO: Effective parameters:
2025-03-20 19:09:50,988:INFO:   <<< batch_size: 16
2025-03-20 19:09:50,988:INFO:   <<< batch_size_val: 64
2025-03-20 19:09:50,988:INFO:   <<< cache_dir: 
2025-03-20 19:09:50,988:INFO:   <<< coef_lr: 0.001
2025-03-20 19:09:50,988:INFO:   <<< cross_model: cross-base
2025-03-20 19:09:50,988:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:09:50,988:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:09:50,988:INFO:   <<< datatype: vatex
2025-03-20 19:09:50,988:INFO:   <<< do_eval: False
2025-03-20 19:09:50,988:INFO:   <<< do_lower_case: False
2025-03-20 19:09:50,988:INFO:   <<< do_pretrain: False
2025-03-20 19:09:50,988:INFO:   <<< do_train: True
2025-03-20 19:09:50,988:INFO:   <<< epochs: 5
2025-03-20 19:09:50,988:INFO:   <<< eval_frame_order: 0
2025-03-20 19:09:50,988:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:09:50,988:INFO:   <<< feature_framerate: 1
2025-03-20 19:09:50,988:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:09:50,988:INFO:   <<< fp16: True
2025-03-20 19:09:50,989:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:09:50,989:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:09:50,989:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:09:50,989:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:09:50,989:INFO:   <<< init_model: None
2025-03-20 19:09:50,989:INFO:   <<< linear_patch: 2d
2025-03-20 19:09:50,989:INFO:   <<< local_rank: 0
2025-03-20 19:09:50,989:INFO:   <<< loose_type: True
2025-03-20 19:09:50,989:INFO:   <<< lr: 0.0001
2025-03-20 19:09:50,989:INFO:   <<< lr_decay: 0.9
2025-03-20 19:09:50,989:INFO:   <<< margin: 0.1
2025-03-20 19:09:50,989:INFO:   <<< max_frames: 12
2025-03-20 19:09:50,989:INFO:   <<< max_words: 32
2025-03-20 19:09:50,989:INFO:   <<< n_display: 50
2025-03-20 19:09:50,989:INFO:   <<< n_gpu: 2
2025-03-20 19:09:50,989:INFO:   <<< n_pair: 1
2025-03-20 19:09:50,989:INFO:   <<< negative_weighting: 1
2025-03-20 19:09:50,990:INFO:   <<< num_thread_reader: 2
2025-03-20 19:09:50,990:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:09:50,990:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:09:50,990:INFO: Effective parameters:
2025-03-20 19:09:50,990:INFO:   <<< rank: 0
2025-03-20 19:09:50,990:INFO:   <<< batch_size: 16
2025-03-20 19:09:50,990:INFO:   <<< resume_model: None
2025-03-20 19:09:50,990:INFO:   <<< sampled_use_mil: False
2025-03-20 19:09:50,990:INFO:   <<< batch_size_val: 64
2025-03-20 19:09:50,990:INFO:   <<< seed: 42
2025-03-20 19:09:50,990:INFO:   <<< cache_dir: 
2025-03-20 19:09:50,990:INFO:   <<< sim_header: seqTransf
2025-03-20 19:09:50,990:INFO:   <<< coef_lr: 0.001
2025-03-20 19:09:50,990:INFO:   <<< slice_framepos: 2
2025-03-20 19:09:50,990:INFO:   <<< cross_model: cross-base
2025-03-20 19:09:50,990:INFO:   <<< task_type: retrieval
2025-03-20 19:09:50,990:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:09:50,990:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:09:50,990:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:09:50,990:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:09:50,990:INFO:   <<< train_frame_order: 0
2025-03-20 19:09:50,990:INFO:   <<< datatype: vatex
2025-03-20 19:09:50,990:INFO:   <<< use_mil: False
2025-03-20 19:09:50,990:INFO:   <<< do_eval: False
2025-03-20 19:09:50,990:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:09:50,990:INFO:   <<< do_lower_case: False
2025-03-20 19:09:50,990:INFO:   <<< video_dim: 1024
2025-03-20 19:09:50,990:INFO:   <<< do_pretrain: False
2025-03-20 19:09:50,990:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:09:50,990:INFO:   <<< do_train: True
2025-03-20 19:09:50,990:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:09:50,990:INFO:   <<< epochs: 5
2025-03-20 19:09:50,990:INFO:   <<< world_size: 2
2025-03-20 19:09:50,991:INFO:   <<< eval_frame_order: 0
2025-03-20 19:09:50,991:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:09:50,991:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:09:50,991:INFO:   <<< feature_framerate: 1
2025-03-20 19:09:50,991:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:09:50,991:INFO:   <<< fp16: True
2025-03-20 19:09:50,991:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:09:50,991:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:09:50,991:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:09:50,991:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:09:50,991:INFO:   <<< init_model: None
2025-03-20 19:09:50,991:INFO:   <<< linear_patch: 2d
2025-03-20 19:09:50,991:INFO:   <<< local_rank: 0
2025-03-20 19:09:50,991:INFO:   <<< loose_type: True
2025-03-20 19:09:50,991:INFO:   <<< lr: 0.0001
2025-03-20 19:09:50,991:INFO:   <<< lr_decay: 0.9
2025-03-20 19:09:50,991:INFO:   <<< margin: 0.1
2025-03-20 19:09:50,991:INFO:   <<< max_frames: 12
2025-03-20 19:09:50,991:INFO:   <<< max_words: 32
2025-03-20 19:09:50,991:INFO:   <<< n_display: 50
2025-03-20 19:09:50,991:INFO:   <<< n_gpu: 2
2025-03-20 19:09:50,991:INFO:   <<< n_pair: 1
2025-03-20 19:09:50,991:INFO:   <<< negative_weighting: 1
2025-03-20 19:09:50,991:INFO:   <<< num_thread_reader: 2
2025-03-20 19:09:50,991:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:09:50,991:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:09:50,992:INFO:   <<< rank: 1
2025-03-20 19:09:50,992:INFO:   <<< resume_model: None
2025-03-20 19:09:50,992:INFO:   <<< sampled_use_mil: False
2025-03-20 19:09:50,992:INFO:   <<< seed: 42
2025-03-20 19:09:50,992:INFO:   <<< sim_header: seqTransf
2025-03-20 19:09:50,992:INFO:   <<< slice_framepos: 2
2025-03-20 19:09:50,992:INFO:   <<< task_type: retrieval
2025-03-20 19:09:50,992:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:09:50,992:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:09:50,992:INFO:   <<< train_frame_order: 0
2025-03-20 19:09:50,992:INFO:   <<< use_mil: False
2025-03-20 19:09:50,992:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:09:50,992:INFO:   <<< video_dim: 1024
2025-03-20 19:09:50,992:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:09:50,992:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:09:50,992:INFO:   <<< world_size: 2
2025-03-20 19:09:50,992:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:09:53,807:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:09:53,809:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:09:53,809:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:09:53,809:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:09:53,809:WARNING: Test retrieval by loose type.
2025-03-20 19:09:53,810:WARNING: 	 embed_dim: 512
2025-03-20 19:09:53,810:WARNING: 	 image_resolution: 224
2025-03-20 19:09:53,810:WARNING: 	 vision_layers: 12
2025-03-20 19:09:53,811:WARNING: 	 vision_width: 768
2025-03-20 19:09:53,811:WARNING: 	 vision_patch_size: 16
2025-03-20 19:09:53,811:WARNING: 	 context_length: 77
2025-03-20 19:09:53,811:WARNING: 	 vocab_size: 49408
2025-03-20 19:09:53,811:WARNING: 	 transformer_width: 512
2025-03-20 19:09:53,811:WARNING: 	 transformer_heads: 8
2025-03-20 19:09:53,811:WARNING: 	 transformer_layers: 12
2025-03-20 19:09:53,811:WARNING: 		 linear_patch: 2d
2025-03-20 19:09:53,811:WARNING: 	 cut_top_layer: 0
2025-03-20 19:09:53,822:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:09:53,823:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:09:53,823:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:09:53,823:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:09:53,823:WARNING: Test retrieval by loose type.
2025-03-20 19:09:53,824:WARNING: 	 embed_dim: 512
2025-03-20 19:09:53,824:WARNING: 	 image_resolution: 224
2025-03-20 19:09:53,824:WARNING: 	 vision_layers: 12
2025-03-20 19:09:53,824:WARNING: 	 vision_width: 768
2025-03-20 19:09:53,824:WARNING: 	 vision_patch_size: 16
2025-03-20 19:09:53,824:WARNING: 	 context_length: 77
2025-03-20 19:09:53,824:WARNING: 	 vocab_size: 49408
2025-03-20 19:09:53,824:WARNING: 	 transformer_width: 512
2025-03-20 19:09:53,824:WARNING: 	 transformer_heads: 8
2025-03-20 19:09:53,824:WARNING: 	 transformer_layers: 12
2025-03-20 19:09:53,824:WARNING: 		 linear_patch: 2d
2025-03-20 19:09:53,825:WARNING: 	 cut_top_layer: 0
2025-03-20 19:09:56,006:WARNING: 	 sim_header: seqTransf
2025-03-20 19:09:56,023:WARNING: 	 sim_header: seqTransf
2025-03-20 19:10:08,812:INFO: --------------------
2025-03-20 19:10:08,813:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:10:08,814:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:10:08,849:INFO: --------------------
2025-03-20 19:10:08,850:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:10:08,850:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:10:18,505:INFO: ***** Running test *****
2025-03-20 19:10:18,505:INFO:   Num examples = 60000
2025-03-20 19:10:18,505:INFO:   Batch size = 64
2025-03-20 19:10:18,505:INFO:   Num steps = 938
2025-03-20 19:10:18,505:INFO: ***** Running val *****
2025-03-20 19:10:18,506:INFO:   Num examples = 30000
2025-03-20 19:10:18,506:INFO: ***** Running test *****
2025-03-20 19:10:18,506:INFO:   Num examples = 60000
2025-03-20 19:10:18,506:INFO:   Batch size = 64
2025-03-20 19:10:18,506:INFO:   Num steps = 938
2025-03-20 19:10:18,506:INFO: ***** Running val *****
2025-03-20 19:10:18,506:INFO:   Num examples = 30000
2025-03-20 19:15:21,982:INFO: Effective parameters:
2025-03-20 19:15:21,982:INFO:   <<< batch_size: 16
2025-03-20 19:15:21,982:INFO:   <<< batch_size_val: 64
2025-03-20 19:15:21,982:INFO:   <<< cache_dir: 
2025-03-20 19:15:21,982:INFO:   <<< coef_lr: 0.001
2025-03-20 19:15:21,982:INFO:   <<< cross_model: cross-base
2025-03-20 19:15:21,982:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:15:21,982:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:15:21,982:INFO:   <<< datatype: vatex
2025-03-20 19:15:21,982:INFO:   <<< do_eval: False
2025-03-20 19:15:21,982:INFO:   <<< do_lower_case: False
2025-03-20 19:15:21,982:INFO:   <<< do_pretrain: False
2025-03-20 19:15:21,982:INFO:   <<< do_train: True
2025-03-20 19:15:21,982:INFO:   <<< epochs: 5
2025-03-20 19:15:21,983:INFO:   <<< eval_frame_order: 0
2025-03-20 19:15:21,983:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:15:21,983:INFO:   <<< feature_framerate: 1
2025-03-20 19:15:21,983:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:15:21,983:INFO:   <<< fp16: True
2025-03-20 19:15:21,984:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:15:21,984:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:15:21,984:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:15:21,984:INFO: Effective parameters:
2025-03-20 19:15:21,984:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:15:21,984:INFO:   <<< batch_size: 16
2025-03-20 19:15:21,984:INFO:   <<< init_model: None
2025-03-20 19:15:21,984:INFO:   <<< batch_size_val: 64
2025-03-20 19:15:21,984:INFO:   <<< cache_dir: 
2025-03-20 19:15:21,984:INFO:   <<< linear_patch: 2d
2025-03-20 19:15:21,984:INFO:   <<< local_rank: 0
2025-03-20 19:15:21,984:INFO:   <<< coef_lr: 0.001
2025-03-20 19:15:21,984:INFO:   <<< loose_type: True
2025-03-20 19:15:21,984:INFO:   <<< cross_model: cross-base
2025-03-20 19:15:21,984:INFO:   <<< lr: 0.0001
2025-03-20 19:15:21,984:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:15:21,984:INFO:   <<< lr_decay: 0.9
2025-03-20 19:15:21,984:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:15:21,984:INFO:   <<< margin: 0.1
2025-03-20 19:15:21,984:INFO:   <<< datatype: vatex
2025-03-20 19:15:21,984:INFO:   <<< do_eval: False
2025-03-20 19:15:21,984:INFO:   <<< max_frames: 12
2025-03-20 19:15:21,984:INFO:   <<< do_lower_case: False
2025-03-20 19:15:21,984:INFO:   <<< max_words: 32
2025-03-20 19:15:21,984:INFO:   <<< do_pretrain: False
2025-03-20 19:15:21,984:INFO:   <<< n_display: 50
2025-03-20 19:15:21,984:INFO:   <<< do_train: True
2025-03-20 19:15:21,984:INFO:   <<< n_gpu: 2
2025-03-20 19:15:21,984:INFO:   <<< epochs: 5
2025-03-20 19:15:21,984:INFO:   <<< n_pair: 1
2025-03-20 19:15:21,985:INFO:   <<< eval_frame_order: 0
2025-03-20 19:15:21,985:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:15:21,985:INFO:   <<< negative_weighting: 1
2025-03-20 19:15:21,985:INFO:   <<< feature_framerate: 1
2025-03-20 19:15:21,985:INFO:   <<< num_thread_reader: 2
2025-03-20 19:15:21,985:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:15:21,985:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:15:21,985:INFO:   <<< fp16: True
2025-03-20 19:15:21,985:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:15:21,985:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:15:21,985:INFO:   <<< rank: 1
2025-03-20 19:15:21,985:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:15:21,985:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:15:21,985:INFO:   <<< resume_model: None
2025-03-20 19:15:21,985:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:15:21,985:INFO:   <<< sampled_use_mil: False
2025-03-20 19:15:21,985:INFO:   <<< init_model: None
2025-03-20 19:15:21,985:INFO:   <<< seed: 42
2025-03-20 19:15:21,985:INFO:   <<< linear_patch: 2d
2025-03-20 19:15:21,985:INFO:   <<< sim_header: seqTransf
2025-03-20 19:15:21,985:INFO:   <<< local_rank: 0
2025-03-20 19:15:21,985:INFO:   <<< slice_framepos: 2
2025-03-20 19:15:21,985:INFO:   <<< loose_type: True
2025-03-20 19:15:21,985:INFO:   <<< lr: 0.0001
2025-03-20 19:15:21,985:INFO:   <<< task_type: retrieval
2025-03-20 19:15:21,985:INFO:   <<< lr_decay: 0.9
2025-03-20 19:15:21,985:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:15:21,985:INFO:   <<< margin: 0.1
2025-03-20 19:15:21,985:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:15:21,985:INFO:   <<< max_frames: 12
2025-03-20 19:15:21,985:INFO:   <<< train_frame_order: 0
2025-03-20 19:15:21,985:INFO:   <<< max_words: 32
2025-03-20 19:15:21,985:INFO:   <<< use_mil: False
2025-03-20 19:15:21,985:INFO:   <<< n_display: 50
2025-03-20 19:15:21,985:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:15:21,985:INFO:   <<< n_gpu: 2
2025-03-20 19:15:21,985:INFO:   <<< video_dim: 1024
2025-03-20 19:15:21,985:INFO:   <<< n_pair: 1
2025-03-20 19:15:21,986:INFO:   <<< negative_weighting: 1
2025-03-20 19:15:21,986:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:15:21,986:INFO:   <<< num_thread_reader: 2
2025-03-20 19:15:21,986:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:15:21,986:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:15:21,986:INFO:   <<< world_size: 2
2025-03-20 19:15:21,986:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:15:21,986:INFO:   <<< rank: 0
2025-03-20 19:15:21,986:INFO:   <<< resume_model: None
2025-03-20 19:15:21,986:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:15:21,986:INFO:   <<< sampled_use_mil: False
2025-03-20 19:15:21,986:INFO:   <<< seed: 42
2025-03-20 19:15:21,986:INFO:   <<< sim_header: seqTransf
2025-03-20 19:15:21,986:INFO:   <<< slice_framepos: 2
2025-03-20 19:15:21,986:INFO:   <<< task_type: retrieval
2025-03-20 19:15:21,986:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:15:21,986:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:15:21,986:INFO:   <<< train_frame_order: 0
2025-03-20 19:15:21,986:INFO:   <<< use_mil: False
2025-03-20 19:15:21,986:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:15:21,986:INFO:   <<< video_dim: 1024
2025-03-20 19:15:21,986:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:15:21,986:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:15:21,986:INFO:   <<< world_size: 2
2025-03-20 19:15:21,986:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:15:24,850:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:15:24,852:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:15:24,853:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:15:24,853:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:15:24,853:WARNING: Test retrieval by loose type.
2025-03-20 19:15:24,854:WARNING: 	 embed_dim: 512
2025-03-20 19:15:24,854:WARNING: 	 image_resolution: 224
2025-03-20 19:15:24,854:WARNING: 	 vision_layers: 12
2025-03-20 19:15:24,854:WARNING: 	 vision_width: 768
2025-03-20 19:15:24,854:WARNING: 	 vision_patch_size: 16
2025-03-20 19:15:24,855:WARNING: 	 context_length: 77
2025-03-20 19:15:24,855:WARNING: 	 vocab_size: 49408
2025-03-20 19:15:24,855:WARNING: 	 transformer_width: 512
2025-03-20 19:15:24,855:WARNING: 	 transformer_heads: 8
2025-03-20 19:15:24,855:WARNING: 	 transformer_layers: 12
2025-03-20 19:15:24,855:WARNING: 		 linear_patch: 2d
2025-03-20 19:15:24,855:WARNING: 	 cut_top_layer: 0
2025-03-20 19:15:24,864:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:15:24,865:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:15:24,866:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:15:24,866:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:15:24,866:WARNING: Test retrieval by loose type.
2025-03-20 19:15:24,867:WARNING: 	 embed_dim: 512
2025-03-20 19:15:24,867:WARNING: 	 image_resolution: 224
2025-03-20 19:15:24,867:WARNING: 	 vision_layers: 12
2025-03-20 19:15:24,867:WARNING: 	 vision_width: 768
2025-03-20 19:15:24,867:WARNING: 	 vision_patch_size: 16
2025-03-20 19:15:24,867:WARNING: 	 context_length: 77
2025-03-20 19:15:24,867:WARNING: 	 vocab_size: 49408
2025-03-20 19:15:24,867:WARNING: 	 transformer_width: 512
2025-03-20 19:15:24,867:WARNING: 	 transformer_heads: 8
2025-03-20 19:15:24,867:WARNING: 	 transformer_layers: 12
2025-03-20 19:15:24,867:WARNING: 		 linear_patch: 2d
2025-03-20 19:15:24,867:WARNING: 	 cut_top_layer: 0
2025-03-20 19:15:27,027:WARNING: 	 sim_header: seqTransf
2025-03-20 19:15:27,040:WARNING: 	 sim_header: seqTransf
2025-03-20 19:15:39,807:INFO: --------------------
2025-03-20 19:15:39,808:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:15:39,808:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:15:39,839:INFO: --------------------
2025-03-20 19:15:39,839:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:15:39,839:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:15:49,427:INFO: ***** Running test *****
2025-03-20 19:15:49,427:INFO:   Num examples = 60000
2025-03-20 19:15:49,427:INFO:   Batch size = 64
2025-03-20 19:15:49,427:INFO:   Num steps = 938
2025-03-20 19:15:49,427:INFO: ***** Running val *****
2025-03-20 19:15:49,427:INFO:   Num examples = 30000
2025-03-20 19:15:49,459:INFO: ***** Running test *****
2025-03-20 19:15:49,460:INFO:   Num examples = 60000
2025-03-20 19:15:49,460:INFO:   Batch size = 64
2025-03-20 19:15:49,460:INFO:   Num steps = 938
2025-03-20 19:15:49,460:INFO: ***** Running val *****
2025-03-20 19:15:49,460:INFO:   Num examples = 30000
2025-03-20 19:17:55,962:INFO: Effective parameters:
2025-03-20 19:17:55,962:INFO:   <<< batch_size: 16
2025-03-20 19:17:55,962:INFO:   <<< batch_size_val: 64
2025-03-20 19:17:55,962:INFO:   <<< cache_dir: 
2025-03-20 19:17:55,962:INFO:   <<< coef_lr: 0.001
2025-03-20 19:17:55,962:INFO:   <<< cross_model: cross-base
2025-03-20 19:17:55,963:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:17:55,963:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:17:55,963:INFO:   <<< datatype: vatex
2025-03-20 19:17:55,963:INFO:   <<< do_eval: False
2025-03-20 19:17:55,963:INFO:   <<< do_lower_case: False
2025-03-20 19:17:55,963:INFO:   <<< do_pretrain: False
2025-03-20 19:17:55,963:INFO:   <<< do_train: True
2025-03-20 19:17:55,963:INFO:   <<< epochs: 5
2025-03-20 19:17:55,963:INFO:   <<< eval_frame_order: 0
2025-03-20 19:17:55,963:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:17:55,963:INFO:   <<< feature_framerate: 1
2025-03-20 19:17:55,963:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:17:55,963:INFO:   <<< fp16: True
2025-03-20 19:17:55,963:INFO: Effective parameters:
2025-03-20 19:17:55,963:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:17:55,964:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:17:55,964:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:17:55,964:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:17:55,964:INFO:   <<< batch_size: 16
2025-03-20 19:17:55,964:INFO:   <<< init_model: None
2025-03-20 19:17:55,964:INFO:   <<< batch_size_val: 64
2025-03-20 19:17:55,964:INFO:   <<< linear_patch: 2d
2025-03-20 19:17:55,964:INFO:   <<< cache_dir: 
2025-03-20 19:17:55,964:INFO:   <<< local_rank: 0
2025-03-20 19:17:55,964:INFO:   <<< loose_type: True
2025-03-20 19:17:55,964:INFO:   <<< coef_lr: 0.001
2025-03-20 19:17:55,964:INFO:   <<< lr: 0.0001
2025-03-20 19:17:55,964:INFO:   <<< cross_model: cross-base
2025-03-20 19:17:55,964:INFO:   <<< lr_decay: 0.9
2025-03-20 19:17:55,964:INFO:   <<< margin: 0.1
2025-03-20 19:17:55,964:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:17:55,964:INFO:   <<< max_frames: 12
2025-03-20 19:17:55,964:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:17:55,964:INFO:   <<< max_words: 32
2025-03-20 19:17:55,964:INFO:   <<< datatype: vatex
2025-03-20 19:17:55,964:INFO:   <<< n_display: 50
2025-03-20 19:17:55,964:INFO:   <<< do_eval: False
2025-03-20 19:17:55,964:INFO:   <<< n_gpu: 2
2025-03-20 19:17:55,964:INFO:   <<< n_pair: 1
2025-03-20 19:17:55,964:INFO:   <<< do_lower_case: False
2025-03-20 19:17:55,964:INFO:   <<< negative_weighting: 1
2025-03-20 19:17:55,964:INFO:   <<< do_pretrain: False
2025-03-20 19:17:55,964:INFO:   <<< num_thread_reader: 2
2025-03-20 19:17:55,964:INFO:   <<< do_train: True
2025-03-20 19:17:55,964:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:17:55,964:INFO:   <<< epochs: 5
2025-03-20 19:17:55,964:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:17:55,964:INFO:   <<< rank: 1
2025-03-20 19:17:55,964:INFO:   <<< eval_frame_order: 0
2025-03-20 19:17:55,965:INFO:   <<< resume_model: None
2025-03-20 19:17:55,965:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:17:55,965:INFO:   <<< sampled_use_mil: False
2025-03-20 19:17:55,965:INFO:   <<< feature_framerate: 1
2025-03-20 19:17:55,965:INFO:   <<< seed: 42
2025-03-20 19:17:55,965:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:17:55,965:INFO:   <<< sim_header: seqTransf
2025-03-20 19:17:55,965:INFO:   <<< fp16: True
2025-03-20 19:17:55,965:INFO:   <<< slice_framepos: 2
2025-03-20 19:17:55,965:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:17:55,965:INFO:   <<< task_type: retrieval
2025-03-20 19:17:55,965:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:17:55,965:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:17:55,965:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:17:55,965:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:17:55,965:INFO:   <<< train_frame_order: 0
2025-03-20 19:17:55,965:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:17:55,965:INFO:   <<< use_mil: False
2025-03-20 19:17:55,965:INFO:   <<< init_model: None
2025-03-20 19:17:55,965:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:17:55,965:INFO:   <<< linear_patch: 2d
2025-03-20 19:17:55,965:INFO:   <<< video_dim: 1024
2025-03-20 19:17:55,965:INFO:   <<< local_rank: 0
2025-03-20 19:17:55,965:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:17:55,965:INFO:   <<< loose_type: True
2025-03-20 19:17:55,965:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:17:55,965:INFO:   <<< lr: 0.0001
2025-03-20 19:17:55,965:INFO:   <<< world_size: 2
2025-03-20 19:17:55,965:INFO:   <<< lr_decay: 0.9
2025-03-20 19:17:55,965:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:17:55,965:INFO:   <<< margin: 0.1
2025-03-20 19:17:55,965:INFO:   <<< max_frames: 12
2025-03-20 19:17:55,965:INFO:   <<< max_words: 32
2025-03-20 19:17:55,965:INFO:   <<< n_display: 50
2025-03-20 19:17:55,965:INFO:   <<< n_gpu: 2
2025-03-20 19:17:55,966:INFO:   <<< n_pair: 1
2025-03-20 19:17:55,966:INFO:   <<< negative_weighting: 1
2025-03-20 19:17:55,966:INFO:   <<< num_thread_reader: 2
2025-03-20 19:17:55,966:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:17:55,966:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:17:55,966:INFO:   <<< rank: 0
2025-03-20 19:17:55,966:INFO:   <<< resume_model: None
2025-03-20 19:17:55,966:INFO:   <<< sampled_use_mil: False
2025-03-20 19:17:55,966:INFO:   <<< seed: 42
2025-03-20 19:17:55,966:INFO:   <<< sim_header: seqTransf
2025-03-20 19:17:55,966:INFO:   <<< slice_framepos: 2
2025-03-20 19:17:55,966:INFO:   <<< task_type: retrieval
2025-03-20 19:17:55,966:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:17:55,966:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:17:55,966:INFO:   <<< train_frame_order: 0
2025-03-20 19:17:55,966:INFO:   <<< use_mil: False
2025-03-20 19:17:55,966:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:17:55,966:INFO:   <<< video_dim: 1024
2025-03-20 19:17:55,966:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:17:55,967:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:17:55,967:INFO:   <<< world_size: 2
2025-03-20 19:17:55,967:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:17:58,808:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:17:58,809:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:17:58,810:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:17:58,810:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:17:58,810:WARNING: Test retrieval by loose type.
2025-03-20 19:17:58,811:WARNING: 	 embed_dim: 512
2025-03-20 19:17:58,811:WARNING: 	 image_resolution: 224
2025-03-20 19:17:58,811:WARNING: 	 vision_layers: 12
2025-03-20 19:17:58,811:WARNING: 	 vision_width: 768
2025-03-20 19:17:58,812:WARNING: 	 vision_patch_size: 16
2025-03-20 19:17:58,812:WARNING: 	 context_length: 77
2025-03-20 19:17:58,812:WARNING: 	 vocab_size: 49408
2025-03-20 19:17:58,812:WARNING: 	 transformer_width: 512
2025-03-20 19:17:58,812:WARNING: 	 transformer_heads: 8
2025-03-20 19:17:58,812:WARNING: 	 transformer_layers: 12
2025-03-20 19:17:58,812:WARNING: 		 linear_patch: 2d
2025-03-20 19:17:58,812:WARNING: 	 cut_top_layer: 0
2025-03-20 19:17:58,829:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:17:58,830:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:17:58,830:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:17:58,830:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:17:58,831:WARNING: Test retrieval by loose type.
2025-03-20 19:17:58,831:WARNING: 	 embed_dim: 512
2025-03-20 19:17:58,831:WARNING: 	 image_resolution: 224
2025-03-20 19:17:58,831:WARNING: 	 vision_layers: 12
2025-03-20 19:17:58,831:WARNING: 	 vision_width: 768
2025-03-20 19:17:58,831:WARNING: 	 vision_patch_size: 16
2025-03-20 19:17:58,831:WARNING: 	 context_length: 77
2025-03-20 19:17:58,831:WARNING: 	 vocab_size: 49408
2025-03-20 19:17:58,831:WARNING: 	 transformer_width: 512
2025-03-20 19:17:58,831:WARNING: 	 transformer_heads: 8
2025-03-20 19:17:58,832:WARNING: 	 transformer_layers: 12
2025-03-20 19:17:58,832:WARNING: 		 linear_patch: 2d
2025-03-20 19:17:58,832:WARNING: 	 cut_top_layer: 0
2025-03-20 19:18:00,985:WARNING: 	 sim_header: seqTransf
2025-03-20 19:18:01,006:WARNING: 	 sim_header: seqTransf
2025-03-20 19:18:13,758:INFO: --------------------
2025-03-20 19:18:13,759:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:18:13,759:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:18:13,802:INFO: --------------------
2025-03-20 19:18:13,803:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:18:13,803:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:18:23,454:INFO: ***** Running test *****
2025-03-20 19:18:23,454:INFO:   Num examples = 60000
2025-03-20 19:18:23,454:INFO:   Batch size = 64
2025-03-20 19:18:23,454:INFO:   Num steps = 938
2025-03-20 19:18:23,454:INFO: ***** Running val *****
2025-03-20 19:18:23,454:INFO:   Num examples = 30000
2025-03-20 19:18:23,479:INFO: ***** Running test *****
2025-03-20 19:18:23,479:INFO:   Num examples = 60000
2025-03-20 19:18:23,480:INFO:   Batch size = 64
2025-03-20 19:18:23,480:INFO:   Num steps = 938
2025-03-20 19:18:23,480:INFO: ***** Running val *****
2025-03-20 19:18:23,480:INFO:   Num examples = 30000
2025-03-20 19:24:32,505:INFO: Effective parameters:
2025-03-20 19:24:32,505:INFO: Effective parameters:
2025-03-20 19:24:32,505:INFO:   <<< batch_size: 16
2025-03-20 19:24:32,506:INFO:   <<< batch_size: 16
2025-03-20 19:24:32,506:INFO:   <<< batch_size_val: 64
2025-03-20 19:24:32,506:INFO:   <<< batch_size_val: 64
2025-03-20 19:24:32,506:INFO:   <<< cache_dir: 
2025-03-20 19:24:32,506:INFO:   <<< cache_dir: 
2025-03-20 19:24:32,506:INFO:   <<< coef_lr: 0.001
2025-03-20 19:24:32,506:INFO:   <<< coef_lr: 0.001
2025-03-20 19:24:32,506:INFO:   <<< cross_model: cross-base
2025-03-20 19:24:32,506:INFO:   <<< cross_model: cross-base
2025-03-20 19:24:32,506:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:24:32,506:INFO:   <<< cross_num_hidden_layers: 4
2025-03-20 19:24:32,506:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:24:32,506:INFO:   <<< datatype: vatex
2025-03-20 19:24:32,506:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-20 19:24:32,506:INFO:   <<< do_eval: False
2025-03-20 19:24:32,506:INFO:   <<< datatype: vatex
2025-03-20 19:24:32,506:INFO:   <<< do_lower_case: False
2025-03-20 19:24:32,506:INFO:   <<< do_eval: False
2025-03-20 19:24:32,506:INFO:   <<< do_pretrain: False
2025-03-20 19:24:32,506:INFO:   <<< do_lower_case: False
2025-03-20 19:24:32,506:INFO:   <<< do_train: True
2025-03-20 19:24:32,506:INFO:   <<< do_pretrain: False
2025-03-20 19:24:32,506:INFO:   <<< epochs: 5
2025-03-20 19:24:32,506:INFO:   <<< do_train: True
2025-03-20 19:24:32,506:INFO:   <<< eval_frame_order: 0
2025-03-20 19:24:32,506:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:24:32,506:INFO:   <<< epochs: 5
2025-03-20 19:24:32,506:INFO:   <<< feature_framerate: 1
2025-03-20 19:24:32,506:INFO:   <<< eval_frame_order: 0
2025-03-20 19:24:32,506:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:24:32,506:INFO:   <<< expand_msrvtt_sentences: False
2025-03-20 19:24:32,506:INFO:   <<< fp16: True
2025-03-20 19:24:32,506:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:24:32,506:INFO:   <<< feature_framerate: 1
2025-03-20 19:24:32,507:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:24:32,507:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-20 19:24:32,507:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:24:32,507:INFO:   <<< fp16: True
2025-03-20 19:24:32,507:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:24:32,507:INFO:   <<< fp16_opt_level: O3
2025-03-20 19:24:32,507:INFO:   <<< init_model: None
2025-03-20 19:24:32,507:INFO:   <<< freeze_layer_num: 0
2025-03-20 19:24:32,507:INFO:   <<< linear_patch: 2d
2025-03-20 19:24:32,507:INFO:   <<< gradient_accumulation_steps: 1
2025-03-20 19:24:32,507:INFO:   <<< local_rank: 0
2025-03-20 19:24:32,507:INFO:   <<< hard_negative_rate: 0.5
2025-03-20 19:24:32,507:INFO:   <<< loose_type: True
2025-03-20 19:24:32,507:INFO:   <<< init_model: None
2025-03-20 19:24:32,507:INFO:   <<< lr: 0.0001
2025-03-20 19:24:32,507:INFO:   <<< lr_decay: 0.9
2025-03-20 19:24:32,507:INFO:   <<< linear_patch: 2d
2025-03-20 19:24:32,507:INFO:   <<< margin: 0.1
2025-03-20 19:24:32,507:INFO:   <<< local_rank: 0
2025-03-20 19:24:32,507:INFO:   <<< max_frames: 12
2025-03-20 19:24:32,507:INFO:   <<< loose_type: True
2025-03-20 19:24:32,507:INFO:   <<< max_words: 32
2025-03-20 19:24:32,507:INFO:   <<< lr: 0.0001
2025-03-20 19:24:32,507:INFO:   <<< n_display: 50
2025-03-20 19:24:32,507:INFO:   <<< lr_decay: 0.9
2025-03-20 19:24:32,507:INFO:   <<< n_gpu: 2
2025-03-20 19:24:32,507:INFO:   <<< n_pair: 1
2025-03-20 19:24:32,507:INFO:   <<< margin: 0.1
2025-03-20 19:24:32,507:INFO:   <<< negative_weighting: 1
2025-03-20 19:24:32,507:INFO:   <<< max_frames: 12
2025-03-20 19:24:32,507:INFO:   <<< num_thread_reader: 2
2025-03-20 19:24:32,507:INFO:   <<< max_words: 32
2025-03-20 19:24:32,507:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:24:32,507:INFO:   <<< n_display: 50
2025-03-20 19:24:32,507:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:24:32,507:INFO:   <<< n_gpu: 2
2025-03-20 19:24:32,507:INFO:   <<< rank: 0
2025-03-20 19:24:32,507:INFO:   <<< n_pair: 1
2025-03-20 19:24:32,507:INFO:   <<< resume_model: None
2025-03-20 19:24:32,508:INFO:   <<< sampled_use_mil: False
2025-03-20 19:24:32,508:INFO:   <<< negative_weighting: 1
2025-03-20 19:24:32,508:INFO:   <<< seed: 42
2025-03-20 19:24:32,508:INFO:   <<< num_thread_reader: 2
2025-03-20 19:24:32,508:INFO:   <<< sim_header: seqTransf
2025-03-20 19:24:32,508:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-20 19:24:32,508:INFO:   <<< slice_framepos: 2
2025-03-20 19:24:32,508:INFO:   <<< task_type: retrieval
2025-03-20 19:24:32,508:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-20 19:24:32,508:INFO:   <<< rank: 1
2025-03-20 19:24:32,508:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:24:32,508:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:24:32,508:INFO:   <<< resume_model: None
2025-03-20 19:24:32,508:INFO:   <<< sampled_use_mil: False
2025-03-20 19:24:32,508:INFO:   <<< train_frame_order: 0
2025-03-20 19:24:32,508:INFO:   <<< use_mil: False
2025-03-20 19:24:32,508:INFO:   <<< seed: 42
2025-03-20 19:24:32,508:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:24:32,508:INFO:   <<< sim_header: seqTransf
2025-03-20 19:24:32,508:INFO:   <<< video_dim: 1024
2025-03-20 19:24:32,508:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:24:32,508:INFO:   <<< slice_framepos: 2
2025-03-20 19:24:32,508:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:24:32,508:INFO:   <<< task_type: retrieval
2025-03-20 19:24:32,508:INFO:   <<< world_size: 2
2025-03-20 19:24:32,508:INFO:   <<< text_num_hidden_layers: 12
2025-03-20 19:24:32,508:INFO:   <<< train_csv: data/.train.csv
2025-03-20 19:24:32,508:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:24:32,508:INFO:   <<< train_frame_order: 0
2025-03-20 19:24:32,508:INFO:   <<< use_mil: False
2025-03-20 19:24:32,508:INFO:   <<< val_csv: data/.val.csv
2025-03-20 19:24:32,508:INFO:   <<< video_dim: 1024
2025-03-20 19:24:32,508:INFO:   <<< visual_num_hidden_layers: 12
2025-03-20 19:24:32,508:INFO:   <<< warmup_proportion: 0.1
2025-03-20 19:24:32,509:INFO:   <<< world_size: 2
2025-03-20 19:24:32,509:INFO: device: cuda:0 n_gpu: 2
2025-03-20 19:24:35,363:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:24:35,365:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:24:35,365:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:24:35,365:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:24:35,365:WARNING: Test retrieval by loose type.
2025-03-20 19:24:35,366:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-20 19:24:35,366:WARNING: 	 embed_dim: 512
2025-03-20 19:24:35,366:WARNING: 	 image_resolution: 224
2025-03-20 19:24:35,366:WARNING: 	 vision_layers: 12
2025-03-20 19:24:35,366:WARNING: 	 vision_width: 768
2025-03-20 19:24:35,366:WARNING: 	 vision_patch_size: 16
2025-03-20 19:24:35,366:WARNING: 	 context_length: 77
2025-03-20 19:24:35,366:WARNING: 	 vocab_size: 49408
2025-03-20 19:24:35,366:WARNING: 	 transformer_width: 512
2025-03-20 19:24:35,366:WARNING: 	 transformer_heads: 8
2025-03-20 19:24:35,366:WARNING: 	 transformer_layers: 12
2025-03-20 19:24:35,367:WARNING: 		 linear_patch: 2d
2025-03-20 19:24:35,367:WARNING: 	 cut_top_layer: 0
2025-03-20 19:24:35,367:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-20 19:24:35,367:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-20 19:24:35,367:WARNING: Stage-One:True, Stage-Two:False
2025-03-20 19:24:35,367:WARNING: Test retrieval by loose type.
2025-03-20 19:24:35,368:WARNING: 	 embed_dim: 512
2025-03-20 19:24:35,368:WARNING: 	 image_resolution: 224
2025-03-20 19:24:35,368:WARNING: 	 vision_layers: 12
2025-03-20 19:24:35,368:WARNING: 	 vision_width: 768
2025-03-20 19:24:35,368:WARNING: 	 vision_patch_size: 16
2025-03-20 19:24:35,368:WARNING: 	 context_length: 77
2025-03-20 19:24:35,368:WARNING: 	 vocab_size: 49408
2025-03-20 19:24:35,368:WARNING: 	 transformer_width: 512
2025-03-20 19:24:35,368:WARNING: 	 transformer_heads: 8
2025-03-20 19:24:35,368:WARNING: 	 transformer_layers: 12
2025-03-20 19:24:35,368:WARNING: 		 linear_patch: 2d
2025-03-20 19:24:35,368:WARNING: 	 cut_top_layer: 0
2025-03-20 19:24:37,553:WARNING: 	 sim_header: seqTransf
2025-03-20 19:24:37,557:WARNING: 	 sim_header: seqTransf
2025-03-20 19:24:50,317:INFO: --------------------
2025-03-20 19:24:50,318:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:24:50,318:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:24:50,332:INFO: --------------------
2025-03-20 19:24:50,333:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-20 19:24:50,333:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-20 19:24:59,978:INFO: ***** Running test *****
2025-03-20 19:24:59,978:INFO:   Num examples = 60000
2025-03-20 19:24:59,978:INFO:   Batch size = 64
2025-03-20 19:24:59,978:INFO:   Num steps = 938
2025-03-20 19:24:59,978:INFO: ***** Running val *****
2025-03-20 19:24:59,978:INFO:   Num examples = 30000
2025-03-20 19:25:00,007:INFO: ***** Running test *****
2025-03-20 19:25:00,008:INFO:   Num examples = 60000
2025-03-20 19:25:00,008:INFO:   Batch size = 64
2025-03-20 19:25:00,008:INFO:   Num steps = 938
2025-03-20 19:25:00,008:INFO: ***** Running val *****
2025-03-20 19:25:00,008:INFO:   Num examples = 30000
2025-03-21 09:55:49,821:INFO: Effective parameters:
2025-03-21 09:55:49,821:INFO:   <<< batch_size: 16
2025-03-21 09:55:49,827:INFO:   <<< batch_size_val: 64
2025-03-21 09:55:49,827:INFO:   <<< cache_dir: 
2025-03-21 09:55:49,827:INFO: Effective parameters:
2025-03-21 09:55:49,827:INFO:   <<< coef_lr: 0.001
2025-03-21 09:55:49,827:INFO:   <<< batch_size: 16
2025-03-21 09:55:49,827:INFO:   <<< cross_model: cross-base
2025-03-21 09:55:49,827:INFO:   <<< batch_size_val: 64
2025-03-21 09:55:49,827:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 09:55:49,827:INFO:   <<< cache_dir: 
2025-03-21 09:55:49,827:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 09:55:49,827:INFO:   <<< coef_lr: 0.001
2025-03-21 09:55:49,827:INFO:   <<< datatype: vatex
2025-03-21 09:55:49,827:INFO:   <<< cross_model: cross-base
2025-03-21 09:55:49,827:INFO:   <<< do_eval: False
2025-03-21 09:55:49,827:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 09:55:49,827:INFO:   <<< do_lower_case: False
2025-03-21 09:55:49,827:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 09:55:49,827:INFO:   <<< datatype: vatex
2025-03-21 09:55:49,827:INFO:   <<< do_pretrain: False
2025-03-21 09:55:49,827:INFO:   <<< do_eval: False
2025-03-21 09:55:49,827:INFO:   <<< do_train: True
2025-03-21 09:55:49,827:INFO:   <<< do_lower_case: False
2025-03-21 09:55:49,827:INFO:   <<< epochs: 5
2025-03-21 09:55:49,827:INFO:   <<< do_pretrain: False
2025-03-21 09:55:49,827:INFO:   <<< eval_frame_order: 0
2025-03-21 09:55:49,827:INFO:   <<< do_train: True
2025-03-21 09:55:49,827:INFO:   <<< epochs: 5
2025-03-21 09:55:49,827:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 09:55:49,828:INFO:   <<< feature_framerate: 1
2025-03-21 09:55:49,828:INFO:   <<< eval_frame_order: 0
2025-03-21 09:55:49,828:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 09:55:49,828:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 09:55:49,828:INFO:   <<< fp16: True
2025-03-21 09:55:49,828:INFO:   <<< feature_framerate: 1
2025-03-21 09:55:49,828:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 09:55:49,828:INFO:   <<< fp16_opt_level: O3
2025-03-21 09:55:49,828:INFO:   <<< fp16: True
2025-03-21 09:55:49,828:INFO:   <<< freeze_layer_num: 0
2025-03-21 09:55:49,828:INFO:   <<< fp16_opt_level: O3
2025-03-21 09:55:49,828:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 09:55:49,828:INFO:   <<< freeze_layer_num: 0
2025-03-21 09:55:49,828:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 09:55:49,828:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 09:55:49,828:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 09:55:49,828:INFO:   <<< init_model: None
2025-03-21 09:55:49,828:INFO:   <<< linear_patch: 2d
2025-03-21 09:55:49,828:INFO:   <<< init_model: None
2025-03-21 09:55:49,828:INFO:   <<< local_rank: 0
2025-03-21 09:55:49,828:INFO:   <<< linear_patch: 2d
2025-03-21 09:55:49,828:INFO:   <<< loose_type: True
2025-03-21 09:55:49,828:INFO:   <<< local_rank: 0
2025-03-21 09:55:49,828:INFO:   <<< loose_type: True
2025-03-21 09:55:49,828:INFO:   <<< lr: 0.0001
2025-03-21 09:55:49,828:INFO:   <<< lr: 0.0001
2025-03-21 09:55:49,828:INFO:   <<< lr_decay: 0.9
2025-03-21 09:55:49,828:INFO:   <<< lr_decay: 0.9
2025-03-21 09:55:49,828:INFO:   <<< margin: 0.1
2025-03-21 09:55:49,828:INFO:   <<< margin: 0.1
2025-03-21 09:55:49,828:INFO:   <<< max_frames: 12
2025-03-21 09:55:49,828:INFO:   <<< max_frames: 12
2025-03-21 09:55:49,828:INFO:   <<< max_words: 32
2025-03-21 09:55:49,828:INFO:   <<< max_words: 32
2025-03-21 09:55:49,828:INFO:   <<< n_display: 50
2025-03-21 09:55:49,828:INFO:   <<< n_display: 50
2025-03-21 09:55:49,828:INFO:   <<< n_gpu: 2
2025-03-21 09:55:49,828:INFO:   <<< n_gpu: 2
2025-03-21 09:55:49,828:INFO:   <<< n_pair: 1
2025-03-21 09:55:49,828:INFO:   <<< n_pair: 1
2025-03-21 09:55:49,829:INFO:   <<< negative_weighting: 1
2025-03-21 09:55:49,829:INFO:   <<< negative_weighting: 1
2025-03-21 09:55:49,829:INFO:   <<< num_thread_reader: 2
2025-03-21 09:55:49,829:INFO:   <<< num_thread_reader: 2
2025-03-21 09:55:49,829:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 09:55:49,829:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 09:55:49,829:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 09:55:49,829:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 09:55:49,829:INFO:   <<< rank: 1
2025-03-21 09:55:49,829:INFO:   <<< resume_model: None
2025-03-21 09:55:49,829:INFO:   <<< rank: 0
2025-03-21 09:55:49,829:INFO:   <<< resume_model: None
2025-03-21 09:55:49,829:INFO:   <<< sampled_use_mil: False
2025-03-21 09:55:49,829:INFO:   <<< sampled_use_mil: False
2025-03-21 09:55:49,829:INFO:   <<< seed: 42
2025-03-21 09:55:49,829:INFO:   <<< seed: 42
2025-03-21 09:55:49,829:INFO:   <<< sim_header: seqTransf
2025-03-21 09:55:49,829:INFO:   <<< slice_framepos: 2
2025-03-21 09:55:49,829:INFO:   <<< sim_header: seqTransf
2025-03-21 09:55:49,829:INFO:   <<< task_type: retrieval
2025-03-21 09:55:49,829:INFO:   <<< slice_framepos: 2
2025-03-21 09:55:49,829:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 09:55:49,829:INFO:   <<< train_csv: data/.train.csv
2025-03-21 09:55:49,829:INFO:   <<< task_type: retrieval
2025-03-21 09:55:49,829:INFO:   <<< train_frame_order: 0
2025-03-21 09:55:49,829:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 09:55:49,829:INFO:   <<< use_mil: False
2025-03-21 09:55:49,829:INFO:   <<< train_csv: data/.train.csv
2025-03-21 09:55:49,829:INFO:   <<< val_csv: data/.val.csv
2025-03-21 09:55:49,829:INFO:   <<< train_frame_order: 0
2025-03-21 09:55:49,829:INFO:   <<< use_mil: False
2025-03-21 09:55:49,829:INFO:   <<< video_dim: 1024
2025-03-21 09:55:49,829:INFO:   <<< val_csv: data/.val.csv
2025-03-21 09:55:49,829:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 09:55:49,829:INFO:   <<< warmup_proportion: 0.1
2025-03-21 09:55:49,829:INFO:   <<< video_dim: 1024
2025-03-21 09:55:49,829:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 09:55:49,829:INFO:   <<< world_size: 2
2025-03-21 09:55:49,829:INFO:   <<< warmup_proportion: 0.1
2025-03-21 09:55:49,830:INFO: device: cuda:0 n_gpu: 2
2025-03-21 09:55:49,830:INFO:   <<< world_size: 2
2025-03-21 09:55:49,830:INFO: device: cuda:0 n_gpu: 2
2025-03-21 09:55:52,671:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 09:55:52,673:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 09:55:52,674:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 09:55:52,674:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 09:55:52,674:WARNING: Test retrieval by loose type.
2025-03-21 09:55:52,675:WARNING: 	 embed_dim: 512
2025-03-21 09:55:52,675:WARNING: 	 image_resolution: 224
2025-03-21 09:55:52,675:WARNING: 	 vision_layers: 12
2025-03-21 09:55:52,675:WARNING: 	 vision_width: 768
2025-03-21 09:55:52,675:WARNING: 	 vision_patch_size: 16
2025-03-21 09:55:52,675:WARNING: 	 context_length: 77
2025-03-21 09:55:52,676:WARNING: 	 vocab_size: 49408
2025-03-21 09:55:52,676:WARNING: 	 transformer_width: 512
2025-03-21 09:55:52,676:WARNING: 	 transformer_heads: 8
2025-03-21 09:55:52,676:WARNING: 	 transformer_layers: 12
2025-03-21 09:55:52,676:WARNING: 		 linear_patch: 2d
2025-03-21 09:55:52,676:WARNING: 	 cut_top_layer: 0
2025-03-21 09:55:52,686:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 09:55:52,687:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 09:55:52,687:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 09:55:52,687:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 09:55:52,687:WARNING: Test retrieval by loose type.
2025-03-21 09:55:52,688:WARNING: 	 embed_dim: 512
2025-03-21 09:55:52,688:WARNING: 	 image_resolution: 224
2025-03-21 09:55:52,688:WARNING: 	 vision_layers: 12
2025-03-21 09:55:52,688:WARNING: 	 vision_width: 768
2025-03-21 09:55:52,688:WARNING: 	 vision_patch_size: 16
2025-03-21 09:55:52,688:WARNING: 	 context_length: 77
2025-03-21 09:55:52,688:WARNING: 	 vocab_size: 49408
2025-03-21 09:55:52,688:WARNING: 	 transformer_width: 512
2025-03-21 09:55:52,688:WARNING: 	 transformer_heads: 8
2025-03-21 09:55:52,688:WARNING: 	 transformer_layers: 12
2025-03-21 09:55:52,688:WARNING: 		 linear_patch: 2d
2025-03-21 09:55:52,689:WARNING: 	 cut_top_layer: 0
2025-03-21 09:55:54,854:WARNING: 	 sim_header: seqTransf
2025-03-21 09:55:54,877:WARNING: 	 sim_header: seqTransf
2025-03-21 09:56:07,622:INFO: --------------------
2025-03-21 09:56:07,623:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 09:56:07,624:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 09:56:07,664:INFO: --------------------
2025-03-21 09:56:07,664:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 09:56:07,665:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 09:56:17,367:INFO: ***** Running test *****
2025-03-21 09:56:17,367:INFO:   Num examples = 60000
2025-03-21 09:56:17,367:INFO:   Batch size = 64
2025-03-21 09:56:17,367:INFO:   Num steps = 938
2025-03-21 09:56:17,367:INFO: ***** Running val *****
2025-03-21 09:56:17,367:INFO:   Num examples = 30000
2025-03-21 09:56:17,386:INFO: ***** Running test *****
2025-03-21 09:56:17,386:INFO:   Num examples = 60000
2025-03-21 09:56:17,386:INFO:   Batch size = 64
2025-03-21 09:56:17,386:INFO:   Num steps = 938
2025-03-21 09:56:17,386:INFO: ***** Running val *****
2025-03-21 09:56:17,387:INFO:   Num examples = 30000
2025-03-21 14:44:48,060:INFO: Effective parameters:
2025-03-21 14:44:48,060:INFO: Effective parameters:
2025-03-21 14:44:48,060:INFO:   <<< batch_size: 16
2025-03-21 14:44:48,060:INFO:   <<< batch_size: 16
2025-03-21 14:44:48,060:INFO:   <<< batch_size_val: 64
2025-03-21 14:44:48,060:INFO:   <<< batch_size_val: 64
2025-03-21 14:44:48,060:INFO:   <<< cache_dir: 
2025-03-21 14:44:48,060:INFO:   <<< cache_dir: 
2025-03-21 14:44:48,060:INFO:   <<< coef_lr: 0.001
2025-03-21 14:44:48,060:INFO:   <<< coef_lr: 0.001
2025-03-21 14:44:48,060:INFO:   <<< cross_model: cross-base
2025-03-21 14:44:48,060:INFO:   <<< cross_model: cross-base
2025-03-21 14:44:48,061:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 14:44:48,061:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 14:44:48,061:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 14:44:48,061:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 14:44:48,061:INFO:   <<< datatype: vatex
2025-03-21 14:44:48,061:INFO:   <<< datatype: vatex
2025-03-21 14:44:48,061:INFO:   <<< do_eval: False
2025-03-21 14:44:48,061:INFO:   <<< do_eval: False
2025-03-21 14:44:48,061:INFO:   <<< do_lower_case: False
2025-03-21 14:44:48,061:INFO:   <<< do_lower_case: False
2025-03-21 14:44:48,061:INFO:   <<< do_pretrain: False
2025-03-21 14:44:48,061:INFO:   <<< do_pretrain: False
2025-03-21 14:44:48,061:INFO:   <<< do_train: True
2025-03-21 14:44:48,061:INFO:   <<< do_train: True
2025-03-21 14:44:48,061:INFO:   <<< epochs: 5
2025-03-21 14:44:48,061:INFO:   <<< eval_frame_order: 0
2025-03-21 14:44:48,061:INFO:   <<< epochs: 5
2025-03-21 14:44:48,061:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 14:44:48,061:INFO:   <<< eval_frame_order: 0
2025-03-21 14:44:48,061:INFO:   <<< feature_framerate: 1
2025-03-21 14:44:48,061:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 14:44:48,061:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 14:44:48,061:INFO:   <<< feature_framerate: 1
2025-03-21 14:44:48,061:INFO:   <<< fp16: True
2025-03-21 14:44:48,061:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 14:44:48,061:INFO:   <<< fp16_opt_level: O1
2025-03-21 14:44:48,061:INFO:   <<< fp16: True
2025-03-21 14:44:48,061:INFO:   <<< freeze_layer_num: 0
2025-03-21 14:44:48,061:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 14:44:48,061:INFO:   <<< fp16_opt_level: O1
2025-03-21 14:44:48,061:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 14:44:48,061:INFO:   <<< freeze_layer_num: 0
2025-03-21 14:44:48,061:INFO:   <<< init_model: None
2025-03-21 14:44:48,061:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 14:44:48,061:INFO:   <<< linear_patch: 2d
2025-03-21 14:44:48,061:INFO:   <<< local_rank: 0
2025-03-21 14:44:48,061:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 14:44:48,061:INFO:   <<< loose_type: True
2025-03-21 14:44:48,061:INFO:   <<< init_model: None
2025-03-21 14:44:48,062:INFO:   <<< lr: 0.0001
2025-03-21 14:44:48,062:INFO:   <<< linear_patch: 2d
2025-03-21 14:44:48,062:INFO:   <<< local_rank: 0
2025-03-21 14:44:48,062:INFO:   <<< lr_decay: 0.9
2025-03-21 14:44:48,062:INFO:   <<< loose_type: True
2025-03-21 14:44:48,062:INFO:   <<< margin: 0.1
2025-03-21 14:44:48,062:INFO:   <<< max_frames: 12
2025-03-21 14:44:48,062:INFO:   <<< lr: 0.0001
2025-03-21 14:44:48,062:INFO:   <<< max_words: 32
2025-03-21 14:44:48,062:INFO:   <<< lr_decay: 0.9
2025-03-21 14:44:48,062:INFO:   <<< n_display: 50
2025-03-21 14:44:48,062:INFO:   <<< margin: 0.1
2025-03-21 14:44:48,062:INFO:   <<< n_gpu: 2
2025-03-21 14:44:48,062:INFO:   <<< n_pair: 1
2025-03-21 14:44:48,062:INFO:   <<< max_frames: 12
2025-03-21 14:44:48,062:INFO:   <<< negative_weighting: 1
2025-03-21 14:44:48,062:INFO:   <<< max_words: 32
2025-03-21 14:44:48,062:INFO:   <<< n_display: 50
2025-03-21 14:44:48,062:INFO:   <<< num_thread_reader: 2
2025-03-21 14:44:48,062:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 14:44:48,062:INFO:   <<< n_gpu: 2
2025-03-21 14:44:48,062:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 14:44:48,062:INFO:   <<< n_pair: 1
2025-03-21 14:44:48,062:INFO:   <<< rank: 1
2025-03-21 14:44:48,062:INFO:   <<< resume_model: None
2025-03-21 14:44:48,062:INFO:   <<< negative_weighting: 1
2025-03-21 14:44:48,062:INFO:   <<< num_thread_reader: 2
2025-03-21 14:44:48,062:INFO:   <<< sampled_use_mil: False
2025-03-21 14:44:48,062:INFO:   <<< seed: 42
2025-03-21 14:44:48,062:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 14:44:48,062:INFO:   <<< sim_header: seqTransf
2025-03-21 14:44:48,062:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 14:44:48,062:INFO:   <<< slice_framepos: 2
2025-03-21 14:44:48,062:INFO:   <<< rank: 0
2025-03-21 14:44:48,062:INFO:   <<< task_type: retrieval
2025-03-21 14:44:48,062:INFO:   <<< resume_model: None
2025-03-21 14:44:48,062:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 14:44:48,062:INFO:   <<< sampled_use_mil: False
2025-03-21 14:44:48,062:INFO:   <<< train_csv: data/.train.csv
2025-03-21 14:44:48,063:INFO:   <<< train_frame_order: 0
2025-03-21 14:44:48,062:INFO:   <<< seed: 42
2025-03-21 14:44:48,063:INFO:   <<< use_mil: False
2025-03-21 14:44:48,063:INFO:   <<< sim_header: seqTransf
2025-03-21 14:44:48,063:INFO:   <<< slice_framepos: 2
2025-03-21 14:44:48,063:INFO:   <<< val_csv: data/.val.csv
2025-03-21 14:44:48,063:INFO:   <<< task_type: retrieval
2025-03-21 14:44:48,063:INFO:   <<< video_dim: 1024
2025-03-21 14:44:48,063:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 14:44:48,063:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 14:44:48,063:INFO:   <<< warmup_proportion: 0.1
2025-03-21 14:44:48,063:INFO:   <<< train_csv: data/.train.csv
2025-03-21 14:44:48,063:INFO:   <<< world_size: 2
2025-03-21 14:44:48,063:INFO:   <<< train_frame_order: 0
2025-03-21 14:44:48,063:INFO:   <<< use_mil: False
2025-03-21 14:44:48,063:INFO: device: cuda:0 n_gpu: 2
2025-03-21 14:44:48,063:INFO:   <<< val_csv: data/.val.csv
2025-03-21 14:44:48,063:INFO:   <<< video_dim: 1024
2025-03-21 14:44:48,063:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 14:44:48,063:INFO:   <<< warmup_proportion: 0.1
2025-03-21 14:44:48,063:INFO:   <<< world_size: 2
2025-03-21 14:44:48,063:INFO: device: cuda:0 n_gpu: 2
2025-03-21 14:44:52,063:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 14:44:52,063:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 14:44:52,077:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 14:44:52,077:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 14:44:52,077:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 14:44:52,077:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 14:44:52,077:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 14:44:52,077:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 14:44:52,078:WARNING: Test retrieval by loose type.
2025-03-21 14:44:52,078:WARNING: Test retrieval by loose type.
2025-03-21 14:44:52,078:WARNING: 	 embed_dim: 512
2025-03-21 14:44:52,078:WARNING: 	 embed_dim: 512
2025-03-21 14:44:52,078:WARNING: 	 image_resolution: 224
2025-03-21 14:44:52,078:WARNING: 	 image_resolution: 224
2025-03-21 14:44:52,078:WARNING: 	 vision_layers: 12
2025-03-21 14:44:52,078:WARNING: 	 vision_layers: 12
2025-03-21 14:44:52,078:WARNING: 	 vision_width: 768
2025-03-21 14:44:52,078:WARNING: 	 vision_width: 768
2025-03-21 14:44:52,078:WARNING: 	 vision_patch_size: 16
2025-03-21 14:44:52,078:WARNING: 	 context_length: 77
2025-03-21 14:44:52,078:WARNING: 	 vision_patch_size: 16
2025-03-21 14:44:52,078:WARNING: 	 context_length: 77
2025-03-21 14:44:52,078:WARNING: 	 vocab_size: 49408
2025-03-21 14:44:52,078:WARNING: 	 transformer_width: 512
2025-03-21 14:44:52,078:WARNING: 	 vocab_size: 49408
2025-03-21 14:44:52,078:WARNING: 	 transformer_heads: 8
2025-03-21 14:44:52,078:WARNING: 	 transformer_width: 512
2025-03-21 14:44:52,078:WARNING: 	 transformer_layers: 12
2025-03-21 14:44:52,078:WARNING: 	 transformer_heads: 8
2025-03-21 14:44:52,079:WARNING: 	 transformer_layers: 12
2025-03-21 14:44:52,079:WARNING: 		 linear_patch: 2d
2025-03-21 14:44:52,079:WARNING: 	 cut_top_layer: 0
2025-03-21 14:44:52,079:WARNING: 		 linear_patch: 2d
2025-03-21 14:44:52,079:WARNING: 	 cut_top_layer: 0
2025-03-21 14:44:54,394:WARNING: 	 sim_header: seqTransf
2025-03-21 14:44:54,407:WARNING: 	 sim_header: seqTransf
2025-03-21 14:45:07,163:INFO: --------------------
2025-03-21 14:45:07,164:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 14:45:07,164:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 14:45:07,174:INFO: --------------------
2025-03-21 14:45:07,174:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 14:45:07,174:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 14:45:17,009:INFO: ***** Running test *****
2025-03-21 14:45:17,010:INFO:   Num examples = 60000
2025-03-21 14:45:17,010:INFO:   Batch size = 64
2025-03-21 14:45:17,010:INFO:   Num steps = 938
2025-03-21 14:45:17,010:INFO: ***** Running val *****
2025-03-21 14:45:17,010:INFO:   Num examples = 30000
2025-03-21 14:45:17,025:INFO: ***** Running test *****
2025-03-21 14:45:17,025:INFO:   Num examples = 60000
2025-03-21 14:45:17,025:INFO:   Batch size = 64
2025-03-21 14:45:17,025:INFO:   Num steps = 938
2025-03-21 14:45:17,025:INFO: ***** Running val *****
2025-03-21 14:45:17,025:INFO:   Num examples = 30000
2025-03-21 14:53:38,379:INFO: Effective parameters:
2025-03-21 14:53:38,379:INFO:   <<< batch_size: 16
2025-03-21 14:53:38,380:INFO:   <<< batch_size_val: 64
2025-03-21 14:53:38,380:INFO:   <<< cache_dir: 
2025-03-21 14:53:38,380:INFO:   <<< coef_lr: 0.001
2025-03-21 14:53:38,380:INFO:   <<< cross_model: cross-base
2025-03-21 14:53:38,380:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 14:53:38,380:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 14:53:38,380:INFO:   <<< datatype: vatex
2025-03-21 14:53:38,380:INFO:   <<< do_eval: False
2025-03-21 14:53:38,380:INFO:   <<< do_lower_case: False
2025-03-21 14:53:38,380:INFO:   <<< do_pretrain: False
2025-03-21 14:53:38,380:INFO:   <<< do_train: True
2025-03-21 14:53:38,380:INFO:   <<< epochs: 5
2025-03-21 14:53:38,381:INFO:   <<< eval_frame_order: 0
2025-03-21 14:53:38,381:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 14:53:38,381:INFO:   <<< feature_framerate: 1
2025-03-21 14:53:38,381:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 14:53:38,381:INFO:   <<< fp16: True
2025-03-21 14:53:38,381:INFO:   <<< fp16_opt_level: O1
2025-03-21 14:53:38,381:INFO:   <<< freeze_layer_num: 0
2025-03-21 14:53:38,381:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 14:53:38,381:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 14:53:38,381:INFO:   <<< init_model: None
2025-03-21 14:53:38,381:INFO:   <<< linear_patch: 2d
2025-03-21 14:53:38,381:INFO:   <<< local_rank: 0
2025-03-21 14:53:38,381:INFO:   <<< loose_type: True
2025-03-21 14:53:38,381:INFO:   <<< lr: 0.0001
2025-03-21 14:53:38,381:INFO:   <<< lr_decay: 0.9
2025-03-21 14:53:38,382:INFO:   <<< margin: 0.1
2025-03-21 14:53:38,382:INFO:   <<< max_frames: 12
2025-03-21 14:53:38,382:INFO:   <<< max_words: 32
2025-03-21 14:53:38,382:INFO:   <<< n_display: 50
2025-03-21 14:53:38,382:INFO:   <<< n_gpu: 2
2025-03-21 14:53:38,382:INFO:   <<< n_pair: 1
2025-03-21 14:53:38,382:INFO:   <<< negative_weighting: 1
2025-03-21 14:53:38,382:INFO:   <<< num_thread_reader: 2
2025-03-21 14:53:38,382:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 14:53:38,382:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 14:53:38,382:INFO:   <<< rank: 0
2025-03-21 14:53:38,382:INFO:   <<< resume_model: None
2025-03-21 14:53:38,382:INFO:   <<< sampled_use_mil: False
2025-03-21 14:53:38,382:INFO:   <<< seed: 42
2025-03-21 14:53:38,382:INFO:   <<< sim_header: seqTransf
2025-03-21 14:53:38,382:INFO:   <<< slice_framepos: 2
2025-03-21 14:53:38,382:INFO:   <<< task_type: retrieval
2025-03-21 14:53:38,383:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 14:53:38,383:INFO:   <<< train_csv: data/.train.csv
2025-03-21 14:53:38,383:INFO:   <<< train_frame_order: 0
2025-03-21 14:53:38,383:INFO:   <<< use_mil: False
2025-03-21 14:53:38,383:INFO:   <<< val_csv: data/.val.csv
2025-03-21 14:53:38,383:INFO:   <<< video_dim: 1024
2025-03-21 14:53:38,383:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 14:53:38,383:INFO:   <<< warmup_proportion: 0.1
2025-03-21 14:53:38,383:INFO:   <<< world_size: 2
2025-03-21 14:53:38,383:INFO: device: cuda:0 n_gpu: 2
2025-03-21 14:53:38,384:INFO: Effective parameters:
2025-03-21 14:53:38,384:INFO:   <<< batch_size: 16
2025-03-21 14:53:38,384:INFO:   <<< batch_size_val: 64
2025-03-21 14:53:38,384:INFO:   <<< cache_dir: 
2025-03-21 14:53:38,384:INFO:   <<< coef_lr: 0.001
2025-03-21 14:53:38,384:INFO:   <<< cross_model: cross-base
2025-03-21 14:53:38,384:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 14:53:38,384:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 14:53:38,385:INFO:   <<< datatype: vatex
2025-03-21 14:53:38,385:INFO:   <<< do_eval: False
2025-03-21 14:53:38,385:INFO:   <<< do_lower_case: False
2025-03-21 14:53:38,385:INFO:   <<< do_pretrain: False
2025-03-21 14:53:38,385:INFO:   <<< do_train: True
2025-03-21 14:53:38,385:INFO:   <<< epochs: 5
2025-03-21 14:53:38,385:INFO:   <<< eval_frame_order: 0
2025-03-21 14:53:38,385:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 14:53:38,385:INFO:   <<< feature_framerate: 1
2025-03-21 14:53:38,385:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 14:53:38,385:INFO:   <<< fp16: True
2025-03-21 14:53:38,385:INFO:   <<< fp16_opt_level: O1
2025-03-21 14:53:38,385:INFO:   <<< freeze_layer_num: 0
2025-03-21 14:53:38,385:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 14:53:38,385:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 14:53:38,385:INFO:   <<< init_model: None
2025-03-21 14:53:38,385:INFO:   <<< linear_patch: 2d
2025-03-21 14:53:38,385:INFO:   <<< local_rank: 0
2025-03-21 14:53:38,385:INFO:   <<< loose_type: True
2025-03-21 14:53:38,385:INFO:   <<< lr: 0.0001
2025-03-21 14:53:38,385:INFO:   <<< lr_decay: 0.9
2025-03-21 14:53:38,386:INFO:   <<< margin: 0.1
2025-03-21 14:53:38,386:INFO:   <<< max_frames: 12
2025-03-21 14:53:38,386:INFO:   <<< max_words: 32
2025-03-21 14:53:38,386:INFO:   <<< n_display: 50
2025-03-21 14:53:38,386:INFO:   <<< n_gpu: 2
2025-03-21 14:53:38,386:INFO:   <<< n_pair: 1
2025-03-21 14:53:38,386:INFO:   <<< negative_weighting: 1
2025-03-21 14:53:38,386:INFO:   <<< num_thread_reader: 2
2025-03-21 14:53:38,386:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 14:53:38,386:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 14:53:38,386:INFO:   <<< rank: 1
2025-03-21 14:53:38,386:INFO:   <<< resume_model: None
2025-03-21 14:53:38,386:INFO:   <<< sampled_use_mil: False
2025-03-21 14:53:38,386:INFO:   <<< seed: 42
2025-03-21 14:53:38,386:INFO:   <<< sim_header: seqTransf
2025-03-21 14:53:38,386:INFO:   <<< slice_framepos: 2
2025-03-21 14:53:38,386:INFO:   <<< task_type: retrieval
2025-03-21 14:53:38,386:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 14:53:38,386:INFO:   <<< train_csv: data/.train.csv
2025-03-21 14:53:38,386:INFO:   <<< train_frame_order: 0
2025-03-21 14:53:38,386:INFO:   <<< use_mil: False
2025-03-21 14:53:38,386:INFO:   <<< val_csv: data/.val.csv
2025-03-21 14:53:38,386:INFO:   <<< video_dim: 1024
2025-03-21 14:53:38,386:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 14:53:38,387:INFO:   <<< warmup_proportion: 0.1
2025-03-21 14:53:38,387:INFO:   <<< world_size: 2
2025-03-21 14:53:38,387:INFO: device: cuda:0 n_gpu: 2
2025-03-21 14:53:41,174:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 14:53:41,176:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 14:53:41,176:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 14:53:41,177:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 14:53:41,177:WARNING: Test retrieval by loose type.
2025-03-21 14:53:41,178:WARNING: 	 embed_dim: 512
2025-03-21 14:53:41,178:WARNING: 	 image_resolution: 224
2025-03-21 14:53:41,178:WARNING: 	 vision_layers: 12
2025-03-21 14:53:41,178:WARNING: 	 vision_width: 768
2025-03-21 14:53:41,178:WARNING: 	 vision_patch_size: 16
2025-03-21 14:53:41,178:WARNING: 	 context_length: 77
2025-03-21 14:53:41,178:WARNING: 	 vocab_size: 49408
2025-03-21 14:53:41,178:WARNING: 	 transformer_width: 512
2025-03-21 14:53:41,179:WARNING: 	 transformer_heads: 8
2025-03-21 14:53:41,179:WARNING: 	 transformer_layers: 12
2025-03-21 14:53:41,179:WARNING: 		 linear_patch: 2d
2025-03-21 14:53:41,179:WARNING: 	 cut_top_layer: 0
2025-03-21 14:53:41,188:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 14:53:41,189:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 14:53:41,189:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 14:53:41,189:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 14:53:41,189:WARNING: Test retrieval by loose type.
2025-03-21 14:53:41,190:WARNING: 	 embed_dim: 512
2025-03-21 14:53:41,190:WARNING: 	 image_resolution: 224
2025-03-21 14:53:41,190:WARNING: 	 vision_layers: 12
2025-03-21 14:53:41,190:WARNING: 	 vision_width: 768
2025-03-21 14:53:41,190:WARNING: 	 vision_patch_size: 16
2025-03-21 14:53:41,190:WARNING: 	 context_length: 77
2025-03-21 14:53:41,190:WARNING: 	 vocab_size: 49408
2025-03-21 14:53:41,191:WARNING: 	 transformer_width: 512
2025-03-21 14:53:41,191:WARNING: 	 transformer_heads: 8
2025-03-21 14:53:41,191:WARNING: 	 transformer_layers: 12
2025-03-21 14:53:41,191:WARNING: 		 linear_patch: 2d
2025-03-21 14:53:41,191:WARNING: 	 cut_top_layer: 0
2025-03-21 14:53:43,338:WARNING: 	 sim_header: seqTransf
2025-03-21 14:53:43,356:WARNING: 	 sim_header: seqTransf
2025-03-21 14:53:56,127:INFO: --------------------
2025-03-21 14:53:56,128:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 14:53:56,129:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 14:53:56,155:INFO: --------------------
2025-03-21 14:53:56,156:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 14:53:56,156:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 14:54:05,750:INFO: ***** Running test *****
2025-03-21 14:54:05,750:INFO:   Num examples = 60000
2025-03-21 14:54:05,750:INFO:   Batch size = 64
2025-03-21 14:54:05,750:INFO:   Num steps = 938
2025-03-21 14:54:05,750:INFO: ***** Running val *****
2025-03-21 14:54:05,750:INFO:   Num examples = 30000
2025-03-21 14:54:05,750:INFO: ***** Running test *****
2025-03-21 14:54:05,750:INFO:   Num examples = 60000
2025-03-21 14:54:05,750:INFO:   Batch size = 64
2025-03-21 14:54:05,750:INFO:   Num steps = 938
2025-03-21 14:54:05,750:INFO: ***** Running val *****
2025-03-21 14:54:05,750:INFO:   Num examples = 30000
2025-03-21 14:56:44,425:INFO: Effective parameters:
2025-03-21 14:56:44,426:INFO:   <<< batch_size: 16
2025-03-21 14:56:44,426:INFO:   <<< batch_size_val: 64
2025-03-21 14:56:44,426:INFO:   <<< cache_dir: 
2025-03-21 14:56:44,426:INFO:   <<< coef_lr: 0.001
2025-03-21 14:56:44,426:INFO:   <<< cross_model: cross-base
2025-03-21 14:56:44,426:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 14:56:44,426:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 14:56:44,426:INFO:   <<< datatype: vatex
2025-03-21 14:56:44,426:INFO:   <<< do_eval: False
2025-03-21 14:56:44,426:INFO:   <<< do_lower_case: False
2025-03-21 14:56:44,426:INFO:   <<< do_pretrain: False
2025-03-21 14:56:44,426:INFO:   <<< do_train: True
2025-03-21 14:56:44,426:INFO:   <<< epochs: 5
2025-03-21 14:56:44,426:INFO:   <<< eval_frame_order: 0
2025-03-21 14:56:44,426:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 14:56:44,426:INFO:   <<< feature_framerate: 1
2025-03-21 14:56:44,426:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 14:56:44,426:INFO:   <<< fp16: True
2025-03-21 14:56:44,426:INFO:   <<< fp16_opt_level: O1
2025-03-21 14:56:44,427:INFO:   <<< freeze_layer_num: 0
2025-03-21 14:56:44,427:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 14:56:44,427:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 14:56:44,427:INFO:   <<< init_model: None
2025-03-21 14:56:44,427:INFO:   <<< linear_patch: 2d
2025-03-21 14:56:44,427:INFO:   <<< local_rank: 0
2025-03-21 14:56:44,427:INFO:   <<< loose_type: True
2025-03-21 14:56:44,427:INFO:   <<< lr: 0.0001
2025-03-21 14:56:44,427:INFO:   <<< lr_decay: 0.9
2025-03-21 14:56:44,427:INFO:   <<< margin: 0.1
2025-03-21 14:56:44,427:INFO:   <<< max_frames: 12
2025-03-21 14:56:44,427:INFO:   <<< max_words: 32
2025-03-21 14:56:44,427:INFO:   <<< n_display: 50
2025-03-21 14:56:44,427:INFO:   <<< n_gpu: 1
2025-03-21 14:56:44,427:INFO:   <<< n_pair: 1
2025-03-21 14:56:44,427:INFO:   <<< negative_weighting: 1
2025-03-21 14:56:44,427:INFO:   <<< num_thread_reader: 1
2025-03-21 14:56:44,427:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 14:56:44,427:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 14:56:44,427:INFO:   <<< rank: 0
2025-03-21 14:56:44,427:INFO:   <<< resume_model: None
2025-03-21 14:56:44,428:INFO:   <<< sampled_use_mil: False
2025-03-21 14:56:44,428:INFO:   <<< seed: 42
2025-03-21 14:56:44,428:INFO:   <<< sim_header: seqTransf
2025-03-21 14:56:44,428:INFO:   <<< slice_framepos: 2
2025-03-21 14:56:44,428:INFO:   <<< task_type: retrieval
2025-03-21 14:56:44,428:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 14:56:44,428:INFO:   <<< train_csv: data/.train.csv
2025-03-21 14:56:44,428:INFO:   <<< train_frame_order: 0
2025-03-21 14:56:44,428:INFO:   <<< use_mil: False
2025-03-21 14:56:44,428:INFO:   <<< val_csv: data/.val.csv
2025-03-21 14:56:44,428:INFO:   <<< video_dim: 1024
2025-03-21 14:56:44,428:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 14:56:44,428:INFO:   <<< warmup_proportion: 0.1
2025-03-21 14:56:44,428:INFO:   <<< world_size: 1
2025-03-21 14:56:44,428:INFO: device: cuda:0 n_gpu: 1
2025-03-21 14:56:46,668:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 14:56:46,670:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 14:56:46,670:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 14:56:46,670:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 14:56:46,670:WARNING: Test retrieval by loose type.
2025-03-21 14:56:46,671:WARNING: 	 embed_dim: 512
2025-03-21 14:56:46,671:WARNING: 	 image_resolution: 224
2025-03-21 14:56:46,671:WARNING: 	 vision_layers: 12
2025-03-21 14:56:46,671:WARNING: 	 vision_width: 768
2025-03-21 14:56:46,671:WARNING: 	 vision_patch_size: 16
2025-03-21 14:56:46,671:WARNING: 	 context_length: 77
2025-03-21 14:56:46,671:WARNING: 	 vocab_size: 49408
2025-03-21 14:56:46,671:WARNING: 	 transformer_width: 512
2025-03-21 14:56:46,671:WARNING: 	 transformer_heads: 8
2025-03-21 14:56:46,671:WARNING: 	 transformer_layers: 12
2025-03-21 14:56:46,671:WARNING: 		 linear_patch: 2d
2025-03-21 14:56:46,671:WARNING: 	 cut_top_layer: 0
2025-03-21 14:56:50,381:WARNING: 	 sim_header: seqTransf
2025-03-21 14:57:01,289:INFO: --------------------
2025-03-21 14:57:01,290:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 14:57:01,290:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 14:57:12,856:INFO: ***** Running test *****
2025-03-21 14:57:12,856:INFO:   Num examples = 60000
2025-03-21 14:57:12,856:INFO:   Batch size = 64
2025-03-21 14:57:12,857:INFO:   Num steps = 938
2025-03-21 14:57:12,857:INFO: ***** Running val *****
2025-03-21 14:57:12,857:INFO:   Num examples = 30000
2025-03-21 14:57:32,296:INFO: ***** Running training *****
2025-03-21 14:57:32,296:INFO:   Num examples = 259910
2025-03-21 14:57:32,296:INFO:   Batch size = 16
2025-03-21 14:57:32,296:INFO:   Num steps = 81220
2025-03-21 15:22:34,255:INFO: Effective parameters:
2025-03-21 15:22:34,255:INFO:   <<< batch_size: 16
2025-03-21 15:22:34,255:INFO:   <<< batch_size_val: 64
2025-03-21 15:22:34,255:INFO:   <<< cache_dir: 
2025-03-21 15:22:34,255:INFO:   <<< coef_lr: 0.001
2025-03-21 15:22:34,255:INFO:   <<< cross_model: cross-base
2025-03-21 15:22:34,256:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:22:34,256:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:22:34,256:INFO:   <<< datatype: vatex
2025-03-21 15:22:34,256:INFO:   <<< do_eval: False
2025-03-21 15:22:34,256:INFO:   <<< do_lower_case: False
2025-03-21 15:22:34,256:INFO:   <<< do_pretrain: False
2025-03-21 15:22:34,256:INFO:   <<< do_train: True
2025-03-21 15:22:34,256:INFO:   <<< epochs: 5
2025-03-21 15:22:34,256:INFO:   <<< eval_frame_order: 0
2025-03-21 15:22:34,256:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:22:34,256:INFO:   <<< feature_framerate: 1
2025-03-21 15:22:34,256:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:22:34,256:INFO:   <<< fp16: True
2025-03-21 15:22:34,256:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:22:34,256:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:22:34,256:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:22:34,256:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:22:34,256:INFO:   <<< init_model: None
2025-03-21 15:22:34,256:INFO:   <<< linear_patch: 2d
2025-03-21 15:22:34,256:INFO:   <<< local_rank: 0
2025-03-21 15:22:34,256:INFO:   <<< loose_type: True
2025-03-21 15:22:34,256:INFO:   <<< lr: 0.0001
2025-03-21 15:22:34,257:INFO:   <<< lr_decay: 0.9
2025-03-21 15:22:34,257:INFO:   <<< margin: 0.1
2025-03-21 15:22:34,257:INFO:   <<< max_frames: 12
2025-03-21 15:22:34,257:INFO:   <<< max_words: 32
2025-03-21 15:22:34,257:INFO:   <<< n_display: 50
2025-03-21 15:22:34,257:INFO:   <<< n_gpu: 2
2025-03-21 15:22:34,257:INFO:   <<< n_pair: 1
2025-03-21 15:22:34,257:INFO:   <<< negative_weighting: 1
2025-03-21 15:22:34,257:INFO:   <<< num_thread_reader: 2
2025-03-21 15:22:34,257:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:22:34,257:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:22:34,257:INFO:   <<< rank: 1
2025-03-21 15:22:34,257:INFO:   <<< resume_model: None
2025-03-21 15:22:34,257:INFO:   <<< sampled_use_mil: False
2025-03-21 15:22:34,257:INFO:   <<< seed: 42
2025-03-21 15:22:34,257:INFO:   <<< sim_header: seqTransf
2025-03-21 15:22:34,257:INFO:   <<< slice_framepos: 2
2025-03-21 15:22:34,257:INFO:   <<< task_type: retrieval
2025-03-21 15:22:34,257:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:22:34,257:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:22:34,257:INFO:   <<< train_frame_order: 0
2025-03-21 15:22:34,257:INFO:   <<< use_mil: False
2025-03-21 15:22:34,257:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:22:34,258:INFO:   <<< video_dim: 1024
2025-03-21 15:22:34,258:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:22:34,258:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:22:34,258:INFO:   <<< world_size: 2
2025-03-21 15:22:34,258:INFO: device: cuda:0 n_gpu: 1 distributed training: True
2025-03-21 15:22:34,259:INFO: Effective parameters:
2025-03-21 15:22:34,259:INFO:   <<< batch_size: 16
2025-03-21 15:22:34,259:INFO:   <<< batch_size_val: 64
2025-03-21 15:22:34,259:INFO:   <<< cache_dir: 
2025-03-21 15:22:34,259:INFO:   <<< coef_lr: 0.001
2025-03-21 15:22:34,259:INFO:   <<< cross_model: cross-base
2025-03-21 15:22:34,259:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:22:34,259:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:22:34,259:INFO:   <<< datatype: vatex
2025-03-21 15:22:34,259:INFO:   <<< do_eval: False
2025-03-21 15:22:34,259:INFO:   <<< do_lower_case: False
2025-03-21 15:22:34,259:INFO:   <<< do_pretrain: False
2025-03-21 15:22:34,259:INFO:   <<< do_train: True
2025-03-21 15:22:34,260:INFO:   <<< epochs: 5
2025-03-21 15:22:34,260:INFO:   <<< eval_frame_order: 0
2025-03-21 15:22:34,260:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:22:34,260:INFO:   <<< feature_framerate: 1
2025-03-21 15:22:34,260:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:22:34,260:INFO:   <<< fp16: True
2025-03-21 15:22:34,260:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:22:34,260:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:22:34,260:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:22:34,260:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:22:34,260:INFO:   <<< init_model: None
2025-03-21 15:22:34,260:INFO:   <<< linear_patch: 2d
2025-03-21 15:22:34,260:INFO:   <<< local_rank: 0
2025-03-21 15:22:34,260:INFO:   <<< loose_type: True
2025-03-21 15:22:34,260:INFO:   <<< lr: 0.0001
2025-03-21 15:22:34,260:INFO:   <<< lr_decay: 0.9
2025-03-21 15:22:34,260:INFO:   <<< margin: 0.1
2025-03-21 15:22:34,260:INFO:   <<< max_frames: 12
2025-03-21 15:22:34,260:INFO:   <<< max_words: 32
2025-03-21 15:22:34,260:INFO:   <<< n_display: 50
2025-03-21 15:22:34,260:INFO:   <<< n_gpu: 2
2025-03-21 15:22:34,261:INFO:   <<< n_pair: 1
2025-03-21 15:22:34,261:INFO:   <<< negative_weighting: 1
2025-03-21 15:22:34,261:INFO:   <<< num_thread_reader: 2
2025-03-21 15:22:34,261:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:22:34,261:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:22:34,261:INFO:   <<< rank: 0
2025-03-21 15:22:34,261:INFO:   <<< resume_model: None
2025-03-21 15:22:34,261:INFO:   <<< sampled_use_mil: False
2025-03-21 15:22:34,261:INFO:   <<< seed: 42
2025-03-21 15:22:34,261:INFO:   <<< sim_header: seqTransf
2025-03-21 15:22:34,261:INFO:   <<< slice_framepos: 2
2025-03-21 15:22:34,261:INFO:   <<< task_type: retrieval
2025-03-21 15:22:34,261:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:22:34,261:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:22:34,261:INFO:   <<< train_frame_order: 0
2025-03-21 15:22:34,261:INFO:   <<< use_mil: False
2025-03-21 15:22:34,261:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:22:34,261:INFO:   <<< video_dim: 1024
2025-03-21 15:22:34,261:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:22:34,261:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:22:34,261:INFO:   <<< world_size: 2
2025-03-21 15:22:34,262:INFO: device: cuda:0 n_gpu: 1 distributed training: True
2025-03-21 15:22:36,139:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:22:36,140:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:22:36,140:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:22:36,140:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:22:36,140:WARNING: Test retrieval by loose type.
2025-03-21 15:22:36,141:WARNING: 	 embed_dim: 512
2025-03-21 15:22:36,141:WARNING: 	 image_resolution: 224
2025-03-21 15:22:36,141:WARNING: 	 vision_layers: 12
2025-03-21 15:22:36,141:WARNING: 	 vision_width: 768
2025-03-21 15:22:36,141:WARNING: 	 vision_patch_size: 16
2025-03-21 15:22:36,141:WARNING: 	 context_length: 77
2025-03-21 15:22:36,141:WARNING: 	 vocab_size: 49408
2025-03-21 15:22:36,141:WARNING: 	 transformer_width: 512
2025-03-21 15:22:36,141:WARNING: 	 transformer_heads: 8
2025-03-21 15:22:36,141:WARNING: 	 transformer_layers: 12
2025-03-21 15:22:36,141:WARNING: 		 linear_patch: 2d
2025-03-21 15:22:36,141:WARNING: 	 cut_top_layer: 0
2025-03-21 15:22:36,164:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:22:36,165:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:22:36,165:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:22:36,165:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:22:36,165:WARNING: Test retrieval by loose type.
2025-03-21 15:22:36,166:WARNING: 	 embed_dim: 512
2025-03-21 15:22:36,166:WARNING: 	 image_resolution: 224
2025-03-21 15:22:36,166:WARNING: 	 vision_layers: 12
2025-03-21 15:22:36,166:WARNING: 	 vision_width: 768
2025-03-21 15:22:36,166:WARNING: 	 vision_patch_size: 16
2025-03-21 15:22:36,166:WARNING: 	 context_length: 77
2025-03-21 15:22:36,166:WARNING: 	 vocab_size: 49408
2025-03-21 15:22:36,166:WARNING: 	 transformer_width: 512
2025-03-21 15:22:36,166:WARNING: 	 transformer_heads: 8
2025-03-21 15:22:36,166:WARNING: 	 transformer_layers: 12
2025-03-21 15:22:36,166:WARNING: 		 linear_patch: 2d
2025-03-21 15:22:36,166:WARNING: 	 cut_top_layer: 0
2025-03-21 15:22:39,756:WARNING: 	 sim_header: seqTransf
2025-03-21 15:22:39,768:WARNING: 	 sim_header: seqTransf
2025-03-21 15:22:50,572:INFO: --------------------
2025-03-21 15:22:50,572:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:22:50,572:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:22:50,609:INFO: --------------------
2025-03-21 15:22:50,610:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:22:50,610:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:23:02,702:INFO: ***** Running test *****
2025-03-21 15:23:02,703:INFO:   Num examples = 60000
2025-03-21 15:23:02,703:INFO:   Batch size = 64
2025-03-21 15:23:02,703:INFO:   Num steps = 938
2025-03-21 15:23:02,703:INFO: ***** Running val *****
2025-03-21 15:23:02,703:INFO:   Num examples = 30000
2025-03-21 15:23:02,707:INFO: ***** Running test *****
2025-03-21 15:23:02,707:INFO:   Num examples = 60000
2025-03-21 15:23:02,707:INFO:   Batch size = 64
2025-03-21 15:23:02,707:INFO:   Num steps = 938
2025-03-21 15:23:02,707:INFO: ***** Running val *****
2025-03-21 15:23:02,707:INFO:   Num examples = 30000
2025-03-21 15:26:38,825:INFO: Effective parameters:
2025-03-21 15:26:38,825:INFO:   <<< batch_size: 16
2025-03-21 15:26:38,826:INFO:   <<< batch_size_val: 64
2025-03-21 15:26:38,826:INFO:   <<< cache_dir: 
2025-03-21 15:26:38,826:INFO:   <<< coef_lr: 0.001
2025-03-21 15:26:38,826:INFO:   <<< cross_model: cross-base
2025-03-21 15:26:38,826:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:26:38,826:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:26:38,826:INFO:   <<< datatype: vatex
2025-03-21 15:26:38,826:INFO:   <<< do_eval: False
2025-03-21 15:26:38,826:INFO:   <<< do_lower_case: False
2025-03-21 15:26:38,826:INFO:   <<< do_pretrain: False
2025-03-21 15:26:38,826:INFO:   <<< do_train: True
2025-03-21 15:26:38,826:INFO:   <<< epochs: 5
2025-03-21 15:26:38,826:INFO:   <<< eval_frame_order: 0
2025-03-21 15:26:38,826:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:26:38,826:INFO:   <<< feature_framerate: 1
2025-03-21 15:26:38,826:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:26:38,826:INFO:   <<< fp16: True
2025-03-21 15:26:38,826:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:26:38,826:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:26:38,826:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:26:38,827:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:26:38,827:INFO:   <<< init_model: None
2025-03-21 15:26:38,827:INFO:   <<< linear_patch: 2d
2025-03-21 15:26:38,827:INFO:   <<< local_rank: 0
2025-03-21 15:26:38,827:INFO:   <<< loose_type: True
2025-03-21 15:26:38,827:INFO:   <<< lr: 0.0001
2025-03-21 15:26:38,827:INFO:   <<< lr_decay: 0.9
2025-03-21 15:26:38,827:INFO:   <<< margin: 0.1
2025-03-21 15:26:38,827:INFO:   <<< max_frames: 12
2025-03-21 15:26:38,827:INFO:   <<< max_words: 32
2025-03-21 15:26:38,827:INFO:   <<< n_display: 50
2025-03-21 15:26:38,827:INFO:   <<< n_gpu: 2
2025-03-21 15:26:38,827:INFO:   <<< n_pair: 1
2025-03-21 15:26:38,827:INFO:   <<< negative_weighting: 1
2025-03-21 15:26:38,827:INFO:   <<< num_thread_reader: 2
2025-03-21 15:26:38,827:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:26:38,827:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:26:38,827:INFO:   <<< rank: 1
2025-03-21 15:26:38,827:INFO:   <<< resume_model: None
2025-03-21 15:26:38,827:INFO:   <<< sampled_use_mil: False
2025-03-21 15:26:38,827:INFO:   <<< seed: 42
2025-03-21 15:26:38,827:INFO:   <<< sim_header: seqTransf
2025-03-21 15:26:38,827:INFO:   <<< slice_framepos: 2
2025-03-21 15:26:38,828:INFO:   <<< task_type: retrieval
2025-03-21 15:26:38,828:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:26:38,828:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:26:38,828:INFO:   <<< train_frame_order: 0
2025-03-21 15:26:38,828:INFO:   <<< use_mil: False
2025-03-21 15:26:38,828:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:26:38,828:INFO:   <<< video_dim: 1024
2025-03-21 15:26:38,828:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:26:38,828:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:26:38,828:INFO:   <<< world_size: 2
2025-03-21 15:26:38,828:INFO: device: cuda:0 n_gpu: 2
2025-03-21 15:26:38,830:INFO: Effective parameters:
2025-03-21 15:26:38,830:INFO:   <<< batch_size: 16
2025-03-21 15:26:38,830:INFO:   <<< batch_size_val: 64
2025-03-21 15:26:38,830:INFO:   <<< cache_dir: 
2025-03-21 15:26:38,830:INFO:   <<< coef_lr: 0.001
2025-03-21 15:26:38,830:INFO:   <<< cross_model: cross-base
2025-03-21 15:26:38,830:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:26:38,830:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:26:38,830:INFO:   <<< datatype: vatex
2025-03-21 15:26:38,830:INFO:   <<< do_eval: False
2025-03-21 15:26:38,830:INFO:   <<< do_lower_case: False
2025-03-21 15:26:38,830:INFO:   <<< do_pretrain: False
2025-03-21 15:26:38,830:INFO:   <<< do_train: True
2025-03-21 15:26:38,831:INFO:   <<< epochs: 5
2025-03-21 15:26:38,831:INFO:   <<< eval_frame_order: 0
2025-03-21 15:26:38,831:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:26:38,831:INFO:   <<< feature_framerate: 1
2025-03-21 15:26:38,831:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:26:38,831:INFO:   <<< fp16: True
2025-03-21 15:26:38,831:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:26:38,831:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:26:38,831:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:26:38,831:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:26:38,831:INFO:   <<< init_model: None
2025-03-21 15:26:38,831:INFO:   <<< linear_patch: 2d
2025-03-21 15:26:38,831:INFO:   <<< local_rank: 0
2025-03-21 15:26:38,831:INFO:   <<< loose_type: True
2025-03-21 15:26:38,831:INFO:   <<< lr: 0.0001
2025-03-21 15:26:38,831:INFO:   <<< lr_decay: 0.9
2025-03-21 15:26:38,831:INFO:   <<< margin: 0.1
2025-03-21 15:26:38,831:INFO:   <<< max_frames: 12
2025-03-21 15:26:38,831:INFO:   <<< max_words: 32
2025-03-21 15:26:38,831:INFO:   <<< n_display: 50
2025-03-21 15:26:38,831:INFO:   <<< n_gpu: 2
2025-03-21 15:26:38,832:INFO:   <<< n_pair: 1
2025-03-21 15:26:38,832:INFO:   <<< negative_weighting: 1
2025-03-21 15:26:38,832:INFO:   <<< num_thread_reader: 2
2025-03-21 15:26:38,832:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:26:38,832:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:26:38,832:INFO:   <<< rank: 0
2025-03-21 15:26:38,832:INFO:   <<< resume_model: None
2025-03-21 15:26:38,832:INFO:   <<< sampled_use_mil: False
2025-03-21 15:26:38,832:INFO:   <<< seed: 42
2025-03-21 15:26:38,832:INFO:   <<< sim_header: seqTransf
2025-03-21 15:26:38,832:INFO:   <<< slice_framepos: 2
2025-03-21 15:26:38,832:INFO:   <<< task_type: retrieval
2025-03-21 15:26:38,832:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:26:38,832:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:26:38,832:INFO:   <<< train_frame_order: 0
2025-03-21 15:26:38,832:INFO:   <<< use_mil: False
2025-03-21 15:26:38,832:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:26:38,832:INFO:   <<< video_dim: 1024
2025-03-21 15:26:38,832:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:26:38,832:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:26:38,832:INFO:   <<< world_size: 2
2025-03-21 15:26:38,833:INFO: device: cuda:0 n_gpu: 2
2025-03-21 15:26:40,717:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:26:40,718:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:26:40,719:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:26:40,719:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:26:40,719:WARNING: Test retrieval by loose type.
2025-03-21 15:26:40,720:WARNING: 	 embed_dim: 512
2025-03-21 15:26:40,720:WARNING: 	 image_resolution: 224
2025-03-21 15:26:40,720:WARNING: 	 vision_layers: 12
2025-03-21 15:26:40,720:WARNING: 	 vision_width: 768
2025-03-21 15:26:40,721:WARNING: 	 vision_patch_size: 16
2025-03-21 15:26:40,721:WARNING: 	 context_length: 77
2025-03-21 15:26:40,721:WARNING: 	 vocab_size: 49408
2025-03-21 15:26:40,721:WARNING: 	 transformer_width: 512
2025-03-21 15:26:40,721:WARNING: 	 transformer_heads: 8
2025-03-21 15:26:40,721:WARNING: 	 transformer_layers: 12
2025-03-21 15:26:40,721:WARNING: 		 linear_patch: 2d
2025-03-21 15:26:40,721:WARNING: 	 cut_top_layer: 0
2025-03-21 15:26:40,732:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:26:40,732:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:26:40,733:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:26:40,733:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:26:40,733:WARNING: Test retrieval by loose type.
2025-03-21 15:26:40,733:WARNING: 	 embed_dim: 512
2025-03-21 15:26:40,733:WARNING: 	 image_resolution: 224
2025-03-21 15:26:40,733:WARNING: 	 vision_layers: 12
2025-03-21 15:26:40,733:WARNING: 	 vision_width: 768
2025-03-21 15:26:40,734:WARNING: 	 vision_patch_size: 16
2025-03-21 15:26:40,734:WARNING: 	 context_length: 77
2025-03-21 15:26:40,734:WARNING: 	 vocab_size: 49408
2025-03-21 15:26:40,734:WARNING: 	 transformer_width: 512
2025-03-21 15:26:40,734:WARNING: 	 transformer_heads: 8
2025-03-21 15:26:40,734:WARNING: 	 transformer_layers: 12
2025-03-21 15:26:40,734:WARNING: 		 linear_patch: 2d
2025-03-21 15:26:40,734:WARNING: 	 cut_top_layer: 0
2025-03-21 15:26:44,272:WARNING: 	 sim_header: seqTransf
2025-03-21 15:26:44,287:WARNING: 	 sim_header: seqTransf
2025-03-21 15:26:55,095:INFO: --------------------
2025-03-21 15:26:55,096:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:26:55,096:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:26:55,123:INFO: --------------------
2025-03-21 15:26:55,123:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:26:55,123:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:27:07,180:INFO: ***** Running test *****
2025-03-21 15:27:07,181:INFO:   Num examples = 60000
2025-03-21 15:27:07,181:INFO:   Batch size = 64
2025-03-21 15:27:07,181:INFO:   Num steps = 938
2025-03-21 15:27:07,181:INFO: ***** Running val *****
2025-03-21 15:27:07,181:INFO:   Num examples = 30000
2025-03-21 15:27:07,218:INFO: ***** Running test *****
2025-03-21 15:27:07,218:INFO:   Num examples = 60000
2025-03-21 15:27:07,218:INFO:   Batch size = 64
2025-03-21 15:27:07,218:INFO:   Num steps = 938
2025-03-21 15:27:07,218:INFO: ***** Running val *****
2025-03-21 15:27:07,218:INFO:   Num examples = 30000
2025-03-21 15:35:48,479:INFO: Effective parameters:
2025-03-21 15:35:48,479:INFO:   <<< batch_size: 16
2025-03-21 15:35:48,479:INFO:   <<< batch_size_val: 64
2025-03-21 15:35:48,479:INFO:   <<< cache_dir: 
2025-03-21 15:35:48,479:INFO:   <<< coef_lr: 0.001
2025-03-21 15:35:48,479:INFO:   <<< cross_model: cross-base
2025-03-21 15:35:48,479:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:35:48,479:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:35:48,479:INFO:   <<< datatype: vatex
2025-03-21 15:35:48,479:INFO:   <<< do_eval: False
2025-03-21 15:35:48,479:INFO:   <<< do_lower_case: False
2025-03-21 15:35:48,479:INFO:   <<< do_pretrain: False
2025-03-21 15:35:48,480:INFO:   <<< do_train: True
2025-03-21 15:35:48,480:INFO:   <<< epochs: 5
2025-03-21 15:35:48,480:INFO:   <<< eval_frame_order: 0
2025-03-21 15:35:48,480:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:35:48,480:INFO:   <<< feature_framerate: 1
2025-03-21 15:35:48,480:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:35:48,480:INFO:   <<< fp16: True
2025-03-21 15:35:48,480:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:35:48,480:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:35:48,480:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:35:48,480:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:35:48,480:INFO:   <<< init_model: None
2025-03-21 15:35:48,480:INFO:   <<< linear_patch: 2d
2025-03-21 15:35:48,480:INFO:   <<< local_rank: 0
2025-03-21 15:35:48,480:INFO:   <<< loose_type: True
2025-03-21 15:35:48,480:INFO:   <<< lr: 0.0001
2025-03-21 15:35:48,480:INFO:   <<< lr_decay: 0.9
2025-03-21 15:35:48,480:INFO:   <<< margin: 0.1
2025-03-21 15:35:48,480:INFO:   <<< max_frames: 12
2025-03-21 15:35:48,480:INFO:   <<< max_words: 32
2025-03-21 15:35:48,480:INFO:   <<< n_display: 50
2025-03-21 15:35:48,480:INFO:   <<< n_gpu: 2
2025-03-21 15:35:48,481:INFO:   <<< n_pair: 1
2025-03-21 15:35:48,481:INFO:   <<< negative_weighting: 1
2025-03-21 15:35:48,481:INFO:   <<< num_thread_reader: 2
2025-03-21 15:35:48,481:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:35:48,481:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:35:48,481:INFO:   <<< rank: 1
2025-03-21 15:35:48,481:INFO:   <<< resume_model: None
2025-03-21 15:35:48,481:INFO:   <<< sampled_use_mil: False
2025-03-21 15:35:48,481:INFO:   <<< seed: 42
2025-03-21 15:35:48,481:INFO:   <<< sim_header: seqTransf
2025-03-21 15:35:48,481:INFO:   <<< slice_framepos: 2
2025-03-21 15:35:48,481:INFO:   <<< task_type: retrieval
2025-03-21 15:35:48,481:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:35:48,481:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:35:48,481:INFO:   <<< train_frame_order: 0
2025-03-21 15:35:48,481:INFO:   <<< use_mil: False
2025-03-21 15:35:48,481:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:35:48,481:INFO:   <<< video_dim: 1024
2025-03-21 15:35:48,481:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:35:48,481:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:35:48,481:INFO:   <<< world_size: 2
2025-03-21 15:35:48,481:INFO: device: cuda:0 n_gpu: 2
2025-03-21 15:35:48,482:INFO: Effective parameters:
2025-03-21 15:35:48,482:INFO:   <<< batch_size: 16
2025-03-21 15:35:48,482:INFO:   <<< batch_size_val: 64
2025-03-21 15:35:48,482:INFO:   <<< cache_dir: 
2025-03-21 15:35:48,482:INFO:   <<< coef_lr: 0.001
2025-03-21 15:35:48,482:INFO:   <<< cross_model: cross-base
2025-03-21 15:35:48,483:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:35:48,483:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:35:48,483:INFO:   <<< datatype: vatex
2025-03-21 15:35:48,483:INFO:   <<< do_eval: False
2025-03-21 15:35:48,483:INFO:   <<< do_lower_case: False
2025-03-21 15:35:48,483:INFO:   <<< do_pretrain: False
2025-03-21 15:35:48,483:INFO:   <<< do_train: True
2025-03-21 15:35:48,483:INFO:   <<< epochs: 5
2025-03-21 15:35:48,483:INFO:   <<< eval_frame_order: 0
2025-03-21 15:35:48,483:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:35:48,483:INFO:   <<< feature_framerate: 1
2025-03-21 15:35:48,483:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:35:48,483:INFO:   <<< fp16: True
2025-03-21 15:35:48,483:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:35:48,483:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:35:48,483:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:35:48,483:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:35:48,483:INFO:   <<< init_model: None
2025-03-21 15:35:48,483:INFO:   <<< linear_patch: 2d
2025-03-21 15:35:48,483:INFO:   <<< local_rank: 0
2025-03-21 15:35:48,483:INFO:   <<< loose_type: True
2025-03-21 15:35:48,483:INFO:   <<< lr: 0.0001
2025-03-21 15:35:48,484:INFO:   <<< lr_decay: 0.9
2025-03-21 15:35:48,484:INFO:   <<< margin: 0.1
2025-03-21 15:35:48,484:INFO:   <<< max_frames: 12
2025-03-21 15:35:48,484:INFO:   <<< max_words: 32
2025-03-21 15:35:48,484:INFO:   <<< n_display: 50
2025-03-21 15:35:48,484:INFO:   <<< n_gpu: 2
2025-03-21 15:35:48,484:INFO:   <<< n_pair: 1
2025-03-21 15:35:48,484:INFO:   <<< negative_weighting: 1
2025-03-21 15:35:48,484:INFO:   <<< num_thread_reader: 2
2025-03-21 15:35:48,484:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:35:48,484:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:35:48,484:INFO:   <<< rank: 0
2025-03-21 15:35:48,484:INFO:   <<< resume_model: None
2025-03-21 15:35:48,484:INFO:   <<< sampled_use_mil: False
2025-03-21 15:35:48,484:INFO:   <<< seed: 42
2025-03-21 15:35:48,484:INFO:   <<< sim_header: seqTransf
2025-03-21 15:35:48,484:INFO:   <<< slice_framepos: 2
2025-03-21 15:35:48,484:INFO:   <<< task_type: retrieval
2025-03-21 15:35:48,484:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:35:48,484:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:35:48,484:INFO:   <<< train_frame_order: 0
2025-03-21 15:35:48,484:INFO:   <<< use_mil: False
2025-03-21 15:35:48,484:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:35:48,485:INFO:   <<< video_dim: 1024
2025-03-21 15:35:48,485:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:35:48,485:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:35:48,485:INFO:   <<< world_size: 2
2025-03-21 15:35:48,485:INFO: device: cuda:0 n_gpu: 2
2025-03-21 15:35:50,332:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:35:50,333:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:35:50,333:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:35:50,333:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:35:50,333:WARNING: Test retrieval by loose type.
2025-03-21 15:35:50,334:WARNING: 	 embed_dim: 512
2025-03-21 15:35:50,334:WARNING: 	 image_resolution: 224
2025-03-21 15:35:50,334:WARNING: 	 vision_layers: 12
2025-03-21 15:35:50,334:WARNING: 	 vision_width: 768
2025-03-21 15:35:50,334:WARNING: 	 vision_patch_size: 16
2025-03-21 15:35:50,334:WARNING: 	 context_length: 77
2025-03-21 15:35:50,334:WARNING: 	 vocab_size: 49408
2025-03-21 15:35:50,334:WARNING: 	 transformer_width: 512
2025-03-21 15:35:50,334:WARNING: 	 transformer_heads: 8
2025-03-21 15:35:50,334:WARNING: 	 transformer_layers: 12
2025-03-21 15:35:50,334:WARNING: 		 linear_patch: 2d
2025-03-21 15:35:50,334:WARNING: 	 cut_top_layer: 0
2025-03-21 15:35:50,345:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:35:50,345:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:35:50,345:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:35:50,346:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:35:50,346:WARNING: Test retrieval by loose type.
2025-03-21 15:35:50,346:WARNING: 	 embed_dim: 512
2025-03-21 15:35:50,346:WARNING: 	 image_resolution: 224
2025-03-21 15:35:50,346:WARNING: 	 vision_layers: 12
2025-03-21 15:35:50,346:WARNING: 	 vision_width: 768
2025-03-21 15:35:50,346:WARNING: 	 vision_patch_size: 16
2025-03-21 15:35:50,346:WARNING: 	 context_length: 77
2025-03-21 15:35:50,346:WARNING: 	 vocab_size: 49408
2025-03-21 15:35:50,346:WARNING: 	 transformer_width: 512
2025-03-21 15:35:50,346:WARNING: 	 transformer_heads: 8
2025-03-21 15:35:50,346:WARNING: 	 transformer_layers: 12
2025-03-21 15:35:50,347:WARNING: 		 linear_patch: 2d
2025-03-21 15:35:50,347:WARNING: 	 cut_top_layer: 0
2025-03-21 15:35:53,941:WARNING: 	 sim_header: seqTransf
2025-03-21 15:35:53,950:WARNING: 	 sim_header: seqTransf
2025-03-21 15:36:04,780:INFO: --------------------
2025-03-21 15:36:04,780:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:36:04,780:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:36:04,785:INFO: --------------------
2025-03-21 15:36:04,785:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:36:04,785:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:36:16,837:INFO: ***** Running test *****
2025-03-21 15:36:16,838:INFO:   Num examples = 60000
2025-03-21 15:36:16,838:INFO:   Batch size = 64
2025-03-21 15:36:16,838:INFO:   Num steps = 938
2025-03-21 15:36:16,838:INFO: ***** Running val *****
2025-03-21 15:36:16,838:INFO:   Num examples = 30000
2025-03-21 15:36:16,872:INFO: ***** Running test *****
2025-03-21 15:36:16,872:INFO:   Num examples = 60000
2025-03-21 15:36:16,872:INFO:   Batch size = 64
2025-03-21 15:36:16,873:INFO:   Num steps = 938
2025-03-21 15:36:16,873:INFO: ***** Running val *****
2025-03-21 15:36:16,873:INFO:   Num examples = 30000
2025-03-21 15:57:44,074:INFO: Effective parameters:
2025-03-21 15:57:44,074:INFO:   <<< batch_size: 16
2025-03-21 15:57:44,075:INFO:   <<< batch_size_val: 64
2025-03-21 15:57:44,075:INFO:   <<< cache_dir: 
2025-03-21 15:57:44,075:INFO:   <<< coef_lr: 0.001
2025-03-21 15:57:44,075:INFO:   <<< cross_model: cross-base
2025-03-21 15:57:44,075:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 15:57:44,075:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 15:57:44,075:INFO:   <<< datatype: vatex
2025-03-21 15:57:44,075:INFO:   <<< do_eval: False
2025-03-21 15:57:44,075:INFO:   <<< do_lower_case: False
2025-03-21 15:57:44,075:INFO:   <<< do_pretrain: False
2025-03-21 15:57:44,075:INFO:   <<< do_train: True
2025-03-21 15:57:44,075:INFO:   <<< epochs: 5
2025-03-21 15:57:44,075:INFO:   <<< eval_frame_order: 0
2025-03-21 15:57:44,075:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 15:57:44,075:INFO:   <<< feature_framerate: 1
2025-03-21 15:57:44,075:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 15:57:44,075:INFO:   <<< fp16: True
2025-03-21 15:57:44,075:INFO:   <<< fp16_opt_level: O2
2025-03-21 15:57:44,076:INFO:   <<< freeze_layer_num: 0
2025-03-21 15:57:44,076:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 15:57:44,076:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 15:57:44,076:INFO:   <<< init_model: None
2025-03-21 15:57:44,076:INFO:   <<< linear_patch: 2d
2025-03-21 15:57:44,076:INFO:   <<< local_rank: 0
2025-03-21 15:57:44,076:INFO:   <<< loose_type: True
2025-03-21 15:57:44,076:INFO:   <<< lr: 0.0001
2025-03-21 15:57:44,076:INFO:   <<< lr_decay: 0.9
2025-03-21 15:57:44,076:INFO:   <<< margin: 0.1
2025-03-21 15:57:44,076:INFO:   <<< max_frames: 12
2025-03-21 15:57:44,076:INFO:   <<< max_words: 32
2025-03-21 15:57:44,076:INFO:   <<< n_display: 50
2025-03-21 15:57:44,077:INFO:   <<< n_gpu: 2
2025-03-21 15:57:44,077:INFO:   <<< n_pair: 1
2025-03-21 15:57:44,077:INFO:   <<< negative_weighting: 1
2025-03-21 15:57:44,076:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 15:57:44,077:INFO:   <<< num_thread_reader: 2
2025-03-21 15:57:44,077:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 15:57:44,077:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 15:57:44,077:INFO: Total available GPUs: 2
2025-03-21 15:57:44,077:INFO:   <<< rank: 0
2025-03-21 15:57:44,077:INFO:   <<< resume_model: None
2025-03-21 15:57:44,077:INFO: Process 188822 using device: cuda:1, local_rank: 1
2025-03-21 15:57:44,077:INFO:   <<< sampled_use_mil: False
2025-03-21 15:57:44,077:INFO: Current device index: 1
2025-03-21 15:57:44,077:INFO:   <<< seed: 42
2025-03-21 15:57:44,077:INFO:   <<< sim_header: seqTransf
2025-03-21 15:57:44,077:INFO:   <<< slice_framepos: 2
2025-03-21 15:57:44,077:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 15:57:44,077:INFO:   <<< task_type: retrieval
2025-03-21 15:57:44,077:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 15:57:44,077:INFO:   <<< train_csv: data/.train.csv
2025-03-21 15:57:44,077:INFO:   <<< train_frame_order: 0
2025-03-21 15:57:44,077:INFO:   <<< use_mil: False
2025-03-21 15:57:44,077:INFO:   <<< val_csv: data/.val.csv
2025-03-21 15:57:44,077:INFO:   <<< video_dim: 1024
2025-03-21 15:57:44,077:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 15:57:44,077:INFO:   <<< warmup_proportion: 0.1
2025-03-21 15:57:44,078:INFO:   <<< world_size: 2
2025-03-21 15:57:44,078:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 15:57:44,078:INFO: Total available GPUs: 2
2025-03-21 15:57:44,078:INFO: Process 188821 using device: cuda:0, local_rank: 0
2025-03-21 15:57:44,078:INFO: Current device index: 0
2025-03-21 15:57:44,078:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 15:57:45,982:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 15:57:45,983:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 15:57:45,983:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 15:57:45,983:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 15:57:45,983:WARNING: Test retrieval by loose type.
2025-03-21 15:57:45,984:WARNING: 	 embed_dim: 512
2025-03-21 15:57:45,984:WARNING: 	 image_resolution: 224
2025-03-21 15:57:45,984:WARNING: 	 vision_layers: 12
2025-03-21 15:57:45,984:WARNING: 	 vision_width: 768
2025-03-21 15:57:45,984:WARNING: 	 vision_patch_size: 16
2025-03-21 15:57:45,984:WARNING: 	 context_length: 77
2025-03-21 15:57:45,984:WARNING: 	 vocab_size: 49408
2025-03-21 15:57:45,984:WARNING: 	 transformer_width: 512
2025-03-21 15:57:45,984:WARNING: 	 transformer_heads: 8
2025-03-21 15:57:45,984:WARNING: 	 transformer_layers: 12
2025-03-21 15:57:45,984:WARNING: 		 linear_patch: 2d
2025-03-21 15:57:45,984:WARNING: 	 cut_top_layer: 0
2025-03-21 15:57:49,630:WARNING: 	 sim_header: seqTransf
2025-03-21 15:58:00,432:INFO: --------------------
2025-03-21 15:58:00,433:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 15:58:00,433:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 15:58:12,370:INFO: ***** Running test *****
2025-03-21 15:58:12,370:INFO:   Num examples = 60000
2025-03-21 15:58:12,370:INFO:   Batch size = 64
2025-03-21 15:58:12,370:INFO:   Num steps = 938
2025-03-21 15:58:12,370:INFO: ***** Running val *****
2025-03-21 15:58:12,370:INFO:   Num examples = 30000
2025-03-21 15:58:31,530:INFO: ***** Running training *****
2025-03-21 15:58:31,531:INFO:   Num examples = 259910
2025-03-21 15:58:31,531:INFO:   Batch size = 16
2025-03-21 15:58:31,531:INFO:   Num steps = 81220
2025-03-21 16:06:54,147:INFO: Effective parameters:
2025-03-21 16:06:54,147:INFO:   <<< batch_size: 16
2025-03-21 16:06:54,147:INFO:   <<< batch_size_val: 64
2025-03-21 16:06:54,147:INFO:   <<< cache_dir: 
2025-03-21 16:06:54,148:INFO:   <<< coef_lr: 0.001
2025-03-21 16:06:54,148:INFO:   <<< cross_model: cross-base
2025-03-21 16:06:54,148:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 16:06:54,148:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 16:06:54,148:INFO:   <<< datatype: vatex
2025-03-21 16:06:54,148:INFO:   <<< do_eval: False
2025-03-21 16:06:54,148:INFO:   <<< do_lower_case: False
2025-03-21 16:06:54,148:INFO:   <<< do_pretrain: False
2025-03-21 16:06:54,148:INFO:   <<< do_train: True
2025-03-21 16:06:54,148:INFO:   <<< epochs: 5
2025-03-21 16:06:54,148:INFO:   <<< eval_frame_order: 0
2025-03-21 16:06:54,148:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 16:06:54,148:INFO:   <<< feature_framerate: 1
2025-03-21 16:06:54,148:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 16:06:54,148:INFO:   <<< fp16: True
2025-03-21 16:06:54,148:INFO:   <<< fp16_opt_level: O2
2025-03-21 16:06:54,148:INFO:   <<< freeze_layer_num: 0
2025-03-21 16:06:54,148:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 16:06:54,148:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 16:06:54,148:INFO:   <<< init_model: None
2025-03-21 16:06:54,149:INFO:   <<< linear_patch: 2d
2025-03-21 16:06:54,149:INFO:   <<< local_rank: 0
2025-03-21 16:06:54,149:INFO:   <<< loose_type: True
2025-03-21 16:06:54,149:INFO:   <<< lr: 0.0001
2025-03-21 16:06:54,149:INFO:   <<< lr_decay: 0.9
2025-03-21 16:06:54,149:INFO:   <<< margin: 0.1
2025-03-21 16:06:54,149:INFO:   <<< max_frames: 12
2025-03-21 16:06:54,149:INFO:   <<< max_words: 32
2025-03-21 16:06:54,149:INFO:   <<< n_display: 50
2025-03-21 16:06:54,149:INFO:   <<< n_gpu: 2
2025-03-21 16:06:54,149:INFO:   <<< n_pair: 1
2025-03-21 16:06:54,149:INFO:   <<< negative_weighting: 1
2025-03-21 16:06:54,149:INFO:   <<< num_thread_reader: 2
2025-03-21 16:06:54,149:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 16:06:54,149:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 16:06:54,149:INFO:   <<< rank: 1
2025-03-21 16:06:54,149:INFO:   <<< resume_model: None
2025-03-21 16:06:54,149:INFO:   <<< sampled_use_mil: False
2025-03-21 16:06:54,149:INFO:   <<< seed: 42
2025-03-21 16:06:54,149:INFO:   <<< sim_header: seqTransf
2025-03-21 16:06:54,149:INFO:   <<< slice_framepos: 2
2025-03-21 16:06:54,150:INFO:   <<< task_type: retrieval
2025-03-21 16:06:54,150:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 16:06:54,150:INFO:   <<< train_csv: data/.train.csv
2025-03-21 16:06:54,150:INFO:   <<< train_frame_order: 0
2025-03-21 16:06:54,150:INFO:   <<< use_mil: False
2025-03-21 16:06:54,150:INFO:   <<< val_csv: data/.val.csv
2025-03-21 16:06:54,150:INFO:   <<< video_dim: 1024
2025-03-21 16:06:54,150:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 16:06:54,150:INFO:   <<< warmup_proportion: 0.1
2025-03-21 16:06:54,150:INFO:   <<< world_size: 2
2025-03-21 16:06:54,150:INFO: device: cuda:0 n_gpu: 2
2025-03-21 16:06:54,229:INFO: Effective parameters:
2025-03-21 16:06:54,229:INFO:   <<< batch_size: 16
2025-03-21 16:06:54,229:INFO:   <<< batch_size_val: 64
2025-03-21 16:06:54,229:INFO:   <<< cache_dir: 
2025-03-21 16:06:54,229:INFO:   <<< coef_lr: 0.001
2025-03-21 16:06:54,229:INFO:   <<< cross_model: cross-base
2025-03-21 16:06:54,229:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 16:06:54,229:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 16:06:54,229:INFO:   <<< datatype: vatex
2025-03-21 16:06:54,229:INFO:   <<< do_eval: False
2025-03-21 16:06:54,229:INFO:   <<< do_lower_case: False
2025-03-21 16:06:54,229:INFO:   <<< do_pretrain: False
2025-03-21 16:06:54,229:INFO:   <<< do_train: True
2025-03-21 16:06:54,229:INFO:   <<< epochs: 5
2025-03-21 16:06:54,230:INFO:   <<< eval_frame_order: 0
2025-03-21 16:06:54,230:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 16:06:54,230:INFO:   <<< feature_framerate: 1
2025-03-21 16:06:54,230:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 16:06:54,230:INFO:   <<< fp16: True
2025-03-21 16:06:54,230:INFO:   <<< fp16_opt_level: O2
2025-03-21 16:06:54,230:INFO:   <<< freeze_layer_num: 0
2025-03-21 16:06:54,230:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 16:06:54,230:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 16:06:54,230:INFO:   <<< init_model: None
2025-03-21 16:06:54,230:INFO:   <<< linear_patch: 2d
2025-03-21 16:06:54,230:INFO:   <<< local_rank: 0
2025-03-21 16:06:54,230:INFO:   <<< loose_type: True
2025-03-21 16:06:54,230:INFO:   <<< lr: 0.0001
2025-03-21 16:06:54,230:INFO:   <<< lr_decay: 0.9
2025-03-21 16:06:54,230:INFO:   <<< margin: 0.1
2025-03-21 16:06:54,230:INFO:   <<< max_frames: 12
2025-03-21 16:06:54,230:INFO:   <<< max_words: 32
2025-03-21 16:06:54,230:INFO:   <<< n_display: 50
2025-03-21 16:06:54,230:INFO:   <<< n_gpu: 2
2025-03-21 16:06:54,230:INFO:   <<< n_pair: 1
2025-03-21 16:06:54,231:INFO:   <<< negative_weighting: 1
2025-03-21 16:06:54,231:INFO:   <<< num_thread_reader: 2
2025-03-21 16:06:54,231:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 16:06:54,231:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 16:06:54,231:INFO:   <<< rank: 0
2025-03-21 16:06:54,231:INFO:   <<< resume_model: None
2025-03-21 16:06:54,231:INFO:   <<< sampled_use_mil: False
2025-03-21 16:06:54,231:INFO:   <<< seed: 42
2025-03-21 16:06:54,231:INFO:   <<< sim_header: seqTransf
2025-03-21 16:06:54,231:INFO:   <<< slice_framepos: 2
2025-03-21 16:06:54,231:INFO:   <<< task_type: retrieval
2025-03-21 16:06:54,231:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 16:06:54,231:INFO:   <<< train_csv: data/.train.csv
2025-03-21 16:06:54,231:INFO:   <<< train_frame_order: 0
2025-03-21 16:06:54,231:INFO:   <<< use_mil: False
2025-03-21 16:06:54,231:INFO:   <<< val_csv: data/.val.csv
2025-03-21 16:06:54,231:INFO:   <<< video_dim: 1024
2025-03-21 16:06:54,231:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 16:06:54,231:INFO:   <<< warmup_proportion: 0.1
2025-03-21 16:06:54,231:INFO:   <<< world_size: 2
2025-03-21 16:06:54,231:INFO: device: cuda:0 n_gpu: 2
2025-03-21 16:06:56,055:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 16:06:56,056:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 16:06:56,056:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 16:06:56,056:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 16:06:56,057:WARNING: Test retrieval by loose type.
2025-03-21 16:06:56,057:WARNING: 	 embed_dim: 512
2025-03-21 16:06:56,057:WARNING: 	 image_resolution: 224
2025-03-21 16:06:56,057:WARNING: 	 vision_layers: 12
2025-03-21 16:06:56,057:WARNING: 	 vision_width: 768
2025-03-21 16:06:56,057:WARNING: 	 vision_patch_size: 16
2025-03-21 16:06:56,057:WARNING: 	 context_length: 77
2025-03-21 16:06:56,057:WARNING: 	 vocab_size: 49408
2025-03-21 16:06:56,057:WARNING: 	 transformer_width: 512
2025-03-21 16:06:56,057:WARNING: 	 transformer_heads: 8
2025-03-21 16:06:56,057:WARNING: 	 transformer_layers: 12
2025-03-21 16:06:56,058:WARNING: 		 linear_patch: 2d
2025-03-21 16:06:56,058:WARNING: 	 cut_top_layer: 0
2025-03-21 16:06:56,173:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 16:06:56,174:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 16:06:56,174:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 16:06:56,174:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 16:06:56,174:WARNING: Test retrieval by loose type.
2025-03-21 16:06:56,175:WARNING: 	 embed_dim: 512
2025-03-21 16:06:56,175:WARNING: 	 image_resolution: 224
2025-03-21 16:06:56,175:WARNING: 	 vision_layers: 12
2025-03-21 16:06:56,175:WARNING: 	 vision_width: 768
2025-03-21 16:06:56,175:WARNING: 	 vision_patch_size: 16
2025-03-21 16:06:56,175:WARNING: 	 context_length: 77
2025-03-21 16:06:56,175:WARNING: 	 vocab_size: 49408
2025-03-21 16:06:56,175:WARNING: 	 transformer_width: 512
2025-03-21 16:06:56,175:WARNING: 	 transformer_heads: 8
2025-03-21 16:06:56,175:WARNING: 	 transformer_layers: 12
2025-03-21 16:06:56,175:WARNING: 		 linear_patch: 2d
2025-03-21 16:06:56,175:WARNING: 	 cut_top_layer: 0
2025-03-21 16:06:59,667:WARNING: 	 sim_header: seqTransf
2025-03-21 16:06:59,830:WARNING: 	 sim_header: seqTransf
2025-03-21 16:07:10,505:INFO: --------------------
2025-03-21 16:07:10,506:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 16:07:10,506:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 16:07:10,666:INFO: --------------------
2025-03-21 16:07:10,666:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 16:07:10,667:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 16:07:22,474:INFO: ***** Running test *****
2025-03-21 16:07:22,474:INFO:   Num examples = 60000
2025-03-21 16:07:22,474:INFO:   Batch size = 64
2025-03-21 16:07:22,474:INFO:   Num steps = 938
2025-03-21 16:07:22,474:INFO: ***** Running val *****
2025-03-21 16:07:22,474:INFO:   Num examples = 30000
2025-03-21 16:07:22,597:INFO: ***** Running test *****
2025-03-21 16:07:22,597:INFO:   Num examples = 60000
2025-03-21 16:07:22,597:INFO:   Batch size = 64
2025-03-21 16:07:22,597:INFO:   Num steps = 938
2025-03-21 16:07:22,597:INFO: ***** Running val *****
2025-03-21 16:07:22,597:INFO:   Num examples = 30000
2025-03-21 16:13:05,397:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 16:13:05,397:INFO: Effective parameters:
2025-03-21 16:13:05,397:INFO: Total available GPUs: 2
2025-03-21 16:13:05,397:INFO:   <<< batch_size: 16
2025-03-21 16:13:05,397:INFO: Process 3202451 using device: cuda:1, local_rank: 1
2025-03-21 16:13:05,397:INFO:   <<< batch_size_val: 64
2025-03-21 16:13:05,397:INFO: Current device index: 1
2025-03-21 16:13:05,398:INFO:   <<< cache_dir: 
2025-03-21 16:13:05,398:INFO:   <<< coef_lr: 0.001
2025-03-21 16:13:05,398:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 16:13:05,398:INFO:   <<< cross_model: cross-base
2025-03-21 16:13:05,398:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 16:13:05,398:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 16:13:05,398:INFO:   <<< datatype: vatex
2025-03-21 16:13:05,398:INFO:   <<< do_eval: False
2025-03-21 16:13:05,398:INFO:   <<< do_lower_case: False
2025-03-21 16:13:05,398:INFO:   <<< do_pretrain: False
2025-03-21 16:13:05,398:INFO:   <<< do_train: True
2025-03-21 16:13:05,398:INFO:   <<< epochs: 5
2025-03-21 16:13:05,398:INFO:   <<< eval_frame_order: 0
2025-03-21 16:13:05,398:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 16:13:05,398:INFO:   <<< feature_framerate: 1
2025-03-21 16:13:05,398:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 16:13:05,398:INFO:   <<< fp16: True
2025-03-21 16:13:05,398:INFO:   <<< fp16_opt_level: O2
2025-03-21 16:13:05,398:INFO:   <<< freeze_layer_num: 0
2025-03-21 16:13:05,398:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 16:13:05,399:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 16:13:05,399:INFO:   <<< init_model: None
2025-03-21 16:13:05,399:INFO:   <<< linear_patch: 2d
2025-03-21 16:13:05,399:INFO:   <<< local_rank: 0
2025-03-21 16:13:05,399:INFO:   <<< loose_type: True
2025-03-21 16:13:05,399:INFO:   <<< lr: 0.0001
2025-03-21 16:13:05,399:INFO:   <<< lr_decay: 0.9
2025-03-21 16:13:05,399:INFO:   <<< margin: 0.1
2025-03-21 16:13:05,399:INFO:   <<< max_frames: 12
2025-03-21 16:13:05,399:INFO:   <<< max_words: 32
2025-03-21 16:13:05,399:INFO:   <<< n_display: 50
2025-03-21 16:13:05,399:INFO:   <<< n_gpu: 2
2025-03-21 16:13:05,399:INFO:   <<< n_pair: 1
2025-03-21 16:13:05,399:INFO:   <<< negative_weighting: 1
2025-03-21 16:13:05,399:INFO:   <<< num_thread_reader: 2
2025-03-21 16:13:05,399:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 16:13:05,400:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 16:13:05,400:INFO:   <<< rank: 0
2025-03-21 16:13:05,400:INFO:   <<< resume_model: None
2025-03-21 16:13:05,400:INFO:   <<< sampled_use_mil: False
2025-03-21 16:13:05,400:INFO:   <<< seed: 42
2025-03-21 16:13:05,400:INFO:   <<< sim_header: seqTransf
2025-03-21 16:13:05,400:INFO:   <<< slice_framepos: 2
2025-03-21 16:13:05,400:INFO:   <<< task_type: retrieval
2025-03-21 16:13:05,400:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 16:13:05,400:INFO:   <<< train_csv: data/.train.csv
2025-03-21 16:13:05,400:INFO:   <<< train_frame_order: 0
2025-03-21 16:13:05,400:INFO:   <<< use_mil: False
2025-03-21 16:13:05,400:INFO:   <<< val_csv: data/.val.csv
2025-03-21 16:13:05,400:INFO:   <<< video_dim: 1024
2025-03-21 16:13:05,400:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 16:13:05,400:INFO:   <<< warmup_proportion: 0.1
2025-03-21 16:13:05,400:INFO:   <<< world_size: 2
2025-03-21 16:13:05,400:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 16:13:05,400:INFO: Total available GPUs: 2
2025-03-21 16:13:05,400:INFO: Process 3202450 using device: cuda:0, local_rank: 0
2025-03-21 16:13:05,400:INFO: Current device index: 0
2025-03-21 16:13:05,401:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 16:13:08,272:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 16:13:08,272:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 16:13:08,273:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 16:13:08,273:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 16:13:08,273:WARNING: Test retrieval by loose type.
2025-03-21 16:13:08,273:WARNING: 	 embed_dim: 512
2025-03-21 16:13:08,273:WARNING: 	 image_resolution: 224
2025-03-21 16:13:08,273:WARNING: 	 vision_layers: 12
2025-03-21 16:13:08,274:WARNING: 	 vision_width: 768
2025-03-21 16:13:08,274:WARNING: 	 vision_patch_size: 16
2025-03-21 16:13:08,274:WARNING: 	 context_length: 77
2025-03-21 16:13:08,274:WARNING: 	 vocab_size: 49408
2025-03-21 16:13:08,274:WARNING: 	 transformer_width: 512
2025-03-21 16:13:08,274:WARNING: 	 transformer_heads: 8
2025-03-21 16:13:08,274:WARNING: 	 transformer_layers: 12
2025-03-21 16:13:08,274:WARNING: 		 linear_patch: 2d
2025-03-21 16:13:08,274:WARNING: 	 cut_top_layer: 0
2025-03-21 16:13:10,404:WARNING: 	 sim_header: seqTransf
2025-03-21 16:13:23,023:INFO: --------------------
2025-03-21 16:13:23,024:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 16:13:23,024:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 16:13:32,223:INFO: ***** Running test *****
2025-03-21 16:13:32,223:INFO:   Num examples = 60000
2025-03-21 16:13:32,223:INFO:   Batch size = 64
2025-03-21 16:13:32,223:INFO:   Num steps = 938
2025-03-21 16:13:32,223:INFO: ***** Running val *****
2025-03-21 16:13:32,223:INFO:   Num examples = 30000
2025-03-21 16:13:46,268:INFO: ***** Running training *****
2025-03-21 16:13:46,268:INFO:   Num examples = 259910
2025-03-21 16:13:46,268:INFO:   Batch size = 16
2025-03-21 16:13:46,268:INFO:   Num steps = 81220
2025-03-21 17:15:11,836:INFO: Effective parameters:
2025-03-21 17:15:11,836:INFO:   <<< batch_size: 16
2025-03-21 17:15:11,836:INFO:   <<< batch_size_val: 64
2025-03-21 17:15:11,836:INFO:   <<< cache_dir: 
2025-03-21 17:15:11,836:INFO:   <<< coef_lr: 0.001
2025-03-21 17:15:11,836:INFO:   <<< cross_model: cross-base
2025-03-21 17:15:11,836:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 17:15:11,836:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 17:15:11,836:INFO:   <<< datatype: vatex
2025-03-21 17:15:11,836:INFO:   <<< do_eval: False
2025-03-21 17:15:11,836:INFO:   <<< do_lower_case: False
2025-03-21 17:15:11,837:INFO:   <<< do_pretrain: False
2025-03-21 17:15:11,837:INFO:   <<< do_train: True
2025-03-21 17:15:11,837:INFO:   <<< epochs: 5
2025-03-21 17:15:11,837:INFO:   <<< eval_frame_order: 0
2025-03-21 17:15:11,837:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 17:15:11,837:INFO:   <<< feature_framerate: 1
2025-03-21 17:15:11,837:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 17:15:11,837:INFO:   <<< fp16: True
2025-03-21 17:15:11,837:INFO:   <<< fp16_opt_level: O2
2025-03-21 17:15:11,837:INFO:   <<< freeze_layer_num: 0
2025-03-21 17:15:11,837:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 17:15:11,837:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 17:15:11,837:INFO:   <<< init_model: None
2025-03-21 17:15:11,837:INFO:   <<< linear_patch: 2d
2025-03-21 17:15:11,837:INFO:   <<< local_rank: 0
2025-03-21 17:15:11,837:INFO:   <<< loose_type: True
2025-03-21 17:15:11,837:INFO:   <<< lr: 0.0001
2025-03-21 17:15:11,837:INFO:   <<< lr_decay: 0.9
2025-03-21 17:15:11,837:INFO:   <<< margin: 0.1
2025-03-21 17:15:11,837:INFO:   <<< max_frames: 12
2025-03-21 17:15:11,838:INFO:   <<< max_words: 32
2025-03-21 17:15:11,838:INFO:   <<< n_display: 50
2025-03-21 17:15:11,838:INFO:   <<< n_gpu: 2
2025-03-21 17:15:11,838:INFO:   <<< n_pair: 1
2025-03-21 17:15:11,838:INFO:   <<< negative_weighting: 1
2025-03-21 17:15:11,838:INFO:   <<< num_thread_reader: 2
2025-03-21 17:15:11,838:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 17:15:11,838:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 17:15:11,838:INFO:   <<< rank: 0
2025-03-21 17:15:11,838:INFO:   <<< resume_model: None
2025-03-21 17:15:11,838:INFO:   <<< sampled_use_mil: False
2025-03-21 17:15:11,838:INFO:   <<< seed: 42
2025-03-21 17:15:11,838:INFO:   <<< sim_header: seqTransf
2025-03-21 17:15:11,838:INFO:   <<< slice_framepos: 2
2025-03-21 17:15:11,838:INFO:   <<< task_type: retrieval
2025-03-21 17:15:11,838:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 17:15:11,838:INFO:   <<< train_csv: data/.train.csv
2025-03-21 17:15:11,838:INFO:   <<< train_frame_order: 0
2025-03-21 17:15:11,838:INFO:   <<< use_mil: False
2025-03-21 17:15:11,839:INFO:   <<< val_csv: data/.val.csv
2025-03-21 17:15:11,839:INFO:   <<< video_dim: 1024
2025-03-21 17:15:11,839:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 17:15:11,839:INFO:   <<< warmup_proportion: 0.1
2025-03-21 17:15:11,839:INFO: Effective parameters:
2025-03-21 17:15:11,839:INFO:   <<< world_size: 2
2025-03-21 17:15:11,839:INFO:   <<< batch_size: 16
2025-03-21 17:15:11,839:INFO: device: cuda:0 n_gpu: 2
2025-03-21 17:15:11,839:INFO:   <<< batch_size_val: 64
2025-03-21 17:15:11,839:INFO:   <<< cache_dir: 
2025-03-21 17:15:11,839:INFO:   <<< coef_lr: 0.001
2025-03-21 17:15:11,839:INFO:   <<< cross_model: cross-base
2025-03-21 17:15:11,839:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 17:15:11,839:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 17:15:11,839:INFO:   <<< datatype: vatex
2025-03-21 17:15:11,839:INFO:   <<< do_eval: False
2025-03-21 17:15:11,839:INFO:   <<< do_lower_case: False
2025-03-21 17:15:11,840:INFO:   <<< do_pretrain: False
2025-03-21 17:15:11,840:INFO:   <<< do_train: True
2025-03-21 17:15:11,840:INFO:   <<< epochs: 5
2025-03-21 17:15:11,840:INFO:   <<< eval_frame_order: 0
2025-03-21 17:15:11,840:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 17:15:11,840:INFO:   <<< feature_framerate: 1
2025-03-21 17:15:11,840:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 17:15:11,840:INFO:   <<< fp16: True
2025-03-21 17:15:11,840:INFO:   <<< fp16_opt_level: O2
2025-03-21 17:15:11,840:INFO:   <<< freeze_layer_num: 0
2025-03-21 17:15:11,840:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 17:15:11,840:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 17:15:11,840:INFO:   <<< init_model: None
2025-03-21 17:15:11,840:INFO:   <<< linear_patch: 2d
2025-03-21 17:15:11,840:INFO:   <<< local_rank: 0
2025-03-21 17:15:11,840:INFO:   <<< loose_type: True
2025-03-21 17:15:11,840:INFO:   <<< lr: 0.0001
2025-03-21 17:15:11,840:INFO:   <<< lr_decay: 0.9
2025-03-21 17:15:11,840:INFO:   <<< margin: 0.1
2025-03-21 17:15:11,840:INFO:   <<< max_frames: 12
2025-03-21 17:15:11,841:INFO:   <<< max_words: 32
2025-03-21 17:15:11,841:INFO:   <<< n_display: 50
2025-03-21 17:15:11,841:INFO:   <<< n_gpu: 2
2025-03-21 17:15:11,841:INFO:   <<< n_pair: 1
2025-03-21 17:15:11,841:INFO:   <<< negative_weighting: 1
2025-03-21 17:15:11,841:INFO:   <<< num_thread_reader: 2
2025-03-21 17:15:11,841:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 17:15:11,841:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 17:15:11,841:INFO:   <<< rank: 1
2025-03-21 17:15:11,841:INFO:   <<< resume_model: None
2025-03-21 17:15:11,841:INFO:   <<< sampled_use_mil: False
2025-03-21 17:15:11,841:INFO:   <<< seed: 42
2025-03-21 17:15:11,841:INFO:   <<< sim_header: seqTransf
2025-03-21 17:15:11,841:INFO:   <<< slice_framepos: 2
2025-03-21 17:15:11,841:INFO:   <<< task_type: retrieval
2025-03-21 17:15:11,841:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 17:15:11,841:INFO:   <<< train_csv: data/.train.csv
2025-03-21 17:15:11,841:INFO:   <<< train_frame_order: 0
2025-03-21 17:15:11,841:INFO:   <<< use_mil: False
2025-03-21 17:15:11,841:INFO:   <<< val_csv: data/.val.csv
2025-03-21 17:15:11,841:INFO:   <<< video_dim: 1024
2025-03-21 17:15:11,841:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 17:15:11,841:INFO:   <<< warmup_proportion: 0.1
2025-03-21 17:15:11,841:INFO:   <<< world_size: 2
2025-03-21 17:15:11,841:INFO: device: cuda:0 n_gpu: 2
2025-03-21 17:15:14,647:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 17:15:14,647:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 17:15:14,648:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 17:15:14,648:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 17:15:14,648:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 17:15:14,648:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 17:15:14,649:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 17:15:14,649:WARNING: Test retrieval by loose type.
2025-03-21 17:15:14,649:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 17:15:14,649:WARNING: Test retrieval by loose type.
2025-03-21 17:15:14,649:WARNING: 	 embed_dim: 512
2025-03-21 17:15:14,649:WARNING: 	 image_resolution: 224
2025-03-21 17:15:14,649:WARNING: 	 embed_dim: 512
2025-03-21 17:15:14,649:WARNING: 	 vision_layers: 12
2025-03-21 17:15:14,649:WARNING: 	 image_resolution: 224
2025-03-21 17:15:14,649:WARNING: 	 vision_width: 768
2025-03-21 17:15:14,649:WARNING: 	 vision_layers: 12
2025-03-21 17:15:14,649:WARNING: 	 vision_width: 768
2025-03-21 17:15:14,649:WARNING: 	 vision_patch_size: 16
2025-03-21 17:15:14,649:WARNING: 	 context_length: 77
2025-03-21 17:15:14,649:WARNING: 	 vision_patch_size: 16
2025-03-21 17:15:14,649:WARNING: 	 vocab_size: 49408
2025-03-21 17:15:14,649:WARNING: 	 context_length: 77
2025-03-21 17:15:14,649:WARNING: 	 transformer_width: 512
2025-03-21 17:15:14,649:WARNING: 	 vocab_size: 49408
2025-03-21 17:15:14,649:WARNING: 	 transformer_width: 512
2025-03-21 17:15:14,649:WARNING: 	 transformer_heads: 8
2025-03-21 17:15:14,650:WARNING: 	 transformer_layers: 12
2025-03-21 17:15:14,650:WARNING: 	 transformer_heads: 8
2025-03-21 17:15:14,650:WARNING: 	 transformer_layers: 12
2025-03-21 17:15:14,650:WARNING: 		 linear_patch: 2d
2025-03-21 17:15:14,650:WARNING: 		 linear_patch: 2d
2025-03-21 17:15:14,650:WARNING: 	 cut_top_layer: 0
2025-03-21 17:15:14,650:WARNING: 	 cut_top_layer: 0
2025-03-21 17:15:16,884:WARNING: 	 sim_header: seqTransf
2025-03-21 17:15:16,884:WARNING: 	 sim_header: seqTransf
2025-03-21 17:15:27,803:INFO: --------------------
2025-03-21 17:15:27,804:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 17:15:27,804:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 17:15:27,824:INFO: --------------------
2025-03-21 17:15:27,824:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 17:15:27,825:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 17:39:01,656:INFO: Effective parameters:
2025-03-21 17:39:01,656:INFO: Effective parameters:
2025-03-21 17:39:01,656:INFO:   <<< batch_size: 16
2025-03-21 17:39:01,656:INFO:   <<< batch_size: 16
2025-03-21 17:39:01,656:INFO:   <<< batch_size_val: 64
2025-03-21 17:39:01,656:INFO:   <<< batch_size_val: 64
2025-03-21 17:39:01,656:INFO:   <<< cache_dir: 
2025-03-21 17:39:01,657:INFO:   <<< cache_dir: 
2025-03-21 17:39:01,657:INFO:   <<< coef_lr: 0.001
2025-03-21 17:39:01,657:INFO:   <<< coef_lr: 0.001
2025-03-21 17:39:01,657:INFO:   <<< cross_model: cross-base
2025-03-21 17:39:01,657:INFO:   <<< cross_model: cross-base
2025-03-21 17:39:01,657:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 17:39:01,657:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 17:39:01,657:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 17:39:01,657:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 17:39:01,657:INFO:   <<< datatype: vatex
2025-03-21 17:39:01,657:INFO:   <<< datatype: vatex
2025-03-21 17:39:01,657:INFO:   <<< do_eval: False
2025-03-21 17:39:01,657:INFO:   <<< do_eval: False
2025-03-21 17:39:01,657:INFO:   <<< do_lower_case: False
2025-03-21 17:39:01,657:INFO:   <<< do_pretrain: False
2025-03-21 17:39:01,657:INFO:   <<< do_lower_case: False
2025-03-21 17:39:01,657:INFO:   <<< do_train: True
2025-03-21 17:39:01,657:INFO:   <<< do_pretrain: False
2025-03-21 17:39:01,657:INFO:   <<< epochs: 5
2025-03-21 17:39:01,657:INFO:   <<< do_train: True
2025-03-21 17:39:01,657:INFO:   <<< eval_frame_order: 0
2025-03-21 17:39:01,657:INFO:   <<< epochs: 5
2025-03-21 17:39:01,657:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 17:39:01,657:INFO:   <<< eval_frame_order: 0
2025-03-21 17:39:01,657:INFO:   <<< feature_framerate: 1
2025-03-21 17:39:01,657:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 17:39:01,657:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 17:39:01,657:INFO:   <<< feature_framerate: 1
2025-03-21 17:39:01,657:INFO:   <<< fp16: True
2025-03-21 17:39:01,657:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 17:39:01,657:INFO:   <<< fp16_opt_level: O2
2025-03-21 17:39:01,657:INFO:   <<< fp16: True
2025-03-21 17:39:01,657:INFO:   <<< freeze_layer_num: 0
2025-03-21 17:39:01,657:INFO:   <<< fp16_opt_level: O2
2025-03-21 17:39:01,657:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 17:39:01,657:INFO:   <<< freeze_layer_num: 0
2025-03-21 17:39:01,657:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 17:39:01,657:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 17:39:01,657:INFO:   <<< init_model: None
2025-03-21 17:39:01,657:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 17:39:01,658:INFO:   <<< linear_patch: 2d
2025-03-21 17:39:01,658:INFO:   <<< init_model: None
2025-03-21 17:39:01,658:INFO:   <<< local_rank: 0
2025-03-21 17:39:01,658:INFO:   <<< linear_patch: 2d
2025-03-21 17:39:01,658:INFO:   <<< loose_type: True
2025-03-21 17:39:01,658:INFO:   <<< local_rank: 0
2025-03-21 17:39:01,658:INFO:   <<< lr: 0.0001
2025-03-21 17:39:01,658:INFO:   <<< loose_type: True
2025-03-21 17:39:01,658:INFO:   <<< lr_decay: 0.9
2025-03-21 17:39:01,658:INFO:   <<< lr: 0.0001
2025-03-21 17:39:01,658:INFO:   <<< margin: 0.1
2025-03-21 17:39:01,658:INFO:   <<< lr_decay: 0.9
2025-03-21 17:39:01,658:INFO:   <<< max_frames: 12
2025-03-21 17:39:01,658:INFO:   <<< margin: 0.1
2025-03-21 17:39:01,658:INFO:   <<< max_words: 32
2025-03-21 17:39:01,658:INFO:   <<< n_display: 50
2025-03-21 17:39:01,658:INFO:   <<< max_frames: 12
2025-03-21 17:39:01,658:INFO:   <<< max_words: 32
2025-03-21 17:39:01,658:INFO:   <<< n_gpu: 2
2025-03-21 17:39:01,658:INFO:   <<< n_display: 50
2025-03-21 17:39:01,658:INFO:   <<< n_pair: 1
2025-03-21 17:39:01,658:INFO:   <<< n_gpu: 2
2025-03-21 17:39:01,658:INFO:   <<< negative_weighting: 1
2025-03-21 17:39:01,658:INFO:   <<< n_pair: 1
2025-03-21 17:39:01,658:INFO:   <<< num_thread_reader: 2
2025-03-21 17:39:01,658:INFO:   <<< negative_weighting: 1
2025-03-21 17:39:01,658:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 17:39:01,658:INFO:   <<< num_thread_reader: 2
2025-03-21 17:39:01,658:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 17:39:01,658:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 17:39:01,658:INFO:   <<< rank: 0
2025-03-21 17:39:01,658:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 17:39:01,658:INFO:   <<< resume_model: None
2025-03-21 17:39:01,658:INFO:   <<< rank: 1
2025-03-21 17:39:01,658:INFO:   <<< sampled_use_mil: False
2025-03-21 17:39:01,658:INFO:   <<< resume_model: None
2025-03-21 17:39:01,658:INFO:   <<< seed: 42
2025-03-21 17:39:01,658:INFO:   <<< sampled_use_mil: False
2025-03-21 17:39:01,658:INFO:   <<< sim_header: seqTransf
2025-03-21 17:39:01,658:INFO:   <<< seed: 42
2025-03-21 17:39:01,658:INFO:   <<< slice_framepos: 2
2025-03-21 17:39:01,658:INFO:   <<< sim_header: seqTransf
2025-03-21 17:39:01,658:INFO:   <<< task_type: retrieval
2025-03-21 17:39:01,659:INFO:   <<< slice_framepos: 2
2025-03-21 17:39:01,659:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 17:39:01,659:INFO:   <<< task_type: retrieval
2025-03-21 17:39:01,659:INFO:   <<< train_csv: data/.train.csv
2025-03-21 17:39:01,659:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 17:39:01,659:INFO:   <<< train_csv: data/.train.csv
2025-03-21 17:39:01,659:INFO:   <<< train_frame_order: 0
2025-03-21 17:39:01,659:INFO:   <<< train_frame_order: 0
2025-03-21 17:39:01,659:INFO:   <<< use_mil: False
2025-03-21 17:39:01,659:INFO:   <<< use_mil: False
2025-03-21 17:39:01,659:INFO:   <<< val_csv: data/.val.csv
2025-03-21 17:39:01,659:INFO:   <<< val_csv: data/.val.csv
2025-03-21 17:39:01,659:INFO:   <<< video_dim: 1024
2025-03-21 17:39:01,659:INFO:   <<< video_dim: 1024
2025-03-21 17:39:01,659:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 17:39:01,659:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 17:39:01,659:INFO:   <<< warmup_proportion: 0.1
2025-03-21 17:39:01,659:INFO:   <<< warmup_proportion: 0.1
2025-03-21 17:39:01,659:INFO:   <<< world_size: 2
2025-03-21 17:39:01,659:INFO:   <<< world_size: 2
2025-03-21 17:39:01,659:INFO: device: cuda:0 n_gpu: 2
2025-03-21 17:39:01,659:INFO: device: cuda:0 n_gpu: 2
2025-03-21 17:39:03,664:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 17:39:03,665:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 17:39:03,665:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 17:39:03,665:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 17:39:03,665:WARNING: Test retrieval by loose type.
2025-03-21 17:39:03,666:WARNING: 	 embed_dim: 512
2025-03-21 17:39:03,666:WARNING: 	 image_resolution: 224
2025-03-21 17:39:03,666:WARNING: 	 vision_layers: 12
2025-03-21 17:39:03,666:WARNING: 	 vision_width: 768
2025-03-21 17:39:03,666:WARNING: 	 vision_patch_size: 16
2025-03-21 17:39:03,666:WARNING: 	 context_length: 77
2025-03-21 17:39:03,666:WARNING: 	 vocab_size: 49408
2025-03-21 17:39:03,666:WARNING: 	 transformer_width: 512
2025-03-21 17:39:03,666:WARNING: 	 transformer_heads: 8
2025-03-21 17:39:03,666:WARNING: 	 transformer_layers: 12
2025-03-21 17:39:03,666:WARNING: 		 linear_patch: 2d
2025-03-21 17:39:03,666:WARNING: 	 cut_top_layer: 0
2025-03-21 17:39:03,690:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 17:39:03,690:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 17:39:03,691:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 17:39:03,691:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 17:39:03,691:WARNING: Test retrieval by loose type.
2025-03-21 17:39:03,691:WARNING: 	 embed_dim: 512
2025-03-21 17:39:03,691:WARNING: 	 image_resolution: 224
2025-03-21 17:39:03,691:WARNING: 	 vision_layers: 12
2025-03-21 17:39:03,691:WARNING: 	 vision_width: 768
2025-03-21 17:39:03,691:WARNING: 	 vision_patch_size: 16
2025-03-21 17:39:03,692:WARNING: 	 context_length: 77
2025-03-21 17:39:03,692:WARNING: 	 vocab_size: 49408
2025-03-21 17:39:03,692:WARNING: 	 transformer_width: 512
2025-03-21 17:39:03,692:WARNING: 	 transformer_heads: 8
2025-03-21 17:39:03,692:WARNING: 	 transformer_layers: 12
2025-03-21 17:39:03,692:WARNING: 		 linear_patch: 2d
2025-03-21 17:39:03,692:WARNING: 	 cut_top_layer: 0
2025-03-21 17:39:07,338:WARNING: 	 sim_header: seqTransf
2025-03-21 17:39:07,393:WARNING: 	 sim_header: seqTransf
2025-03-21 17:39:18,226:INFO: --------------------
2025-03-21 17:39:18,227:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 17:39:18,227:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 17:39:18,286:INFO: --------------------
2025-03-21 17:39:18,286:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 17:39:18,286:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 17:39:26,798:INFO: ***** Running test *****
2025-03-21 17:39:26,798:INFO:   Num examples = 33910
2025-03-21 17:39:26,798:INFO:   Batch size = 64
2025-03-21 17:39:26,798:INFO:   Num steps = 530
2025-03-21 17:39:26,798:INFO: ***** Running val *****
2025-03-21 17:39:26,798:INFO:   Num examples = 23750
2025-03-21 17:39:26,803:INFO: ***** Running test *****
2025-03-21 17:39:26,803:INFO:   Num examples = 33910
2025-03-21 17:39:26,803:INFO:   Batch size = 64
2025-03-21 17:39:26,803:INFO:   Num steps = 530
2025-03-21 17:39:26,803:INFO: ***** Running val *****
2025-03-21 17:39:26,803:INFO:   Num examples = 23750
2025-03-21 18:29:16,388:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 18:29:16,388:INFO: Total available GPUs: 2
2025-03-21 18:29:16,388:INFO: Effective parameters:
2025-03-21 18:29:16,388:INFO: Process 3216471 using device: cuda:1, local_rank: 1
2025-03-21 18:29:16,388:INFO: Current device index: 1
2025-03-21 18:29:16,388:INFO:   <<< batch_size: 16
2025-03-21 18:29:16,388:INFO:   <<< batch_size_val: 64
2025-03-21 18:29:16,388:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 18:29:16,388:INFO:   <<< cache_dir: 
2025-03-21 18:29:16,389:INFO:   <<< coef_lr: 0.001
2025-03-21 18:29:16,389:INFO:   <<< cross_model: cross-base
2025-03-21 18:29:16,389:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 18:29:16,389:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 18:29:16,389:INFO:   <<< datatype: vatex
2025-03-21 18:29:16,389:INFO:   <<< do_eval: False
2025-03-21 18:29:16,389:INFO:   <<< do_lower_case: False
2025-03-21 18:29:16,389:INFO:   <<< do_pretrain: False
2025-03-21 18:29:16,389:INFO:   <<< do_train: True
2025-03-21 18:29:16,389:INFO:   <<< epochs: 5
2025-03-21 18:29:16,389:INFO:   <<< eval_frame_order: 0
2025-03-21 18:29:16,389:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 18:29:16,389:INFO:   <<< feature_framerate: 1
2025-03-21 18:29:16,389:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 18:29:16,389:INFO:   <<< fp16: True
2025-03-21 18:29:16,389:INFO:   <<< fp16_opt_level: O2
2025-03-21 18:29:16,389:INFO:   <<< freeze_layer_num: 0
2025-03-21 18:29:16,389:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 18:29:16,389:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 18:29:16,389:INFO:   <<< init_model: None
2025-03-21 18:29:16,390:INFO:   <<< linear_patch: 2d
2025-03-21 18:29:16,390:INFO:   <<< local_rank: 0
2025-03-21 18:29:16,390:INFO:   <<< loose_type: True
2025-03-21 18:29:16,390:INFO:   <<< lr: 0.0001
2025-03-21 18:29:16,390:INFO:   <<< lr_decay: 0.9
2025-03-21 18:29:16,390:INFO:   <<< margin: 0.1
2025-03-21 18:29:16,390:INFO:   <<< max_frames: 12
2025-03-21 18:29:16,390:INFO:   <<< max_words: 32
2025-03-21 18:29:16,390:INFO:   <<< n_display: 50
2025-03-21 18:29:16,390:INFO:   <<< n_gpu: 2
2025-03-21 18:29:16,390:INFO:   <<< n_pair: 1
2025-03-21 18:29:16,390:INFO:   <<< negative_weighting: 1
2025-03-21 18:29:16,390:INFO:   <<< num_thread_reader: 2
2025-03-21 18:29:16,390:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 18:29:16,390:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 18:29:16,390:INFO:   <<< rank: 0
2025-03-21 18:29:16,390:INFO:   <<< resume_model: None
2025-03-21 18:29:16,390:INFO:   <<< sampled_use_mil: False
2025-03-21 18:29:16,390:INFO:   <<< seed: 42
2025-03-21 18:29:16,390:INFO:   <<< sim_header: seqTransf
2025-03-21 18:29:16,390:INFO:   <<< slice_framepos: 2
2025-03-21 18:29:16,391:INFO:   <<< task_type: retrieval
2025-03-21 18:29:16,391:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 18:29:16,391:INFO:   <<< train_csv: data/.train.csv
2025-03-21 18:29:16,391:INFO:   <<< train_frame_order: 0
2025-03-21 18:29:16,391:INFO:   <<< use_mil: False
2025-03-21 18:29:16,391:INFO:   <<< val_csv: data/.val.csv
2025-03-21 18:29:16,391:INFO:   <<< video_dim: 1024
2025-03-21 18:29:16,391:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 18:29:16,391:INFO:   <<< warmup_proportion: 0.1
2025-03-21 18:29:16,391:INFO:   <<< world_size: 2
2025-03-21 18:29:16,391:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 18:29:16,391:INFO: Total available GPUs: 2
2025-03-21 18:29:16,391:INFO: Process 3216470 using device: cuda:0, local_rank: 0
2025-03-21 18:29:16,391:INFO: Current device index: 0
2025-03-21 18:29:16,391:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 18:29:18,349:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 18:29:18,350:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 18:29:18,350:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 18:29:18,350:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 18:29:18,351:WARNING: Test retrieval by loose type.
2025-03-21 18:29:18,351:WARNING: 	 embed_dim: 512
2025-03-21 18:29:18,351:WARNING: 	 image_resolution: 224
2025-03-21 18:29:18,351:WARNING: 	 vision_layers: 12
2025-03-21 18:29:18,351:WARNING: 	 vision_width: 768
2025-03-21 18:29:18,351:WARNING: 	 vision_patch_size: 16
2025-03-21 18:29:18,351:WARNING: 	 context_length: 77
2025-03-21 18:29:18,351:WARNING: 	 vocab_size: 49408
2025-03-21 18:29:18,351:WARNING: 	 transformer_width: 512
2025-03-21 18:29:18,351:WARNING: 	 transformer_heads: 8
2025-03-21 18:29:18,351:WARNING: 	 transformer_layers: 12
2025-03-21 18:29:18,351:WARNING: 		 linear_patch: 2d
2025-03-21 18:29:18,351:WARNING: 	 cut_top_layer: 0
2025-03-21 18:29:21,976:WARNING: 	 sim_header: seqTransf
2025-03-21 18:29:32,816:INFO: --------------------
2025-03-21 18:29:32,816:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 18:29:32,816:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 18:29:41,105:INFO: ***** Running test *****
2025-03-21 18:29:41,106:INFO:   Num examples = 33910
2025-03-21 18:29:41,106:INFO:   Batch size = 64
2025-03-21 18:29:41,106:INFO:   Num steps = 530
2025-03-21 18:29:41,106:INFO: ***** Running val *****
2025-03-21 18:29:41,106:INFO:   Num examples = 23750
2025-03-21 18:29:58,656:INFO: ***** Running training *****
2025-03-21 18:29:58,656:INFO:   Num examples = 237780
2025-03-21 18:29:58,656:INFO:   Batch size = 16
2025-03-21 18:29:58,656:INFO:   Num steps = 74305
2025-03-21 18:31:35,494:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 18:31:35,494:INFO: Effective parameters:
2025-03-21 18:31:35,494:INFO: Total available GPUs: 2
2025-03-21 18:31:35,494:INFO:   <<< batch_size: 16
2025-03-21 18:31:35,494:INFO:   <<< batch_size_val: 64
2025-03-21 18:31:35,494:INFO: Process 3217089 using device: cuda:1, local_rank: 1
2025-03-21 18:31:35,494:INFO:   <<< cache_dir: 
2025-03-21 18:31:35,494:INFO: Current device index: 1
2025-03-21 18:31:35,494:INFO:   <<< coef_lr: 0.001
2025-03-21 18:31:35,494:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 18:31:35,494:INFO:   <<< cross_model: cross-base
2025-03-21 18:31:35,495:INFO:   <<< cross_num_hidden_layers: 4
2025-03-21 18:31:35,495:INFO:   <<< data_path: /home/s3705609/data1/VATEX
2025-03-21 18:31:35,495:INFO:   <<< datatype: vatex
2025-03-21 18:31:35,495:INFO:   <<< do_eval: False
2025-03-21 18:31:35,495:INFO:   <<< do_lower_case: False
2025-03-21 18:31:35,495:INFO:   <<< do_pretrain: False
2025-03-21 18:31:35,495:INFO:   <<< do_train: True
2025-03-21 18:31:35,495:INFO:   <<< epochs: 5
2025-03-21 18:31:35,495:INFO:   <<< eval_frame_order: 0
2025-03-21 18:31:35,495:INFO:   <<< expand_msrvtt_sentences: False
2025-03-21 18:31:35,495:INFO:   <<< feature_framerate: 1
2025-03-21 18:31:35,495:INFO:   <<< features_path: /home/s3705609/data1/VATEX/clips
2025-03-21 18:31:35,495:INFO:   <<< fp16: True
2025-03-21 18:31:35,495:INFO:   <<< fp16_opt_level: O2
2025-03-21 18:31:35,495:INFO:   <<< freeze_layer_num: 0
2025-03-21 18:31:35,495:INFO:   <<< gradient_accumulation_steps: 1
2025-03-21 18:31:35,495:INFO:   <<< hard_negative_rate: 0.5
2025-03-21 18:31:35,495:INFO:   <<< init_model: None
2025-03-21 18:31:35,495:INFO:   <<< linear_patch: 2d
2025-03-21 18:31:35,495:INFO:   <<< local_rank: 0
2025-03-21 18:31:35,495:INFO:   <<< loose_type: True
2025-03-21 18:31:35,496:INFO:   <<< lr: 0.0001
2025-03-21 18:31:35,496:INFO:   <<< lr_decay: 0.9
2025-03-21 18:31:35,496:INFO:   <<< margin: 0.1
2025-03-21 18:31:35,496:INFO:   <<< max_frames: 12
2025-03-21 18:31:35,496:INFO:   <<< max_words: 32
2025-03-21 18:31:35,496:INFO:   <<< n_display: 1
2025-03-21 18:31:35,496:INFO:   <<< n_gpu: 2
2025-03-21 18:31:35,496:INFO:   <<< n_pair: 1
2025-03-21 18:31:35,496:INFO:   <<< negative_weighting: 1
2025-03-21 18:31:35,496:INFO:   <<< num_thread_reader: 2
2025-03-21 18:31:35,496:INFO:   <<< output_dir: ckpts3/xclip_vatex_vit16
2025-03-21 18:31:35,496:INFO:   <<< pretrained_clip_name: ViT-B/16
2025-03-21 18:31:35,496:INFO:   <<< rank: 0
2025-03-21 18:31:35,496:INFO:   <<< resume_model: None
2025-03-21 18:31:35,496:INFO:   <<< sampled_use_mil: False
2025-03-21 18:31:35,496:INFO:   <<< seed: 42
2025-03-21 18:31:35,496:INFO:   <<< sim_header: seqTransf
2025-03-21 18:31:35,496:INFO:   <<< slice_framepos: 2
2025-03-21 18:31:35,496:INFO:   <<< task_type: retrieval
2025-03-21 18:31:35,496:INFO:   <<< text_num_hidden_layers: 12
2025-03-21 18:31:35,496:INFO:   <<< train_csv: data/.train.csv
2025-03-21 18:31:35,496:INFO:   <<< train_frame_order: 0
2025-03-21 18:31:35,497:INFO:   <<< use_mil: False
2025-03-21 18:31:35,497:INFO:   <<< val_csv: data/.val.csv
2025-03-21 18:31:35,497:INFO:   <<< video_dim: 1024
2025-03-21 18:31:35,497:INFO:   <<< visual_num_hidden_layers: 12
2025-03-21 18:31:35,497:INFO:   <<< warmup_proportion: 0.1
2025-03-21 18:31:35,497:INFO:   <<< world_size: 2
2025-03-21 18:31:35,497:INFO: CUDA_VISIBLE_DEVICES: 0,1
2025-03-21 18:31:35,497:INFO: Total available GPUs: 2
2025-03-21 18:31:35,497:INFO: Process 3217088 using device: cuda:0, local_rank: 0
2025-03-21 18:31:35,497:INFO: Current device index: 0
2025-03-21 18:31:35,497:INFO: Device properties: _CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=10824MB, multi_processor_count=68)
2025-03-21 18:31:37,467:INFO: loading archive file /home/s3705609/X-CLIP/modules/cross-base
2025-03-21 18:31:37,468:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2025-03-21 18:31:37,468:INFO: Weight doesn't exsits. /home/s3705609/X-CLIP/modules/cross-base/cross_pytorch_model.bin
2025-03-21 18:31:37,468:WARNING: Stage-One:True, Stage-Two:False
2025-03-21 18:31:37,468:WARNING: Test retrieval by loose type.
2025-03-21 18:31:37,469:WARNING: 	 embed_dim: 512
2025-03-21 18:31:37,469:WARNING: 	 image_resolution: 224
2025-03-21 18:31:37,469:WARNING: 	 vision_layers: 12
2025-03-21 18:31:37,469:WARNING: 	 vision_width: 768
2025-03-21 18:31:37,469:WARNING: 	 vision_patch_size: 16
2025-03-21 18:31:37,469:WARNING: 	 context_length: 77
2025-03-21 18:31:37,469:WARNING: 	 vocab_size: 49408
2025-03-21 18:31:37,469:WARNING: 	 transformer_width: 512
2025-03-21 18:31:37,469:WARNING: 	 transformer_heads: 8
2025-03-21 18:31:37,469:WARNING: 	 transformer_layers: 12
2025-03-21 18:31:37,469:WARNING: 		 linear_patch: 2d
2025-03-21 18:31:37,469:WARNING: 	 cut_top_layer: 0
2025-03-21 18:31:41,087:WARNING: 	 sim_header: seqTransf
2025-03-21 18:31:51,989:INFO: --------------------
2025-03-21 18:31:51,990:INFO: Weights of XCLIP not initialized from pretrained model: 
   global_mat_weight
   word_logit_weight
   frame_logit_weight
   local_mat_weight
   frame_mat_weight
   word_mat_weight
   frame_mat_weight2
   word_mat_weight2
2025-03-21 18:31:51,990:INFO: Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2025-03-21 18:32:00,144:INFO: ***** Running test *****
2025-03-21 18:32:00,145:INFO:   Num examples = 33910
2025-03-21 18:32:00,145:INFO:   Batch size = 64
2025-03-21 18:32:00,145:INFO:   Num steps = 530
2025-03-21 18:32:00,145:INFO: ***** Running val *****
2025-03-21 18:32:00,145:INFO:   Num examples = 23750
2025-03-21 18:32:17,669:INFO: ***** Running training *****
2025-03-21 18:32:17,669:INFO:   Num examples = 237780
2025-03-21 18:32:17,670:INFO:   Batch size = 16
2025-03-21 18:32:17,670:INFO:   Num steps = 74305
2025-03-21 18:33:03,668:INFO: Epoch: 1/5, Step: 1/14861, Lr: , Loss: 0.140039, Time/step: 45.974548
2025-03-21 18:33:04,752:INFO: Epoch: 1/5, Step: 2/14861, Lr: , Loss: 0.192775, Time/step: 1.082784
2025-03-21 18:33:41,648:INFO: Epoch: 1/5, Step: 3/14861, Lr: , Loss: 0.156114, Time/step: 36.895226
2025-03-21 18:33:42,754:INFO: Epoch: 1/5, Step: 4/14861, Lr: , Loss: 0.149094, Time/step: 1.078261
2025-03-21 18:34:13,763:INFO: Epoch: 1/5, Step: 5/14861, Lr: , Loss: 0.247001, Time/step: 31.008484
2025-03-21 18:34:14,617:INFO: Epoch: 1/5, Step: 6/14861, Lr: , Loss: 0.109976, Time/step: 0.853052
2025-03-21 18:34:37,492:INFO: Epoch: 1/5, Step: 7/14861, Lr: , Loss: 0.067666, Time/step: 22.873630
2025-03-21 18:34:38,789:INFO: Epoch: 1/5, Step: 8/14861, Lr: , Loss: 0.150079, Time/step: 1.296517
2025-03-21 18:35:03,728:INFO: Epoch: 1/5, Step: 9/14861, Lr: , Loss: 0.129105, Time/step: 24.930173
2025-03-21 18:35:04,719:INFO: Epoch: 1/5, Step: 10/14861, Lr: , Loss: 0.064761, Time/step: 0.989276
2025-03-21 18:35:40,138:INFO: Epoch: 1/5, Step: 11/14861, Lr: , Loss: 0.225837, Time/step: 35.417329
2025-03-21 18:35:41,324:INFO: Epoch: 1/5, Step: 12/14861, Lr: , Loss: 0.072193, Time/step: 1.185389
